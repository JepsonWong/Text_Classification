微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
1999年 第18卷 第2期 Vol.18 No.2 1999



ATM交换机中的优先级控制技术
余　英
　　摘　要：分析了无优先级ATM交换机内部交换结构，介绍了在此基础上引入适应于多媒体传输的优先级控制技术。
　　关键词：ATM交换机　交换技术　优先级控制
　　ATM(异步转移模式)是B―ISDN(宽带综合业务数字网)中采用的传输与交换方式。由于ATM技术的出现，B―ISDN与N―ISDN(窄带综合业务数字网)相比，不仅是带宽与服务能力的扩展，而且是信息传递方式的一场革命。在信道利用率、处理时延、传输多媒体信息、接入新业务能力方面，ATM有着其它技术无法比拟的优势。ATM技术由于能在一个单一的主体网络上携带多种信息媒体，进行多种通信业务，所以从一开始就受到人们的重视，成为国内外网络领域的研究热点。越来越多的厂家推出了自己的ATM产品，从适合公用网的大型ATM主干交换机到企业级、校园级的ATM交换集线器，其应用逐步成熟。本文从无优先级ATM交换机内部结构入手，分析其交换机理，在此基础上引入适应于多媒体传输的优先级交换技术。
1　宽带业务对ATM的要求
　　ATM要为各种类型的业务提供服务，就必须满足各种业务的服务质量要求。对宽带业务而言，传输过程的二大基本要求是：信元丢失率、时延与时延抖动。
　　宽带业务对信元丢失率的要求：对话音和视频信号而言，由于听觉与视觉效应的特点，对于一定的信元丢失是完全允许的，但对于一些关键信元(如量化表、运动矢量等)必须保证传输的准确性，否则会破坏几帧的图像质量。而对一般数据信元的丢失率的要求不高，可通过高层重传机制弥补信元丢失的影响。
　　宽带业务对信元时延与时延抖动的影响：话音和视频信号要求在传输过程中有尽可能小的时延与时延抖动，超出一定范围的时延与时延抖动会导致话音和视频信号的严重失真。如高清晰度电视由音频、标准图像、图文电视等业务成分组成，这些业务成分之间的时延差不能大于100μs，否则将造成可以感知的不良后果。而单一数据信元对时延与时延抖动的要求不高，重要的是数据传送的准确性，故由上面提到的重传机制即可保证。虽然由重传会带来相应的时延及时延抖动，但对数据业务基本没什么影响。
　　按照以上基本宽带业务特性，为满足各类业务服务质量的要求，ATM交换机应具有优先级交换功能，即优先传送对时延与时延抖动较敏感的话音与视频信号，同时具有优先级流控功能，即在信元超载时优先丢弃优先级较低的信元。
2　ATM信元结构与优先级
　　如图1所示，在ATM网络中，信息传输是以固定长度(53B)的信元(cell)为单位进行的，每个信元由48B的信息字段和5B的信头(header)组成。在5B的信头中，关系到优先级传输的有关字段是：一般流量控制GFC、信元丢失优先级CLP以及虚通道标识VPI和虚信道标识VCI。在用户网络接口(UNI：用于接入交换机端口)的信头中定义了一般流量控制GFC字段，对不同时间优先级的信元可通过GFC中的相应位设定优先级信元，但在用户节点接口(NNI：用于节点交换机端口)中无GFC字段，其位置被占更多信息位的VPI占据，在交换译码表查询输入信元的VPI和VCI过程中，延迟优先级就由VPI和VCI确定，它包含在信元附加的内部路由选择标签中。由此，可以对不同优先级信元分配不同的虚通道(VP)或不同的虚信道(VC)，以实现不同信元的时间优先级控制。同时不同业务有不同的服务质量参数，这些参数也向网络提供了不同业务的时间优先级特性。

图1  ATM信元结构
　　此外，ATM信头中还定义了另一个决定丢失特性的优先级比特CLP，用于ATM网的流量控制，以此实现流控中的优先级。CLP比特位在ATM信元编码过程中生成。为了传输以上各类业务，且能在传输过程中满足相应的服务质量，首先解决的问题是信元编码问题。而针对ATM网支持突发业务的特性，关键的又是突发编码问题。目前比较新的突发编码技术是可变速率编码和分层编码结合在一起的可变速率分层编码技术。利用分层编码可将突发信源信息分成不同的重要等级(依据对时延及丢失率等参数的要求)，并分配以不同的优先级，使信元丢弃限制于较低优先级的信元，保证高优先级信元正确传输。2种编码技术的结合使传输质量得到了保证。有了丢失特性优先级标识位CLP后，在信元的交换和对信元的流量控制过程中，由于缓冲器满、需要丢失选择的时候，就有了依据，进而可以进行符合业务服务质量要求的优先级控制。
3　ATM交换结构
　　ATM交换机中交换部分的一般结构如图2。它由输入、输出控制器、交换机构和控制处理器构成，对输入信号进行处理，完成连接的建立、释放、带宽的分配、维护和管理功能。输入控制器对各输入端口的处理是同步的，这样使得到达交换机构的所有输入端口的信元处于同一时间点上，从而简化了交换机构的设计且允许按信元的优先级来进行接收处理。ATM交换机从给定端口接收数据单元，并根据接收信元信头中的VPI/VCI字段的信息，将输入的信元切换到相应的输出端口上。由于VPI/VCI字段很小，并具有层次结构，因此转发任务相当简单。ATM交换机构内部由多个基本交换单元组成，由这些基本交换单元完成信元从入端到出端的交换任务。在目前生产的ATM交换机中采用的基本交换单元有如下几类：矩阵型交换单元、中央存储交换单元、总线制交换单元、环型交换单元等。 

图2  ATM交换结构
4　无优先级控制ATM交换机机理
　　由图2 ATM交换机结构可知，在宽带业务传输过程中，信元从某一输入端口进入交换机后，由交换机内部的交换单元进行处理，继而从相应的端口输出。在交换机对信元进行交换的过程中存在这样的情况：多个输入端口的信元竞争同一输出端口，这时交换机因无力在1个信元时间内同时完成所有信元的传送而导致部分信元丢失，故在实际的交换机内部往往根据所采用交换单元的特性分别在输入、输出或中央位置设置相应的缓冲存储器。根据信元缓存所处的不同位置，交换单元可分为输入排队、输出排队和中央排除等几大类。对上一节所提到的几类交换单元，根据其不同特性可分别采用不同的排队策略，如：矩阵型交换单元可以有输入排队型、输入出排队型和交叉缓冲型等几种情况；中央存储器交换单元为中央排队型；总线制交换单元和环形交换单元采用输出排队型。

图3  无优先级输入输出排队交换
　　图3是目前主干网交换机产品中采用得较多的一种带输入、输出缓存的交换结构示意图。在每条输入线上设置缓存队列，对进入的信元进行排队，由一个仲裁机构根据各输出线的忙闲、输入队列的状态、交换传送媒体的状态，决定允许哪些队列中的信元可以通过交换媒体进行交换。同时在每条输出线上也设置缓存队列，因为在实际的交换机内采用了快速交换技术，使得对信元的交换速度大大提高，而信元到了输出端口后又由于输出端口线路传输速度的限制，聚集在同一输出端口的多个信元无法同时输出，必然造成信元丢失。故应在交换机各输出端口处设置缓存，以保存暂时不能传送出去的信元，减少信元丢失。
5　优先级控制ATM交换机机理
　　ATM交换机应具有以下特点：高速率、大信息容量、高通过量、低延时、易于交换控制等。其中延时特性是多媒体信息传输的一个重要因素。而交换机内部的延时除了交换机本身对单一信元的交换处理速度外，主要是交换机内部多个输入端口竞争一个输出通道失败时，在输入缓存中的排队时延及在输出缓存中等待输出的排队时延。而且，无优先级控制时，由于信元在传输信道中的统计复用形式，信元时延难以确定，且时延抖动较大。

图4  优先级输入、输出排队交换
　　优先级控制ATM交换机机理如图4。在每个输入端口(输出端口)设置多个队列，进入每个输入端口的信元按优先级别进入不同优先级队列中，每个输入端口当前等待交换的信元只有1个，即队头信元。该队头应由各输入端口的多个队列依据优先级别竞争而得，由此，队头信元应是该端口所有队列中优先级别最高的信元。在输出端口也设置类似的队列，交换时不同优先级别的输入信元输出到不同优先级别的输出队列中，以便优先传送级别较高的信元。由以上控制方法可知，高优先级信元能以尽可能小的时延与时延抖动进行交换，从而满足多媒体信元的传输特性。
　　在ATM交换机传输信元的过程中，影响传输质量的另一环节就是ATM信元的流量控制。ATM网络支持突发性信元，利用统计复用方式可以获得较高的频带利用率，使多种业务灵活有效地共享网络资源。在发送信元之前，用户首先发出呼叫，按申报业务的特性和所要求的传输质量提出申请，网络控制点以此统计参数、性能要求以及当前网络的负荷来决定是否满足用户要求，进而按要求建立1条虚电路。但当大量突发业务同时进入网络时，多个瞬间峰值信元的同时出现将导致网络严重阻塞，因此必须进行优先级控制，以使要求质量高的业务有较高的优先级，从而优先传送，有选择地丢弃一些分组。这样不仅可以保证重构信息的质量，同时对网络的延时性能也有较大改善。在以上优先级交换控制机理中可以看出，交换机中设置的输入、输出队列长度不可能无限大，即在信元突发度很大的情况下，存在信元溢出的问题。这种情况下就可以利用优先级流控机制，丢弃优先级较低的信元，保证优先级别较高的信元得以传送。
6　结束语
　　优先级控制技术在ATM网的交换、流控等环节起着十分重要的作用，并为ATM传送多媒体业务提供了可能。目前，双优先级ATM交换机产品已投入市场(如日本NEC公司开发的ATOMIS―5型ATM交换机)。相信有关多优先级问题的研究将对ATM交换机性能的提高产生重要的推动作用，为宽带综合业务数字网的最终实现奠定基础。
作者单位：昆明云南师范大学计算机科学系(650092)
参考文献
1　裘晓峰，张春红.宽带网络技术及其应用.北京：清华大学出版社，1997
2　张宏科，裘正定.ATM网络互连原理与工程.北京：清华大学出版社，1996
3　邢秦中.ATM通讯网.北京：人民邮电出版社,1998
4　沈兰荪.ATM网络的视频编码技术.电子学报，1995；23(4)
(收稿日期：1998-09-23)
