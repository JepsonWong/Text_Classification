自动化学报
ACTA AUTOMATICA SINICA
1997年　第23卷　第4期　Vol.23　No.4　1997



随机过程在指定坐标下的最优截断1）
鲍荣浩　徐博侯
　　摘　要　提出了随机激励下的一种模型降阶方法.在指定坐标下，选择使输出误差性能指标最小的分量，并对输出矩阵作最优修正，指出了这种最优截断法的几何正交性，为降阶控制器设计提供了基础.最后给出了一个可行算法和算例.
　　关键词　模型降阶，随机分量，最优截断，最小正交化.
OPTIMAL TRUNCATION FOR RANDOM PROCESS
IN THE PRESPECIFIED COORDINATE
BAO RONGHAO　XU BOHOU
(Mechanics Department of Zhejiang University, Hangzhou　310027)
Abstract　An optimal method to truncate the components of a stable random output process in the prespecified coordinate is presented in this paper,which is based on the performance criterion of output error.It is pointed out that this optimal truncaion is also a minimal orthogonal projection of the truncated components.Several properties for such truncation are introduced.A numerical example is given in the end.
Key words　Model reduction,random component,optimal truncation,minimum orthogonalization.
1　问题背景和描述
　　模型降阶是复杂结构系统进行动力学分析和控制设计时所必须考虑的一个问题.对于诸如柔性飞行器这样的一个高阶系统(几百甚至几千阶)［1］，用全阶模型来分析和设计往往会遇到计算上的困难，其中包括算法本身、计算速度以及对计算机外存的要求等，当然更不用说系统本身可能就是无限维的.因此，如何简捷地获得一个较佳的降阶近似模型是个很现实也很有价值的问题.
　　模型降阶的方法很多，也有许多文献对此进行过概括和总结［2，3］。这些方法从模型对象来讲，可以分为开环［4］和闭环［5］两种；从降阶系统所处的输入环境来讲，又可分为确定输入系统的降阶和随机输入系统的降阶［6］；从降阶方法最后得到的结果来看，则又可以分为性能指标最优的降阶［7］和次优的降阶［8］.本文要讨论的是系统在随机环境影响下的一种开环次优降阶方法.
　　事实上，有一类系统往往工作在不确定的随机环境影响之中，如在太空中漂游的空间柔性飞行器、核反应堆等，即使进行了闭环设计后，其外界影响也是随机性的.对于这类系统，开环降阶往往是很关键的，其结果的好坏直接影响到控制系统的精度问题.随机系统的降阶方法很多，其中有保留主模态的模态集结法，Wilson参数优化法，性能最优的优化投影法［7］，平衡随机降阶法［6］，分量化费分析法(CCA)［4］等.其中尤以分量花费法在柔性空间结构降阶中的力学意义最为明确，而优化投影法虽然有很好的数学结果，但由于其计算上太过于复杂(四个耦合的李雅普方程和黎卡的方程的求解)而且需要一个能事先确定降阶阶次的准则而受到限制.本文则是从输出误差的性能指标出发，讨论系统输出过程在指定坐标下截断部分分量的一个最优方法.
　　记集合X0={x1,x2,…,xn},其中每个元素xi,i∈n　(表示i=1,2,…，n，下同)是随机的稳态过程.由X0中所有元素生成的一个输出过程为

(1)
定义与系统输出(1)相关的一个(稳态)性能指标为
J=E∞［y(t)T∪y(t)］.
(2)
这里，E∞=E表示系统趋于稳态时的数学期望(以下都一样)，U是体现系统输出中每个分量重要性的一个正定对称权矩阵，一般都是事先选定.记集合X0中所有元素的下标所组成的一个数集Ω={1,2,…,n},Ω中任意r(≤n)个元素组成的一个子集Ωr和这个子集在Ω上的补集分别为

(3)
=Ω-Ωr.
(4)
则在X0上以Ωr和中元素作为下标的子集分别为

(5)

(6)
　　所谓随机过程在指定坐标中的最优截断，是指给定了一个正整数r≤n后，在Ω上找到上面这样的子集Ωr，使得输出误差性能指标JΔ最小

(7)
这里，yr为截断r个分量后的输出，(y-yr)是截断后的输出误差，

(8)
其中，ηi(ηi∈)是维数合适的待定矩阵.
2　对X0中单个分量的最优截断
　　把集合X0中元素写成向量形式为

(9)
假如我们在系统中要截断的是第i个分量xi，记x截断分量xi后的向量为

(10)
那么输出方程(1)可以表示为下面的形式
y=L1+L2xi,
(11)
L1=[C1,C2,…,Ci-1,Ci+1,…,Cn],L2=Ci,
(12)
取系统截断分量xi后得到的截断输出方程为
y1=L*,
(13)
这里L*是具合适维数，且使输出误差指标σ(xi)最小的矩阵
σ(xi)=minE∞(y-y1)TU(y-y1) .
(14)
　　因为系统是稳定的，我们可以记一个相关矩阵

(15)
Qij(i,j=1,2)是矩阵的i行j列元素.根据等式(7)，输出误差的性能指标可以表示为

(16)
这里tr(.)为矩阵求迹算子，ΔL=L1-L*.要求(16)的最小值，令JΔ1/L*=0,可以得到

(17)
相应地截断分量xi后的最小误差性能指标为

(18)
为了更加明显地看到这种截断方法的几何意义，我们不妨引入一个新的分量u，
u=xi-Q21,
(19)
此时输出方程(11)可以分解为
y=L*+L2u.
(20)
比较表达式(20)及截断分量xi后的表达式(13)我们可以看到，(20)中第二项L2u就是对分量xi进行最优截断后所产生的输出误差，因此严格地讲，系统真正要截断的是分量u而不是xi.计算分量u和的稳态协方差矩阵为
Qu1=E∞u()T =0.
(21)
这也就是说，u和中每个分量是正交的，即分量表达式(20)中第二项是xi在所张成的子空间上的正交投影，而u则是xi到该子间的距离.因此，截断分量xi而使输出误差指标最优问题，实际上也就是对指定分量xi向其它分量所生成的子空间的正交分解或投影过程.
　　上面我们得到了对X0中最优截断某个指定分量xi后所产生的输出误差性能指标，因此，只要当i遍历Ω(也就是取遍Ω中所有元素)时，我们总可以在X0中找到这样的一个分量xj1∈X0来，使得对该分量最优截断后产生的输出误差指标在所有这些误差性能指标中是最小的一个，即

(22)
我们称截断上面这个分量xi1的过程为系统对集合X0中不指定的单个分量的最优截断过程，λi1是截断单个分量的最优误差性能指标.在找到了这样的分量xi1后，它实际上也就变成了对指定分量的最优截断问题.
3　对X0中r个分量的最优截断
　　从以上分析来看，在集合X0中，我们总是可以找到一个使输出误差性能指标最小的截断变量xi1，记X0中截断分量xi1后剩余分量所组成的集合为X1=X0-{xi1}，相应的截断输出过程为y1(这里y的下标不表示分量，只表示截断的序号y0=y).然后我们总是又可以和上面一样在X1中再进行单个分量的最优截断过程，得到剩余分量所组成的新集合X2，相应的由集合X2中元素所生成的截断输出过程为y2，这样一步步下去，直到截断了r个分量为止，最后得到要保留分量的集合Xr，由Xr中每个分量组成的截断输出yr即为原系统截断r个分量后的最优截断输出.
　　不失一般性，假设我们要截断的分量依次是系统的最后r个分量，即
Xi={x1,x2,…,xn-r},0≤i≤r，
(23)
则第i步截断中所产生的输出截断误差为
Δi=yi-yi-1,i≥1.
(24)
从前面的讨论中我们已经知道，每步截断过程中的输出误差和要保留分量生成的子空间是正交的，因此成立

(25)

(26)
这里Mij是对xi进行最优截断后求得的系数.对于第k步和m步截断成立

(27)
这也就是说，任何不同的两步最优截断所产生的输出误差是互不相关的(指系统到达稳态时)，因此我们可以得到以下一些性质.
　　性质1.　最优截断总体误差性能指标是每步截断产生误差性能指标的累加，即

(28)
　　性质2.　原系统的输出性能指标是截断后输出的性能指标与被截断部分的性能指标的和.
　　性质3.　系统对任何两个分量依次进行指定分量的最优截断所产生的误差性能指标的和与系统对两个分量一起截断所产生的误差性能指标是相等的.(证明略)
　　从上面的分析过程中我们可以看到，在指定坐标中对随机过程的最优截断过程实际上也就是对要被截断分量不断进行最小正交化过程，使得真正要被截断部分分量所对应的性能指标最小.当事先不知道所要截断的分量个数时，我们可以先计算输出性能指标(2)中的J值，然后根据截断某个分量后所产生的误差指标和J的比值是否足够小来判断截断的结果.
4　算例与结果
　　以上我们只讨论了输出过程的降价，为了同时得到保留分量的变化方程，结合模型的状态方程，来考虑一个线性稳定系统
=Ax(t)+Bw(t),
(29)
y(t)=Cx(t).
(30)
这里，x∈Rn,y∈Rm分别是系统的状态和输出向量， w∈Rp是和系统初始状态不相关的高斯零均白噪声，A，B，C分别为具有合适维数的系统矩阵，其中A是稳定矩阵.其模型降价可以按以下步骤完成：
　　(1)对原系统进行模态变换(只计算系统的实模态坐标)，每个模态作为一个分量.
　　(2)计算模态的相关矩阵，并根据式(2)计算系统的输出性能指标J.
　　(3)分别计算最优截断每个模态所产生的输出误差性能指标.
　　(4)判断(3)中最小值和J的比值，如果不是足够小，则截断最小值所对应的模态分量，由剩余的模态组成一个新集合继续转到过程(3)；如果比值足够小，则由剩余的模态组成降阶模型，结束计算.
　　作为算例，考虑有如下传递函数在单位强度高斯白噪声驱动下的一个线性系统［9］，

其在模态坐标下的一个实现为
A=diag(-1,-3,-5,-10),
B=[0.0417　-0.0357　-0.0250　0.0190]T,
C=[1　1　1　1].
　　如果用传统模态截断法简单截断后面三阶、两阶和一阶模态，其输出误差百分比(定义为输出误差性能指标和输出性能指标的比值)分别为
δ3=129.30%,　δ2=6.37%,　δ1=6.73%.
计算系统用传统模态截断法截断后面三阶和两阶模态后得到的一阶和两阶降阶模型输出误差，分别画在图1和图2上，和系统输出仿真值相比较后可以看到，用传统模态截断法是无法得到一个比较满意结果的.如果我们对原系统进行本文所述的最小正交化过程，那末用本文最优截断法得到的一阶、两阶和三阶降阶模型所对应的输出误差百分比分别为
δ3=33.42%,　δ2=0.22%,　δ1=0.07%.
同时计算最优截断法得到的一阶和两阶降阶模型的输出误差仿真值画在图3和图4中.


图1　一阶降阶模型输出误差


图2　两阶降阶模型输出误差


图3　修正后一阶降阶模型输出误差


图4　修正后两阶降阶模型输出误差
　　同样，如果我们把系统输入矩阵的每一列按次序分别乘以(4，3，2，1)，使得前面几阶模态对输出贡献值增大.和上面一样，用传统模态截断法简单截断后面三阶、两阶和一阶模态后的输出误差百分比分别为
δ3=52.74%,　δ2=2.41%,　δ1=0.31%.
用本文的最优截断法得到的一阶、两阶和三阶降阶模型的输出误差百分比分别为
δ3=14.56%,　δ2=0.020%,　δ1=0.006%.
　　从以上输出误差百分比的计算结果及输出误差仿真图中我们可以看到，用模态坐标下的最优截断法不仅能够用来挑选降阶模型所要保留的模态分量，同时对传统模态截断法有非常明显的误差补偿效果.和性能指标最优的降阶法［7］相比较，指定坐标下最优截断法的结果是次优的，但是它有以下三个计算上的优点：(1)不需要求解复杂的非线性代数方程组；(2)在降阶模型阶次变化时不必重新进行计算；(3)当系统具有比较接近的特征值(这是柔性结构控制中比较常见的密频现象)时，本方法由于没有病态方程的求解，使得问题简单化，我们在讨论柔性结构模型降阶的另一篇论文中对此作了进一步的阐述.要真正解决系统的降阶问题，还需要考虑更多的因素，如模型降阶后控制器的设计，模型降阶对系统性能的影响等等，这有待于我们进一步的研究.
1)　国家自然科学基金资助项目.
作者简介：鲍荣浩　1969年12月出生，1995年获固体力学博士学位，现为浙江大学力学系讲师.目前研究方向为：柔性结构的模型降阶与控制，固体力学中的数值方法，计算机应用与软件开发，非线性理论的应用等.
　　徐博侯　1946年出生，丹麦科技大学应用数学物理专业博士，现为浙江大学力学系教授，博士导师.目前研究方向为：柔性结构的模型降阶与控制，固体力学中的数值方法，复杂结构的稳定性分析，非线性理论的应用等.
作者单位：浙江大学力学系　杭州　310027
参考文献
［1］　Balas M J.Trends in large space structures control theory:fondest hopes,wildest dreams.IEEE.Trans.Automat.Contr,1982,27:522―535.
[2]　詹姆希迪，大系统理论，北京：科学出版社，1986.
[3]　Rao S S,Pan T S,Vekayya V B.Modeling,control,and design of flexible structures:A Survey.Appl.Mech.Rev.1990,43:99―117.
[4]　Skelton R E,Huges P C,Halbani H B.Order reduction for models of space structures using modal cost analysis.J.Guidance.1982,15:351―357.
[5]　Yousuff A,Controller reduction by component cost analysis.IEEE.Trans.Automat.Contr.1984,29:668―682.
[6]　Green M,A relative error bound for balanced stochastic truncation.IEEE.Trans.Automat.Contr,1988,33:961―965.
[7]　Hyland D C,Bernstein D S.The optimal projection equations for model reduction and the relationship among the methods of wilson,skelton,and moore.IEEE.Trans.Automat.Contr.,1985,30:1201―1211.
[8]　Moor B C.Principle component analysis in linear systems:controll ability,observability,and model reductioin.IEEE.Trans.Automat.Contr.1981,26:17―32.
[9]　Liu Y,Anderson B D O.Singular perturbation approximation of balanced system.Int.J.Contrl.1989,50(4):1379―1405.
收稿日期　1995-05-29
