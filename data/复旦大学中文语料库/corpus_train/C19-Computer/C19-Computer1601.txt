信息与控制
Information and Control
1999年　第28卷　第4期　Vol.28　No.4　1999



基于数据仓库的EIS在CIMS中的研究与实现
宋　宏　金新伟　薛劲松　张晓煜

　　摘　要： 随着信息系统在企业应用的不断发展，越来越多的企业高层领导已不满足从MIS、MRP II中获取的信息．本文结合在企业实际中应用的JS-CIMS领导信息系统，首先介绍了CIMS环 境下企业领导对信息系统的需求，然后给出了EIS的概念和EIS的CSFs，并在通用数据仓库模 型基础上，提出了JS-CIMS中EIS数据仓库的模型及建立过程．
　　关键词：计算机集成制造系统，领导信息系统，决策支持系统，数据仓库 
　　中图分类号：TP14　　　　　　文献标识码：B
SYSTEM RESEARCH & IMPLEMENTATION OF EIS BASED ON DATA
WAREHOUSE IN CIMS
SONG Hong JIN Xinwei XUE Jinsong ZHANG Xiaoyu
(Shenyang Institute of Automation Chinese Academy of Sciences　11 0015)
Abstract　 According to JS-CIMS executive information system(EIS) used in jiangsu steel wi re rope bloc, this paper gives the information requirement needed by enterprise director in CIMS, the concept of EIS and it's critical success factors. Based o n general model of Data Warehouse, this paper gives the model and implementat pr ocess of EIS in JS-CIMS.
　　Key words　CIMS, Executive Information System(EIS), DSS, data wa rehouse

1　引言
　　随着CIMS应用工程实施的不断深入，随着MIS、MRPⅡ、CAD/CAPP系统的建立和应用的不断发展，企业计算机系统中的信息不断膨胀和爆炸，但同时又缺乏对企业高层领导对信息需求的有力支持，其原因如下：
　　（1）按CIMS递阶控制结构，任何企业都可以分为决策层、管理层和执行层三个层次，MIS、MRPⅡ等各个应用系统层次低且过于详细，基本都属于企业管理层和执行层，鲜有决策 层所需的企业综合分析信息．如MRPⅡ系统所提供的信息主要为具体产品的生产加工单、采购单、入/出库单、企业明细帐目和产品成本信息等，都是为企业各处室和具体的业务员所用，不能满足领导对企业诸如各部门销售量、资金回笼状况、产品市场走势、资产负债/损益等信息的要求．
　　DSS系统虽然能进行辅助决策，但它一般是面向企业中的某个主题（如报价DSS、产品销售DSS和成本控制DSS等），而非面向企业整个生产经营过程．当系统环境变化时，DSS往往缺乏足够的灵活性；另外对DSS研究的重点，大多集中于它的模型，难以使企业领导从中获得较大的帮助．
　　（2）CIMS中各应用系统的计算机实现环境较为复杂，都需进入若干层菜单，并由操作者输入一系列条件，才能得到相应的信息．这种操作方式对缺乏计算机应用技能的企业领导显然是难以接受的．
　　（3）CIMS各应用系统一般均建立在分布式数据库基础上，所有数据是面向事务的，数据量大，缺乏汇总、分析和历史数据．从各应用站点数据库中抽取领导所需的企业现状数据、历史数据，经过分析并传至领导者面前，往往要花费很长时间，直至不能读取，这使企业领导难以忍受．
2　CIMS中的EIS
2.1 EIS概念
　　领导信息系统（EIS）是供领导使用的计算机系统，它为领导者决策时提供足够的信息，跟踪反映企业及其各个功能单元的运行情况，提高领导者工作质量与工作效率，使企业赢得竞争优势．EIS能在较短的时间内，用以跟踪关键成功因素（CSFs），帮助决策者收集信息，确定问题和机会，而不是去分析和解决问题．可以认为EIS是能方便地为高层领导提供 与其关键成功因素有关的内外部信息的计算机系统[1]．
　　要成功实现EIS必须确定其关键成功因素（Critical Success Factors-CSFs），所谓CSFs是 高层领导者关心的那些和系统目标直接相联系的信息．
在一个企业的业务活动中，CSFs总是与那些能确保企业竞争力的因素相关，在不同类型的业务活动中，关键成功因素也有极大不同，即使在同一类型的业务活动中，在不同的时期，其CSFS也极大的不同．关键成功因素与企业当前业务的处理及所需要的高性能的关键性领域有关，它给出了最高管理者掌握的为控制系统所必须的衡量标准．
2.2 CIMS环境下EIS的关键成功因素（CSFs）
　　众所周知，CIMS覆盖了企业生产经营活动的全部生产过程，重点解决企业在T（交货期）、Q（质量）、C（成本）和S（服务）等方面的问题，以提高企业的市场竞争能力．如同生产管理、库存管理和财务管理等系统一样，EIS是CIMS的一个组成部分．CIMS环境下的EIS服务对象是企业经理（厂长），其数据来源于CIMS各应用系统，其开发运行环境为CIMS网络/数据库环境．
　　CIMS环境下的EIS为领导提供的信息往往是从上到下，由粗到细的逐步深化过程，它是 建立在MIS、MRPⅡ等应用系统基础之上．其关键成功因素为生产、销售、库存、财务、质量 、人员等方面，虽然具体细节随企业不同而有差异，但主要如表1示.
表1 CIMS中EIS关键成功因素

业务主题关键成功因素（CSFs）业务主题关键成功因素（CSFs）
销售.产品品种销售量、销售额财务成本.资产负债率等技经指标
　.资金回笼率，欠款情况　.资金损益等技经指标
　.产品利润率　.应收款、应付款情况
　.客户分布
　.各销售部门、销售业务员业绩
　.产品报价
生产.月、周计划安排状况、完成率库存.(半)成品、各种原辅料库存量
　及品种规格
　.成品、半成品入库率　
　.外协完成率　.库存资金占用
　.中间半成品调度情况　.入/出库情况，资金状况
　.生产资金占用
供应.物资采购状况质量.产品合格率
　.供应商到货率　.成材率
　.物资入库率　.废品率
　.供应商交货期
　.应付款、已付款、欠款状况

　
3　CIMS/EIS中的数据仓库
3.1 数据仓库的体系结构
　　W.H.Inmon于1992年提出数据仓库的概念，即：数据仓库是支持管理决策过程的，面向主题的，随时间而变的持久的数据集合．数据仓库的出现，使其成为支持建立EIS强有力的数据基础，它集成了种类不同应用系统的数据库，从发展、历史的角度组织和存贮数据，使EIS的实现成为现实．
　　数据仓库系结构如图1，它是由斯坦福（Stanford）大学提出的．

图1　Stanford数据仓库体系结构

　　其底部是多个信息源，通常是运作的数据库系统，历史数据，外部数据等；打包部分负责把本地的信息翻译成数据仓库使用的数据模型；监督员部分负责对本地信息源需提取的数据及其变化自动探测，并把它们报告给予集成器，集成器则负责把信息装到数据仓库中．
3.2 JS-CIMS EIS中的数据仓库
　　基于Stanford模型，结合江苏钢绳集团领导对信息的需求而建立的实际模型如图2所示. 

图2　JS-CIMS领导信息系统数据仓库模型

其中，信息源是JS-CIMS系统中各应用系统数据库，将信息源中的数据经过变换与集成，装入集成的关系数据库中，然后从集成数据库提取数据，根据EIS系统对信息的要求再装入数据仓库中．用户通过前端（Client）工具或应用访问数据仓库，以充分利用Client端丰富的数据分析工具．
数据仓库建立的关键是数据变换与集成，其过程如图3所示.

图3　数据变换与集成过程
　　①数据定义及读取主要完成定义数据仓库的数据源和数据提取规则或模型等数据仓库内容、结构和环境定义．
　　②过滤首先分离出数据源，再验证数据的一致性，排除由事务处理造成的问题．
　　③集成则按规则（如用关系数据库，采用SQL规范）进行数据类型与域的变换和转化．
　　④质量保证对转化完的数据进行数据完备性、数据间的约束关系、数据的一致性、安全性和时序性等方面的检查及修正．
　　⑤加载将提取的数据装入目标数据库，并完成数据索引，目录维护等内容．
3.3 EIS数据仓库中的数据
　　数据仓库以企业的总体数据模型为基础，并根据应用的特点作适当调整．在物理设计之前还 要进行数据稳定性分析，按照数据被改变和刷新的规律分组．一个业务活动可以作为一个事件主题，企业存在众多事件主题，企业业务活动多有变化．而数据主题相对稳定，数据仓库的数据模型完全可以通过少量的几个数据主题，为众多的事件主题构造出不受限制的数据综合路径，实现多维数据服务．图4是一个产品销售的例子.

图4 销售多维数据

　　从图4中可以得出多个汇总层次，即销售指标（数量、金额、税金、应收款）在产品（总量 、大类、规格），客户（总量、地区、单位），部门（总量、部门、销售人员），时间（年 、月、日）各方面的不同层次的汇总．
4　JS-CIMS领导信息系统
　　JS-CIMS是江苏钢绳集团公司CIMS工程，已通过国家验收．与生产相关的系统采用MRP Ⅱ软件，数据库为Progress关系库，与财务相关系统采用FOXPRO数据库．
JS-CIMS领导信息系统是在JS-CIMS网络数据库环境支撑下，在生产系统和财务系统基础上，为公司领导直接提供有关生产、销售、库存、供应和财务、经营等多方面的信息支持，以图文并茂生动的方式辅助企业领导做出决策．
JS-CIMS/EIS的前台开发、运行环境为Win95.Delphi3.0，后台数据库为Progress和FOXPRO数据库．本系统简单易学，集成性好，易于扩充，操作灵活方便，已经在江苏钢绳集团公司得到应用，并得到用户和验收、测试组的极高评价．
4.1 JS-CIMS领导信息系统结构
JS-CIMS领导信息系统采用如图5所示体系结构．它从MRPⅡ系统PROGRESS关系数据库提取与生产相关的数据，从FOXPRO数据库提取出与财务、销售相关的数据，经过表名、字段名、属性的统一，数据完整性的验证，打上时间标记，按月加以汇总，以多维数据的方式存入数据仓库．

图5　JS-CIMS领导信息系统体系结构

　　JS-CIMS领导信息系统前端查询及分析工具与数据仓库构成了一个典型的客户/服务器分布式应用结构，采用ODBC接口来访问数据仓库．
　　JS-CIMS领导信息系统数据无论从生产系统中，还是从财务系统中抽取出来的数据，都是当天的发生数据，它是面向事务的，必须加以重组，进行转化后才能载入数据仓库．
4.2 系统功能及界面
　　JS-CIMS领导信息系统提供多维的、粒度由粗及细不同的数据查询及走势分析．时间上可以是年、月、日；范围可从公司到部门，甚至个人．限于篇幅仅介绍销售系统，其功能包括部门销售情况统计、客户销售情况统计、业务员销售统计、产品销售走势分析和客户订货走势分析．
　　系统可按时间（年、月、日），产品（总量、大类和规格），客户多粒度、多维数据进行查询和分析，并以数据和图表显示．
5　结束语
　　许多已经建立MIS、CIMS的企业已认识到，系统中存储的大量规范化数据是企业最宝贵的资源，如何充分挖掘、利用这些宝贵资源已成为共识．我们结合JS-CIMS应用示范工程，建立了基于数据仓库的领导信息系统，并得到了用户的极好评价，相信这将会为其它CIMS系统提供经验，以加快信息资源的充分利用．
作者简介：宋　宏，33岁，男，高级工程师．研究领域为CIMS，ERP等方向的研究与开发． 
　　　　　金新伟，26岁，男，现任江阴市邮电局工程师．研究领域为数据仓库，软件工程等方向的研究与开发．
　　　　　薛劲松，60岁，男，研究员，博士导师．研究领域为CIMS，系统工程，离散事件理论等．
作者单位：中科院沈阳自动化所　110015
参考文献
1　Watson H J,Kelly Rainer R, George Houdeshel. Executive Information Systems Emergence．Development．Impact，John Willy & Sons，INC．1992
2 Inmon W H. Building the Data Warehouse. John Willy & Sons，Inc
3 金新伟．CIMS中EIS的应用与研究．中科院沈阳自动化所硕士论文,1998
4 李敏强等．基于数据仓库技术的决策支持系统的研究与应用．系统工程理论与实践, 1998
5 863/CIMS应用工程验收鉴定文档. JS-CIMS工程技术报告. 中科院沈阳自动化所、江 苏钢绳集团公司，1998.4
收稿日期:1998-08-19
