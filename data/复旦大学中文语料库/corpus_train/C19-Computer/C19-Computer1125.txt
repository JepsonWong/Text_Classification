自动化学报
ACTA AUTOMATICA SINICA
1999年　第25卷　第5期　Vol.25 No.5 1999



基于信息几何的统计回馈神经网络非线性自适应预测控制1)
戴宪华
摘　要　研究统计回馈神经网络(SRNN)的非线性自适应预测控制.基于混合统计模型，利用信息几何的处理方法，将SRNN的参数估计转化为一般的线性ARMA系统的最小均方误差参数估计算法，最终获得SRNN参数估计.获得RNN预测的参数估计以后，可以十分方便地利用线性ARMA系统的控制规律来设计SRNN的预测控制规律，解决了非线性SRNN预测参数估计、复杂非线性系统控制规律设计等问题.在研究单隐元SRNN的基础上，进一步探讨了多隐元SRNN的自适应预测控制问题.
关键词　统计回馈神经网络，信息几何，线性近似.
RECURRENT NEURAL NETWORK PREDICTION CONTROLLER BASED ON THE INFORMATION GEOMETRY
DAI Xianhua
(Dept.of Electronic Eng.,Shantou University,Guangdong　515063)
Abstract　The paper primarily investigates the adaptive predication controller modeled by the statistic recurrent neural network(SRNN).Using a mixed statistic model to approximate single neuron of the SRNN,one can easily obtain both parameter estimation and control rule of the adaptive controller based on the procedure of information geometry.On the basis of adaptive controller of single hidden unit,the paper further investigates the controller problems of the complicated SRNN with multiple hidden units.
Key words　Statistic recurrent neural network, information geometry, linear
approximation.
1　引　言
　　在实际工程应用中，经常遇到的许多实际物理系统或多或少地存在非线性特性.在众多的非线性模型中，统计回馈神经网络是一类十分有效的非线性系统描述方法，它的研究以及在控制、信息处理等方面的应用一直是众多学者研究的重点.
　　与线性系统的预测误差控制技术相比，非线性系统自适应控制的研究一直处于初期发展阶段.目前，尚无普遍适用的控制方法可有效地解决一般非线性控制问题的全局收敛性等问题.
　　在处理非线性问题的众多方法中，基于局部线性化或局部线性近似的处理方法一直是十分有效的处理方法.它的最大优点是，非线性系统局部线性化后，可以直接利用大量成熟的线性系统控制技术方法，解决非线性系统的自适应控制问题.本文就是基于这一思想，结合信息几何的处理方法，将非线性系统控制问题转化为一系列线性系统的控制问题，最终利用线性系统的自适应控制方法解决非线性RNN的自适应控制问题.
2　单隐元RNN的预测控制
2.1　单隐元RNN预测的线性近似模型
　　考虑如下具有单隐元的简单RNN系统
　(1)
其中x(t),y1(t)分别为RNN的输入和输出信号；ai(t),bm(t)为受控系统的参数，它们是未知的，需要在预测中估计；g(.)为RNN的激励函数；n(t)为加性噪声，这里假定它满足高斯分布.
　　采用单隐元RNN预测模型，式(1)所描述系统的预测输出为
　(2)
其中参数(t),(t)为非线性RNN预测的待估计参数.
　　在式(1)，(2)中，由于g(.)为非线性算子，直接根据式(2)计算控制器的控制输入信号通常也是十分困难的.但根据式(1)，(2)可知，当g(.)为线性算子时，单隐元RNN退化为线性ARMA系统.在一定的条件下，线性ARAM系统预测的参数估计可以收敛于全局最优解［2，3，4］.而基于线性ARMA系统的预测控制设计也较为简单，可直接利用预测控制或极点配置控制设计方法来获得全局收敛的控制规律［4］.因此，若能将单隐元RNN转化为线性ARMA系统，将可能获得较好的参数估计收敛结果及简单的预测控制规律.下面研究如何将式(2)转化为线性系统.
　　当激励函数为连续泛函时，它在定义域的充分小区域将可利用它的一阶Taylor展开近似.因此，RNN的激励函数取为软非线性函数，如Sigmodial函数时，式(2)可用下面一系列线性系统近似
　(3)
　(4)
　(5)
其中，Ak表示g(.)定义域中以y01,k为中心的小邻域，并且满足，
为g(.)的定义域.k称为RNN的状态指标.
　　从上面模型描述可以看出，当线性近似的数目K充分大时，公式(3)―(5)描述的线性系统将完全可以近似预测系统(2)，近似误差随着K的增大而趋于零.这样，就可以将非线性RNN预测转化为一系列线性ARMA系统的预测问题.
2.2　单隐元RNN线性近似模型的几何
　　在SRNN预测模型的训练学习中，训练数据或指导信号为y1(t).根据上面的线性近似模型，若已知训练数据y1(t)可作为式(3)―(5)描述的线性系统的指导信号，那么参数估计即为一般的线性ARMA系统预测的参数估计问题［2，3，4］.但是，通常并不能预先知道训练数据y1(t)可作为K个线性系统中的哪一个线性系统的指导信号.因此，模型参数估计是一不完全观测数据(incompletedata)的参数估计问题.那么参数估计包含如下两个方面：1)确定当前训练数据y1(t)可能作为哪一个线性系统的指导信号或期望信号，即定位或状态指标k的确定问题，这是离散概率事件的模式辨识问题.2)确定每个线性系统的训练数据后，利用线性ARMA系统预测算法估计(t),(t).
　　为解决上面的两个问题，将引入混合统计模型.根据线性近似模型(3)―(5)知道在某一时刻RNN的训练数据y1(t)将作为K个线性近似系统中的一个线性系统的指导信号.同时，由于RNN的输出包含高斯加性噪声干扰，那么受控系统的输出y1(t)可以利用如下统计模型来描述［1，5，6］
　(6)
　(7)
其中.根据上面的分析，知道状态指标k是一离散随机变量(也称为隐含变量)，为此引入变量，那么单隐元RNN的联合统计分布可写为
　(8)
对应的对数似然函数为
　(9)
令
r1,k(t)=δk(z),　r2,k(t)=y1(t)δk(z),　r3,k(t)=y21(t)δk(z),　(10)
　(11)
r(t)=［r1,1(t),…，r1,K(t),r2,1(t),…,r2,K(t),r3,1(t),…,r3,K(t)］T,
θ(t)=［θ1,1(t),…，θ1,K(t),θ2,1(t),…,θ2,K(t),θ3,1(t),…,θ3,K(t)］T.　(12)
那么，联合统计分布式(8)可写为
pr(t),θ(t)=py1(t),z=expθT(t)r(t)-φθ(t).　(13)
显然，观测量r(t)在自然参数θ(t)下为一指数族分布.但参数θ(t)为SRNN参数(t),(t)的非线性函数，因此，SRNN参数构成的集合为自然参数流形的子流形，是一曲指数族［1，7］.
　　在分布函数(13)式中，观测量r(t)包含隐含变量，观测量的统计期望η为另一与θ(t)对等的参数坐标系统，有关指数族与曲指数族的几何性质可参见文献［1，7］.
2.3　RNN参数估计
　　从以上的分析，可利用最大似然估计方法获得自然参数θ(t)的估计.然后，再利用θ(t)与参数(t),(t)的关系获得RNN参数估计.但是，在上面的指数族分布中，观测量r(t)包含隐含变量，因此，不能直接利用最大似然估计方法估计参数.这里采用基于信息几何的em-投影算法.
　　a)e-投影
　　根据上面的观测矢量，其中状态指标k为隐含未知的，y1(t)是已知可观测的.那么利用t时刻的自然参数估计(t)，可求得观测量r(t)的估计为
　(14)
　(15)
其中αk=pk｜y1,k(t)表示训练数据y1(t)可作为第k个线性ARMA系统指导信号的概率，由下式估计
　(16)
　　b)m投影
　　根据信息几何的理论，知道在指数族分布中，观测量的期望参数为一充分统计量，因此，可以利用期望参数来获得自然参数的估计.根据观测量的表示式，观测量的期望参数估计为
　(17)
当ρ=0时，式(17)为无记忆的期望参数估计.那么，自然参数估计为
　(18)
其中GT为Fisher信息矩阵G的逆矩阵，η(θ(t))为参数估计(t)下的期望参数.
　　令

为RNN预测的参数估计，并设参数与自然参数(t)的关系为.那么，参数的估计为
　(19)
　　根据文献［1，7］，式(2)―(10)，式(19)中的.当式(17)中的ρ=0，即观测量的期望参数取为无记忆估计时，式(19)的可展开为
=y(t)e(t),　(20)
其中y(t)=［y1(t),…,y1(t-I),x(t),…,x(t-M+1)］T.
　　将式(20)代入式(19)，并与文献［2，3，4］中的一般线性ARMA系统预测参数估计算法比较，可以看到SRNN预测参数估计公式与一般的线性ARMA系统预测的参数估计基本相同，只是其中的误差与线性ARMA系统稍有不同.因此，通过近似处理，将非线性SRNN预测转化为线性ARMA系统预测问题.线性ARMA系统预测参数估计的各种算法和算法收敛性质分析可直接应用到m-投影参数估计中.同样利用信息几何的批处理方法，可以求得πk,σ2的估计［1，6，7］.注意这里的em-投影算法是交替迭代获得参数估计的［1，7］.
2.4　RNN最小均方预测误差控制规律
　　在上述线性近似模型及信息几何的描述下，有两种方法可以计算RNN的最小均方预测误差控制规律.设RNN控制器的期望信号为d1(t).
　　方法1.在获得了RNN参数估计后，RNN预测可写为
　(21)
令,那么式(21)可简化为
　(22)
显然，式(22)为一具有时变系数的线性ARMA系统，因此它的控制规律，如控制输入信号可采用线性ARMA系统的自适应预测控制规律的设计方法来获得［4］.
　　方法2.在上面的RNN预测训练数据的分布(13)式中，自然参数θ(t)为受控系统输入信号x(t)的函数.因此，可通过先估计自然参数，然后利用自然参数与受控系统输入信号的关系，求出RNN控制器的输入信号.
　　将指数分布(13)式中的观测量r(t)改造为
r(t)=［α1,…，αK,α1d1(t),…，αKd1(t),α1d21(t),…，αKd21(t)］T.　(23)
利用上面的em-投影算法可求出y1,k(t),k=1,…，K(它们为受控系统输入x(t)的函数)，然后根据关系式(4)，即可求出RNN控制系统的输入信号.
　　从上面的讨论看出，非线性RNN的控制问题完全转化为线性ARMA系统的预测控制问题.同时，也可根据线性ARMA系统的稳定性分析方法分析非线性RNN控制系统的稳定性问题.关于稳定性分析，限于篇幅，本文不再讨论.
3　具有多隐元的复杂RNN预测控制
　　根据单隐元SRNN模型，多隐元的RNN预测的局部线性近似模型示于图1.对于多隐元RNN的预测若能分解为多个单隐元RNN预测，那么多隐元RNN的预测控制问题也就转化为多个单隐元RNN的预测控制问题.


图1　多隐元的RNN预测局部线性近似模型

　　在上面的模型中，多个单隐元RNN的输出合成作为RNN预测的输出.因此，如果RNN每一隐元对应的训练数据或期望信号确知，那么多隐元RNN的参数估计、自适应控制即为多个单隐元RNN的分别控制及参数估计.但是，多隐元RNN预测每一隐元的训练数据、期望信号并没有给出，需要在参数估计的过程中估计每一隐元的训练数据、期望信号.这里，采用如下简单的估计方式给出各隐元的训练数据、期望信号.第l隐元在t+1时刻的训练数据、期望信号分别为
　(24)
其中为利用t时刻参数估计的第i隐元的一步前后预测输出信号［4］.
　　在多隐元RNN的每一隐元获得了训练数据及期望信号后，多隐元RNN预测的参数估计以及预测控制也就转化为多个单隐元的参数估计、控制问题，可利用本文第二部分提出的方法解决.
　　注意在多隐元RNN转化为多个单隐元控制问题以后，它是一个多输入、多输出(MIMO)的线性ARMA系统，需利用MIMO线性ARMA系统的参数估计、控制方法来解决参数估计及控制问题［4］.
4　计算机模拟实验结果
　　实验模型如下
　(25)
y(t)=y′(t)+n(t),　(26)
其中n(t)=0.8n(t-1)+w(t),w(t)为零均值高斯白噪声.RNN预测取与式(25)，(26)同阶的预测形式，每一隐元的局部线性化数目取为11.RNN控制的期望信号取为方波.
　　图2为部分实验结果，其中(a)为RNN控制的期望信号d(t)和受控系统(25)，(26)的控制输出信号；(b)为RNN控制器控制输入信号；(c)RNN预测系统的参数估计学习曲线，它是30次独立的计算机模拟结果的平均，曲线表征了RNN预测参数估计或系统辨识的收敛性能.从图2可看出，本文提出的RNN预测控制器的设计方法是完全可行的.


图2　预测控制实验结果
5　结　论
　　本文利用SRNN的非线性激励函数的分段局部线性近似方法，将非线性SRNN转化为混合统计模型表示的统计预测问题.利用信息几何的em-投影算法，SRNN预测转化为线性ARMA系统的预测问题，最终利用线性ARMA系统预测控制的结论解决非线性SRNN的预测控制问题.
作者简介：戴宪华　1992年毕业于东南大学，获博士学位.1993―1994年在华南理工大学通信与电子系统博士后流动站工作；1995年至今，在汕头大学电子工程系任教，同年获得副教授任职资格.主要科研领域：非线性信号处理，语音信号处理，通信系统均衡，自适应控制等.
作者单位：汕头大学电子工程系　广东　515063
参考文献
1　Shuninch Amari.Information geometry of the EM and em algorithms for neural networks.Neural Network,1995,8(9):1379―1408
2　Anderson B D O.Stability of adaptive systems:passivity and averaging analysis.Cambridge,London,The MIT Press,1984
3　Kumar P R.Stochastic systems estimation,identificaion and adaptice control. Englewood Cliffs,NJ:PrenticeHall,Inc.1986
4　Graham C.Goodwin Adaptive filtering prediction and control.Englewood Cliffs,NJ:PrenticeHall,Inc.1984
5　Xuan J.Information geometry of maximum partial likelihood estimation for channel equalization.In:ICASSP'96:3533―3566
6　Roy L.Streit maximum likelihood training of probabilistic neural network.IEEE Trans.Neural Network,1994,5(5):764―783
7　Shuninch Amari.Differential geometry of curved exponential familycurvature and information loss.The Annual of statistics,1982,10(2):357―385
收稿日期：1997-06-04
修稿日期：1998-02-06
