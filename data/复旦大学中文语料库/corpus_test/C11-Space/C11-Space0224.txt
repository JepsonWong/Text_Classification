�ѧ��
JOURNAL OF ASTRONAUTICS
1999�� ��2�ڡ�No.2 1999



�г��������Ұֵ���ͳ����ϼ���
�����֡������
����ժ��Ҫ������������Ұֵ�����ѧ�����Զ���,������Ұֵ�ķ���ģ��,�����˶��Ұֵ�㼰Ұֵ�ߵ�ġ��Ƚ�-��Ȼ�ȡ����鼼��,�������˷�����㡣
��������ʡ�ͳ����ϡ�Ұֵ����ģ
STATISTICAL DIAGNOSIS METHOD FOR 
OUTLIERS FROM SPACECRAFT TRACKING DATA
Hu Shaolin Sun Guoji
(System Engineering Institute,Xi'an Jiaotong University.Xi'an.710049)
����Abstract��A modified definition and some classified models are built for outliers,a high efficient ��robust-LR (LR:likelihood ratio) unit_test��method is established to detect and to diagnose multi-outliers or patch-types outliers from measurement data set,and a simulation is done to show the availability of this new diagnosis approach.
����Key words��Statistical diagnosis Outliers Modeling
1��������
����������֪,�����ǰг��������ݸ߾��ȴ����й㷺���õĶ���ʽ�˲�������ƽ��΢�ּ����������׷�������,���ǻ���Kalman�˲����۵�ʵʱԤ���Ϳ��Ƽ���,��Ӧ��ͳ��ѧ�ĽǶȶ����Կ���Ϊ:��һ���Ĺ�ʽ��ģ�ͼٶ���,���ݶԶ�̬Ŀ���һ����ٲ����������γɵ����ݼ���D,����ͳ�ƵĻ��źŴ���ķ������������ƻ�Ԥ��Ŀ���˶�״̬�����ԡ��ɴ˿ɼ�,���ݼ���D�ǽ���ͳ���ƶϻ򹤳̾��ߵ����,����D�и����ݵ���������,ֱ��Ӱ�������������о��ľ�ȷ�ȺͿɿ��ԡ�
�����������г�������ݴ�������ʵ����������,��ʹ�Ǹ߾��ȵĲ����豸,���ڶ���żȻ���ص��ۺ�Ӱ�������,�������ݼ�������������1��2%��ʱ�������10��20%(����,�״���и����Ǹ���)�����ݵ�����ƫ��Ŀ����ֵ���������ݴ���������ⲿ���쳣����ΪҰֵ��
����Ұֵ�Ը߾������ݴ���������ʮ�ֲ�����Ӱ�졣����ʮ����,����ͳ�ƽ�������о��������,�����ǻ�����С�������۵�ģ�Ͳ������Ź��ơ����������˲��㷨(��������ʽ�˲������Kalman�˲���)����Ƶ�׷����������ļ������׹���,�Բ��������а�����Ұֵ�㷴Ӧ����Ϊ���У�1,2,5,7,8�ݡ��������ݴ����ʵ��Ҳ֤ʵ,�ں���г�����������º�������,�������ݺ����Լ���������Ԥ����������Ҫһ�������ԸĽ��������ľ��ȡ���ߴ������������൱����Ҫ�ԡ�
������������Ұֵ���ʶ�𷽷��ʹ�������һ���漰����ѧ��֪ʶ�ۺ����õ�Ӧ�����о����⡣���ں��칤���и��೤���β������ݼ���,Ҫ׼ȷʶ��������е�ȫ��Ұֵ����һ��ʮ�ֲ����׵��¡��ر������Ź��̶����ӻ��͸��ټ����Ѹ���ռ�,�������������ݼ���Խ��Խ������ά��Խ���ظ�,�������������������Ұֵ��Ĺ������Խ�������ѡ����,������Ч���ɿ���Ұֵ��������Ϸ���,���Ҫ������Ϊ�������ݴ������������ӡ�
��������,��Ұֵ���ģ�ͷ�������,����һ�׼������Ұֵ���ͳ���㷨��
2��Ұֵ��Ľ�ģ
����ʲô��Ұֵ?��̽�������ݷ��������ݴ���������,Ұֵ�ֳ��쳣ֵ(Outliers)���䶨��һֱ������ȷ,�ֲ�̬ͬ�ȵ�Ӧ��ͳ��ѧ�Ҷ��䶨��Ҳ��һ����5�ݡ��������ģ�5���жԼ��ֳ��õĶ�����й���Ϊ�꾡�������ͱȽϡ�
�������Ľ������Ұֵ��Ķ���Ϊ:����D������ƫ��󲿷��������������Ƶ�С�������ݵ㡣��һ����ǿ���������������ֵġ����ơ�,��ƫ�����ݼ�������ı仯����Ϊ�б��쳣��������,����ȷָ��Ұֵ�ڼ���D��ֻռС����(����಻����һ��),���ֱ�����Ǻ���ġ������岻�����Ը��Ǽ������������,����Edeworth(1887)�Ķ�����ģ�6,7�ݵĶ���,����Ҳ������ʱ�����м����ϵͳ�е�Ұֵ��������,���н�Ϊ�㷺����Ӧ�ԡ�
2.1��Ұֵ��ĳ������
�����������ݼ����г���Ұֵ���ԭ��ܶࡣ�ͺ���г������������ݶ���,����Ұֵ��Ҫ�����¼��������ԭ��:
����(1)�����ͼ�¼ʱ�Ĺ�ʧ,�Լ����ݸ��ƺͼ��㴦��ʱ�����ֵĹ�ʧ�Դ����ɴ˲���������Ϊ��ʧ���(Gross Error)��
����(2)���������ı仯��ȡ��ĸ���ͻȻ�ı�ʹ�ò���������ԭ��������ģ�Ͳ�����,�����ز���ʱ���������ͻ������ĳ��֡��״����ʱӦ�������״̬�Ĳ��ȶ����г�����ʱ����Ŀ��ı��������ػ��㸽����ȡ��,�ȵȡ�
����(3)ʵ�ʲ���������Ҳ���ܳ�����һ���쳣����,���Ȳ������Բ����ʹ���Ĺ�ʧҲ������ͻ����ǿӰ�����ص��µ�,����ĳЩ���ӳ�β�ֲ�(long-tailed distribution)���������(����,����t�ֲ����������)���õĽ����
2.2��Ұֵ��ķ���
�������̲��������г��ֵ�Ұֵ��,�Ƚϳ����������¼�������:
����(1)��Ⱥ�㡡�ֳ�����,��ͳ������������о������Ҳ�Ƚϳ����һ���7�ݡ����������������,Ұֵ����Ҫ����Ϊ��Ⱥ�㡣
����(2)������Ұֵ�����Ļ����ص���,ĳһ����ʱ��ti���Ĳ��������Ƿ�ΪҰֵ��ti-1��ti+1ʱ�����ݵ������ޱ�Ȼ��ϵ������,�Ƚϳ������ǵ�tiʱ�̵Ĳ������ݳ����쳣ʱ,��tiʱ�̵�һ��������(���ʱ��)�������������Ǻõ�,��Ұֵ��ĳ����ǹ����ġ�ĸ�岻����������,��̬���������й���(isolated)�쳣ֵ�ĳ���Ҳ�ǱȽ��ձ������֮һ��
����(3)Ұֵ�ߵ㡡��ưߵ�(Patchy),��ָ��Ƭ���ֵ��쳣���ݡ����Ļ���������,��ti-pʱ�̳��ֵ�Ұֵ,Ҳ���ܴ���y(ti-p+1),��,y(ti)������ƫ����ֵ���״���ٸ�����Ŀ��Ĳ�������������,Ұֵ�ߵ�ĳ����ǱȽϳ����Ĺ�������
2.3��Ұֵ���ģ������
�����ٶ�ĳ��վ�Կռ����Ŀ����и��ٹ۲�,�ǲ������ݼ���Ϊ
������������D={y(t1),��y(tN)}����������������������������(1)
����(1)�������ݵġ�����(additive)���ֽ�:����Ŀ���˶���������,���ǿ��Լٶ���������y��(t)�ɺ���طֽ���Ĳ���:
������������y(t)=ytr(t)+yp(t)+��s(t)+��0(t)��������������(2)
���У���ytr(t)��Ϊ���Ʒ���,��������Ŀ��������˶�;
��������yp(t)��Ϊ���ڷ���,��������Ŀ�������Ա仯,��Ŀ�������ԡ���������ͬʱ,�������Ա仯��������,ÿ��һ��ʱ����˶�״������һ����������;
�������ۦ�s(t)�ǲ����������������,��ӳ���ǲ����豸״̬�������Ŀ����л����ж��ֲ�ȷ�����Ŷ���ͬ���õĽ����
�������ܦ�0(t)��Ϊ���̵���Ⱦ������ͻ���Է���,�����ý����ʹ�������ݷ�������ƫ��,��������ҪôΪ��,Ҫô���������������׼��,��
��������������������������������������(3)
ʽ��,��Ϊ�쳣���ݳ��ֵļ��ʡ��������ݷ�������,��ͨ������1%��2.5%֮�䡣
����(2)�����쳣����(Additive Outliers,AO)ģ��:��ĳЩ����ʱ��ti0,���ڲ�������ͻȻ������ǿӰ������Ӱ��,�Լ���¼�������ʧ��,ʹ�ò�����������ƫ��󲿷����������ֵ�����,��ģ������Ϊ:
��������������0(t)=�˦�(i,i0)����������������������������(4)
ʽ��,��Ϊ���������쳣����,��(i,i0)ΪKronecker delta������
����(3)��Ϣ�쳣����(Innovation Outliers,IO)ģ�ͣ�4��:���ڹ۲�ֵģ��(2),��������̦�0��(t)���ӳ�β�ֲ��Ҿ��й���ƽ����ʱ,����ƽ��������̼��ִ�ʱ�����з�������,�ɽ�һ���ٶ���0(t)����ARMA(p,q)ģ�͡�
3��Ұֵ���ͳ�����
�������ڼ�������������Ұֵ���ʶ��,���ף�1,6,7�ݼ��������ο������ж�����ϸ������;����Ұֵ���������,Ҳ�Ѿ��д������о��ɹ��ɹ����ã�4��;���ڶ��Ұֵ��(�ر��ǰߵ���Ұֵ)������봦��,���漰������ǰ��������,�������׵ĳɹ��Ĵ�����������в������
�������ǵ��ߵ���Ұֵ��ͳ����ϵļ����ѶȺ͹���ʵ�ü�ֵ,���Ľ��Դ˽���һЩ������̽�����о������ĵĻ����뷨��,�������β������ݼ�����Ұֵ�����Ϻʹ������ֳ������׶�:
�������ݴ���:����һ���Ƚ��ġ����ġ�����;
�����ڿ��ɵ��ɸѡ:ͨ��ʵ��������á����ġ����ߵıȽ�,����ȷ�������ܰ���Ұֵ�����s��������λ��(ti1,��,tis);
������ͳ�����:�������ͳ�����ͼ�������,��һ����ʵ������ȷ����s����������ȷʵΪ�쳣���ݡ�
��������,�ӹ���Ӧ�õĽǶȽ�����ʵ����һ�����Ļ������輰�����㷨��
3.1�������ġ����Ƚ�����ʽ���
�������ݷ������˶�ѧ�͹������ѧ����,���Լٶ�:�����޳��ȵı��۲⻡����,Ŀ����˶��켣y(t)�Ǽ����������������ι⻬�ġ���Weierstrass�ƽ�����,��������y(t)���Ա���������ʽ�����Ƕ���ʽ���������һ�±ƽ�,��
������������(5)
����,TΪ�����Ա仯����ype��(t)���ݱ����ڡ�
��������ʽ(1)�����Ĳ������ݼ���D={y(ti):i=1,2,��,N},���ģ��(5)���Ը�дΪ���Իع�ģ�͵���ʽ:
������������������������������������(6)
ʽ�У�1)��
������2)����=(a0,a1,��,a1,b1,��bm,c1,��,cn)��,��(t)=��s(t)+��0(t)
���������������ģ�Ͳ��������¼������������ҵ�M-���Ƚ����Ʒ���:
����������������������������������������(7)
���У�1)��
������2)������(����c1��c2Ϊ�ʵ�ѡȡ�ķǸ�����)
������Ȼ,��ѡȡ����c1=+��ʱ,��(��)=0.5��2�ͦ�(��)=�ؾ�Ϊ�޽纯��,ʽ(7)Ϊ��С���˹��Ʒ���;���ʵ�ѡȡ����c1��c2Ϊ���޷Ǹ�����ʱ,��(��)�ͦ�(��)��Ϊ�н纯��,��ʱʽ(7)ȷ���Ĳ�������(,)Ϊ�Ƚ�-�����Թ���,�������õĿ�Ұֵ������
��������,����ģ�Ͳ���M-�͹��Ʒ���(7)��һ���������㷨:
��������(8)
���ó�ֵΪ:
��������������������������������(9)
���������������Ƚ�-���Ź���ֵ,���Ѹ�����������y��(t)�ľ��п�Ұֵ�����������Ƚ��������:
��������������������������(10)
ע��:�ڹ�������Ԥ����ʱ,Ϊ�˼򻯼���,Ҳ���ʵ�����������ʽ��Huber�ͻ�Hampel�ͦպ���:
����(1)����������������������������������(11)
����(2)��������������������������������(12)
ʽ��,cΪ�������ݺ;����ʵ�ѡȡ�ķǸ�������
3.2��Ұֵ��λ�õ�ȷ��
����������ٲ������ݼ���D�и����ݵ�Ĺ淶����ϲв�:
��������������������������(13)
������ϲв��ɢ��ͼ,����¼����ʹ��ʱ��㼰���ݸ���s�����á�3��׼�򡱿ɳ�����Ϊ��s�������п�����Ұֵ�㡣�ɴ˵ó�����ΪҰֵ�����ݵ����s,�������ڵ�λ��{ti1,��,tis}��
3.3��Ұֵ�����Ȼ�ȼ���
�����ٶ�ģ��(2)�����������Ϊ����ͬ�ֲ�(iid)��Gauss�����������������ݼ���D�в���Ұֵʱ,����֤����7��:���ڿ��ɵ�{y(ti1),��,y(tis)}�Ƿ�ΪҰֵ�����Ȼ��ͳ����
��������������������������������(14)
ʽ��,Rss��Rss���ֱ�Ϊɾ�����ɵ�{y(ti1),��,y(tis)}ǰ/����С������ϵĲв�ƽ���͡�
������ʽ(14)���Կ���,��Ȼ�Ⱥ���LR(s)�ǵ��ϸ�������,������������̬�Լٶ��¿���֤����7��ͳ�������Ӳ���Ϊ�Ħ�-�ֲ������,�������ͳ����:
��������������������������������������(15)
Ϊ���ݺ����Լ����ͳ�Ƽ��ָ�ꡣ
�������������-�ֲ��Ħ��·�λ��ΪC��,��(��=0.05��0.025)����ͳ����LR(s)��1-C��ʱ,����100��(1-��)%�ĸ�����Ϊ����D�п��ɵ�{y(ti1),��,y(tis)}�������Ĺ������ݡ�
4���������
����ͼ1�Ǽ�����������ɵ�ĳ�ػ��״���ٿռ�Ŀ�ꡰ��������20������,����Ƶ��Ϊÿ��10�㡣ͼ1�е�50��91��110�͵�200��Ϊ�����ⲿ���ӷ����γɵ�22��Ұֵ��,������ѧģ��Ϊ�����������4�״�������ʽ,ģ���趨������(��1);����Ұֵ��ƫ����:��0(50)=-10,��0(150)=10;�ߵ���Ұֵ����ѧģ��Ϊ:��0(i+1)=1-��0(i),��0(90)=-5(i=90,��,109)��
��������������������,�±�1��ͬʱ������ģ��ϵ����(ȫ��)��С���˹��ơ���ʽ(8)��(9)�����M-���Ƚ����ƺ�(�޵�)��С���˹���,�Լ�������ϵĲв�ƽ���͡�
������
ͼ1����22��Ұֵ���������ɢ��ͼ������ͼ2������M-�͹��Ƶ�������ߡ�
����������1������ģ�Ͳ������趨ֵ��ͳ�ƹ���ֵ

��a0a1a2a3a4��Rss
�����趨����-5.016.0-0.5-0.030.0010.1��
ȫ����С����-4.85715.960-0.5157-0.027630.0009241.83099653.746
M-�͹���-4.93015.984-0.4998-0.029910.0009960.101392.00452
�޵���С����-4.94115.993-0.5017-0.029780.0009930.099741.71095

�����ֱ�M-�͹��ƺ�ȫ����С���˹��Ƽ��㲻ͬ��ϵı�׼���в�,��ͼ3��ͼ4��ʾ:
��������
ͼ3������M-�͹��Ƶı�׼����ϲв����ͼ4������ȫ����С���˹��Ƶ���ϲв�
�����ӱ�1��ͼ2���Կ���,M-�͹��ƾ������õĿ�ҰֵӰ������;��ͼ3�����Կ���,��ϲв��в���������ģ�͵����Ʒ���,�趨��22��Ұֵ������Ӧ�Ĳв����ֵ��ԶԶ����3,����в�ľ���ֵ���Ե�С��3,����3��׼���󱨿��ɵ�ĸ���Ϊ0;��ͼ4���Կ���,Ұֵ�����С������ϵĲ���Ӱ����ʮ�����Ե�,�����в��в��������Ե����Ʒ���,��22��Ұֵ���⻹��11����Ĳв����ֵ����3,����3��׼�򡱵����󱨿��ɵ�11����
����������˵��,���ĵġ��Ƚ�-��Ȼ�ȡ����鷽����Ұֵ�ߵ���нϸߵļ��Ч�ʺͿɿ��ԡ�
������л:�����������еõ������Ժʿ��ָ���Ͱ���,�ڴ˽���л����
�������ߵ�λ��������ͨ��ѧϵͳ�����о���.����.710049
�ο�����
��1��PJ.Huber FJ.Robust Statistics.Wiley,New York,1981
��2��Hampel,et.Robust Statistics-approach based on influence.John Wildy and Sons Press,1986
��3��������,�����.�����Բ����������Ƕ���ʽ�˲���Ԥ��.������ͨ��ѧѧ��,1996,30(2):110-116
��4��Tiao GC.Autoregressive Moving Average Models.Inter.Problems and Outlier Detection in Time Series,Handbook of Stat.5
��5�������,������.��̬�������ݿ������о�����.����ͳ����Ӧ�ø���,1996,11(3):244-248
��6��Wang Xueren,et.Assessment of Local Inference in Multivariate Analysis.Technical Reports(1990-1991),Yunnal University Press,1991
��7��Τ���ɵ�.ͳ���������.�Ͼ�:���ϴ�ѧ������,1991
��8������,�����.��̬����ϵͳ���н�Ӱ���˲�.�������ۼ�Ӧ��,1992,11(1):36-45
��������Ϊ������ͨ��ѧ�о�����ʿѧλ���Ļ���(DFXJU1998-10)����
�ո�����:1997��4��21��,�޻�����:1998��2��24��
