计算机应用
Computer Applications
1999年 第19卷　第8期 Vol.19　No.8 1999



面向对象技术和基于数据驱动的软件重用
王忠群
　　摘　要　 本文阐述了信息系统开发中的一种软件重用 技术――数据驱动机制，并通过实例证明这种机制的有效性。
　　关键词　 面向对象,属性,方法,软件重用,数据驱动
OBJECT―ORIENTED TECHNIQUE AND 
SOFTWARE REUSE BASED ON DATA DRIVING
Wang Zhongqun
Department of Computer Science, Anhui Institute of 
Mechanical and Electrical Engineering, Anhui.Wuhu 241000
　　Abstract　 In this paper software reuse technique is presented in information system development,that is data driving mechanics. Finally the efficiency is proved through a case.
　　Keywords　 Object―oriented, Property, Method, Software reuse, Data driving
1　软件重用
　　随着计算机技术应用的发展，一方面软件需求日益增加，另一方面应用软件开发效率低下，难以满足实际工作的需要。这迫使计算机专家们为软件开发寻求一些新的途径。从当前研究现状看有两种发展趋势：软件生产自动化(如程序自动生成技术)和软件重用技术 。程序自动生成技术是指计算机根据用户给出的问题描述自动生成程序的一种程序设计方法 ，从而实现用户只给出做什么，而不必说明如何去做；软件重用技术是指以一切可能的方法 对一切可以重复利用的软件产品进行重用。软件产品包括：软件系统文档、软件系统逻辑结 构、程序代码、测试数据、系统开发工具等，其中数据结构和程序代码是软件产品最重要的 方面，它的重用是软件重用最基本的技术之一。本文基于面向对象技术，从数据结构和程序 代码出发，提出一种数据驱动控制的软件重用技术，它可以在一定程度上实现软件的可重用，提高软件的开发效率。
2　面向对象技术和数据驱动机制
2.1　面向对象技术
　　对象类型是面向对象方法中的基本概念，由以下几部分组成［2］：
对象类型＝对象集＋状态集＋运算集＋方法集＋约束
　　其中对象集是一对象类型现有实例对象的动态集合，它随着对象的创建、撤消、进入、退出而动态地变化。对象还具有满足唯一性的永久标识，称之为对象标识。状态集是一类对象可能具有的合法状态的集合，通常对象集是静态的概念，对象状态由若干状态变量（即属性）组成。状态的合法性通过对象类型的约束条件来判定。运算集指可作用于所有对象集的运算的集合。方法集是对象为响应消息所能调用的自身操作的集合。约束规定了该类型对象的合法状态以及合法状态间的时序关系等约束条件。实例对象是动态的，可以通过方法的调用进行一系列状态的转换（即属性值的改变）。对象类型具有层次结构，子类型自动继承父类型的方法、状态变量和约束，也允许子类型增加新的方法、新的状态变量、重定义或取消父类型方法，但不允许减弱对象判定式，可见图1。
2.2　数据驱动机制
　　数据驱动是在编码实现阶段，基于面向对象分析和设计的结果，对对象状态属性集合中的部分属性值进行修改（实例对象的动态性）或者增加部分属性或者方法（子对象类型继承父对象类型），以达到对对象的动态控制，使其共享已有软件成分（方法）从而实现生成新的软件功能。对象的属性名可以用变量数组或者数据库中表的若干字段表示，那么若干实例对象(状态属性的值)则可以用二维数组或者数据文件或者表（数据库文件，如：.dbf）来表示，每一行代表一个实例对象。减化的对象类型的层次结构和数据驱动控制实现软件的可重用性原理可用图1表示。


图1
　　在图1中，我们把P、P1、Pn定义为状态属性值集合；M、M1、Mn定义为行为方法集合；PM、PM1、PMn定义为状态属性变量集合；DD为数据驱动控制模块，一方面负责依据对象标识来识别对象并且从相应的状态属性值集合中取值赋予状态属性变量集合中相应的变量（即动态对象实例化）以及行为方法的调用，另一方面负责对象实例间信息的传递。子类型自动继承父类型的方法、状态变量和约束，也允许子类型增加新的方法、新的状态变量、重定义或取消父类型方法。可重用软件成分是该对象类型的行为方法，表现为同类型对象共享行为方法模块以及子类型对象共享父类型对象行为方法模块。这需要用面向对象技术进行需求分析以及精心抽象和设计才可得到。下面我们用具体实例予以说明其应用。
3　应用实例
　　在我们设计的医院财务管理信息系统中，由于在系统分析和设计时使用了面向对象技术，实现时使用数据驱动软件重用技术，使得整个系统的开发工作量大为减少，而且系统具有较好的可维护性、可扩充性。
　　医院的财务科目为三级科目，即总帐科目、一级科目、二级科目。总帐科目有诸如：固定资产、医疗收入、药品收入、制剂收入、医疗支出、药品支出、制剂支出、管理费用等等。例如总帐科目医疗收入、药品收入以及其明细科目编码如表1所示。
表1　科目编码

总帐科目一级科目二级科目
………………
医疗收入（503）门诊收入（50301）检查费（5030101)
医疗收入（503）门诊收入（50301）治疗费（5030102)
………………
医疗收入（503）住院收入（50302）检查费（5030201)
医疗收入（503）住院收入（50302）治疗费（5030202)
………………
药品收入（504）门诊收入（50401）西药费（5040101)
药品收入（504）门诊收入（50401）中药费（5040102)
………………
药品收入（504）住院收入（50402）西药费（5040201)
药品收入（504）住院收入（50402）中药费（5040202)
………………

3.1　系统界面的实现［3］
　　医院的财务系统涉及各种帐簿的凭证记帐、查询、打印以及其它多种功能，一个通用的菜单系统（菜单模块重用）显得较为重要。我们把每次调用显示菜单设计为菜单对象，把具体若干菜单项目内容、标题、显示位置以及其他修饰属性等设计为菜单对象的属性；具体菜单显示、菜单项选择等操作作为菜单对象的行为方法。把所有的菜单实例对象属性值放入菜单数据文件（或者数据库文件或者表）中。每次菜单调用时，从菜单数据文件中取出响应菜单对象的属性值赋予该菜单对象的属性变量（即例化了一个菜单对象），然后调用对象行为方法。这种设计的菜单系统使得整个系统菜单驱动只用一个模块并且可用于其它系统的应用程序集成［3］。
　　如果把下拉列表框等实现显示和选择功能作为菜单对象的行为方法，就可以实现用户界面的下拉列表框等多种形式，使其更加方便和友好。
3.2　凭证记帐模块的实现［3］
　　凭证记帐模块是财务管理信息系统的核心模块，我们把每个总帐、现金日记帐、银行日记帐、多栏式明细帐、三栏式明细帐、往来明细帐等都设计成相应的电子帐簿数据库文件（表）。下面我们详细叙述多栏式明细帐记帐模块的设计和实现。
　　医院财务涉及到多种多栏式明细帐，其栏目各不相同（对应于各自相应的二级科目且二级科目数不同），设计其帐簿数据库文件时，我们首先进行抽象化设计，把所有多栏式明细帐的数据库文件的字段属性都以统一的字段变量表示（如：A1，A2，.....，An），而不赋予具体的科目名称（其含义名称可以从科目编码得到，也称静态数据分离），Ai的真正编码有三部分构成，即：总帐科目+一级科目+i。一旦属性赋予具体的科目，就可得到相对应的电子帐簿，如医疗收入（503）中的门诊收入（01）电子帐簿数据库文件（MZ50301.DBF）和住院收入（02）电子帐簿数据库文件（MZ50302.DBF）中都有A1这个属性，可是它们所表示的科目编码（科目名称可以从科目编码表得到）分别为5030101（医疗收入的门诊收入的检查费）和5030201（医疗收入的住院收入的检查费）。
　　我们把多栏式明细帐电子帐簿（一级科目）作为一个对象（如：医疗门诊收入、医疗住院收入等。MZ+一级科目，如MZ50301.DBF为对象标识），具有相同二级科目数的一级科目的帐簿设计为一对象类型，其属性为A1，A2，....，An；其方法为凭证记帐、显示帐簿、打印帐簿等。在所有帐簿对象中，其属性集合(A1，..Ai，...An)是变化的，即n的值不定（即对象分属于不同的对象类型，但仍具有对象类型的层次结构），并且其属性所对应的具体含义（汉字名称）也随着不同的电子帐簿而不同。根据每笔帐的科目编码(二级科目编码,如：5030203)字段的部分内容知道该条记录应记入的电子帐簿以及哪个字段，即把二级科目编码分成二部分，前五位作为一部分(如：50302)，后二位作为一部分(03)。通过处理得到电子帐簿数据库文件名和待记字段名（如：对象标识“MZ50302.DBF”和“A3”），分别赋给对象的标识和其属性用于打开电子帐簿数据库文件(MZ50302.DBF) 和把借方或者贷方金额数据所需记入的属性字段（A3）。这样对于所有属于多栏式明细帐的记帐凭证的记帐都可以通过对其科目编码的变换给电子帐簿对象的标识和属性赋值而重用多栏式明细帐记帐模块。这样用一个模块完成了所有多栏式明细帐的记帐功能。下面给出凭证记帐算法。
　　对于多栏式明细帐设计相应的帐簿名称数据库文件，其中的记录是它们的各自电子帐簿名称,其记帐工作流程（算法）如下：
　　1) 打开当月凭证库文件；
　　2) 取当前记录；
　　3) 在另外工作区打开相应的明细帐电子帐簿库文件（依据对象标识的库文件），记入该条记录，关闭该库文件；
　　4) 凭证库文件记录指针下移一条记录；
　　5) 凭证库文件遇到结束标记否？如未遇到结束标记则转2)；
　　6) 记帐结束。
4　结论
　　为了提高软件开发效率、降低开发成本，人们一直在寻求好的开发方法，软件重用技术在这方面担负着重要作用。本文提出的面向对象和基于数据驱动的软件重用技术不仅可以提高软件重用程度，减少工作量，而且可以方便地维护扩充系统，使系统具有较好的可维护性。实践已经证明，这是一项行之有效的软件可重用开发技术。
作者简介：王忠群　硕士，讲师。主要研究方向：数据库系统、MIS以及面向对象技术。
作者单位：王忠群　安徽机电学院计算机系　安徽.芜湖（241000）
参考文献
　［1］　 Bruce Barnes,Terry Bollinger. Making Reuse Cost-Effective. IEEE Software,1991;(1):13-24
　［2］　 袁晓东，陈家骏，郑国梁．面向对象方法中的类型概念．计算机研究与发展，1997；34(10)
　［3］　王忠群．管理信息系统的集成技术研究．计算机应用，1998；18(6)
　［4］　 蔡希尧．面向对象技术述评．计算机应用，1996；16(4)
　［5］　康　丽，徐洁磐．面向对象的信息系统分析之我见．微型计算机，1996；16(3) 
　　收稿日期:1999-02-08(修改稿)
