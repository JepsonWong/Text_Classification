计算机工程
COMPUTER ENGINEERING
1999年 第25卷 第10期 Vol.25 No.10 1999



用途广泛的多协议语音编译码器
聂幼三　刘千红　周申克　宋国文　薛向阳
摘要：介绍一种具有多种协议处理能力的语音处理编译码器。该编译码器可支持ITU-T G.711、G.722、G.723.1和G.728等建议标准，其中G.723.1是IP电话主流建议标准。同时给出两种多协议语音处理平台的实例。
关键词：语音编译码；语音压缩/解压；多协议语音编译码器
A Multi-protocol Vodec Used in the Various Applications
Nie Yousan1 Liu Qianhong1 Zhou Shenke1 Song Guowen1 Xue Xiangyang2
(1.Shanghai Branch,Southwest Electronics&Teleconmunications Institute,Shanghai 2000434;2.Department of Computer,Fudan University,Shanghai 200434)
【Abstract】In this paper,we first introduce a multi-protocol voice codec,then,discuss two possible applications,The codec supports G.711,G722,G728 and G.723.1 of ITU-T.G.723.1 is used for phone over IP.
【Key words】Codec;Voice cimpress/decompress;Multi-protocol
　　语音编译码器是采用某种算法，利用数字语音信号的冗余以及人耳对声音感受的固有特性，对表示语言的数字信号进行不同程度的压缩处理，从而减少对存储资源的占用。
　　在选择编码方式上，人们通常考虑几个因素：话音的质量、编码的复杂程度、比特率。
　　高比特率固然会带来好的话音品质，但同时会占用大量的存储空间及更多的系统处理资源。不过，低比特率下获得好的话音品质则需要复杂度较高的编码方式，或者用较高比特率的代价(也可能用更多的通道、存储容量等)来稍稍减低编码的复杂度。适用于所有实际应用环境的语音编码器是不存在的，语音编码器必须在语音品质及比特率之间进行折衷。实际运用的理想语音编译码器应该可以根据传输信道的不同状况(带宽、QoS等)而改变编码方式，多协议语音处理平台是为此目的开发的。其初衷在于期望语音编译码器具有多协议处理能力、可与多种接口方式互连、支持多种控制方式，以便在应用中能根据传输信道状况的变化随意改变编码方式，从而获得最佳的语音通信效果。
1　多协议语音编译码器套片简介
　　JADE-MM(Joint Audio Decode Multimod)和ARCOFI-SP(Audio Ringing Codec Filter Featuring Speakerphone Function)是Siemens公司1997年推出的多协议语音处理专用套片中的两个主要芯片。
1.1 JADE-MM的主要特点
　　JADE-MM是一个非常有特色的多协议语音全双工压缩/解压处理芯片，其功能如图1。

图1 JADE-MM功能框图
　　JADE-MM的第一个主要特点是可以完成多种协议的语音编译码：
　　・  G.728(16Kb/s，低延迟码激励线性预测LD-CELP)全双工压缩编码输入和解压译码输出；
　　・  G.723.1(5.3Kb/s，代数码激励线性预测ACELP；或6.3Kb/s，多脉冲最大似然量化MP-MLQ)全双工压缩编码输入和解压译码输出；
　　・  G.722(48Kb/s、56kB/S、64Kb/s，子带编码自适应差分脉冲编码调制SBC-ADPCM)全双工压缩编码输入和解压译码输出；
　　・  G.711(64Kb/s，脉冲编码调制 PCM，A-law/μ-law)全双工压缩编码输入和解压译码输出；
　　・  16bit线性语音全双工编码输入和译码输出。
　　JADE-MM第二个特点是支持多种语音数据I/O的组合方式：
　　・  IOM-2接口输入(输出)/SAI接口输出(输入)
　　・  IOM-2接口输入(输出)/HOST接口(ISA、PCI、…)输出(输入)
　　・  HOST接口(ISA、PCI、…)输入(输出)/HOST接口
　　(ISA、PCI、…)输出(输入)
　　SAI(串行音频接口)是一个具有时钟(SCLK)、接收/发送(SR/TR)和帧同步(RFS/TFS)的接口，支持HDLC格式的语音数据传送。IOM2(ISDN-Oriented Modular)是一个类似N-ISDN基本速率接口(2B+D)的接口，具有数据时钟(DCL)、数据下载/上载(DD/DU)以及帧同步(FSC)。此外，JADE-MM还提供一个并行接口(HOST)，供目标系统与PC机或其它MCU相连。
　　JADE-MM第三个特点是提供了带内控制(Inband)和带外控制(Outband)两种控制方式：
　　・ 带内控制方式主要用于独立的应用系统，诸如2.2中提到的H.261会议电视实时处理系统。带内控制方式将对该卡的控制方式与预处理的语音数据打成一个HDLC包，通过SAI接口控制使用JADE-MM。
　　・ 带外控制方式则以总线形式与PC机(或其它MCU)连接，利用PC机的已有硬软件资源协作形成应用系统，完成LAN网、IP网上的多媒体通信。诸如2.1中提到的实时多协议语音编译码卡。
　　・ 带内/带外控制均可根据应用需要完成对该卡的如下控制：
　　(1) 多种语音压缩/解压协议的设置和转换；
　　(2) 多种语音数据输入/输出方式的设置和转换；
　　(3) 多协议语音编译码器音量、静音等设置和转换。
1.2 ARCOFI-SP的主要特点
　　ARCOFI-SP是一个与JADE-MM配套的专用芯片，提供数字电话的语音、振铃、编译码、滤波器处理的一揽子解决方案。ARCOFI-SP的应用硬件和软件均已包含在内，无须任何额外的元器件，便可直接驱动扬声器和麦克风。ARCOFI-SP的功能如图2。

图2 ARCOFI-SP的功能框图
2　两种多协议语音实时处理平台的实现
2.1 Internet网上实时语音传输
　　Internet网实时语音传输，是国家科委863项目(863-317-9604-01)的一部分。为了在IP网上以一定服务质量传输多媒体数据、实现RTP(实时传输协议)和RSVP(资源预约协议)的功能，需完成语音数据的实时采集、压缩、解压缩、回放；实现语音数据在网络上的传输。在语音数据上加入RTP和RTCP(实时传输控制协议)功能，来监测数据的传输情况；在语音数据的传输路线上加入RSVP功能，使语音数据传输首先得到路由器的带宽保证。显然，语音数据的实时采集、压缩、解压缩、回放是其中十分重要的部分。
　　采用JADE-MM和ARCOFI-SP开发的实时多协议语音编译码卡，使用带外控制方式，硬件组成结构如图3。

图3 实时多协议语音编译码卡硬件组成结构
　　语音的实时采集、压缩/解压、回放均通过实时多协议语音编码卡完成。语音数据经麦克风采集后按相应语音协议压缩，形成IP包格式。采用UDP协议进行IP网传输。由于UDP协议不处理传输过程中IP包的延时、丢失等问题，故在采集的实时语音数据增加RTP的报头，来监视数据传送的服务质量(QoS)。RTCP则用来将接收方监测的QoS包括传送的序列号、丢失、抖动等发回发送方。发送方根据RTCP的状态改变语音的压缩编码协议，并加入RTP，使话音质量得以保证。实时语音数据在传送过程中还采用了RSVP，通过应用程序向路由器申请一定带宽方式，获得语音质量更好的QoS效果。
2.2 H.261会议电视系统中实时多协议处理语音平台
　　H.261会议电视系统的实时多协议语音处理平台是采用JADE-MM和ARCOFI-SP开发的另一设备。由于H.261会议电视系统的音频接口具有多协议(ITU-T G.711、G.722、G.728)的特征，为灵活控制和便于扩展起见，使用带内控制方式构成硬件平台如图4。

图4 H.261会议电视实时多协议语音处理平台
　　H.261会议电视系统线路接口完成E1接口的转换，E1接口帧接口符合ITU-T G.704标准、电平符合ITU-T G.703标准；视频、音频及辅助数据的复接和分接符合ITU-T H.221标准；视频压缩/解压缩符合ITU-T H.261标准；音频压缩/解压缩符合ITU-T G.711、G.722、G.728标准。
　　线路接口采用了E1接口专用芯片，完成HDB3码转换、时钟提取。H.221标准的复用处理则使用DSP信号处理片完成。经DSP处理后的视频和音频数据，一路送给H.261标准压缩/解压缩专用芯片处理，并可直接与模拟视频输出/输入设备相连；另一路送给实时多协议语音处理平台。
　　实时多协议语音处理平台采用带内控制方式。H.221复接处理后，按照H.221协议指示的不同语音协议，构成对JADE-MM的控制，并将控制数据和语音数据打成一个HDLC包，按一定的时间间隔发送给JADE-MM，解压处理后由ARCOFI-SP直接驱动扬声器输出。从麦克风输入的会议电视音频信号，经ARCOFI-SP进入JADE-MM，按指定语音协议压缩处理后，在JADE-MM中形成状态数据和语音数据，再由H.221复接处理上线路传输。
3　结束语
　　现今的IT产业仍遵循摩尔定律发展，因此无论是计算机产品还是通信产品均已大量采用全定制或半定制大规模集成电路。作者认为，对于通信终端设备的开发，应利用Internet网获取信息的优势，大量采用专有芯片，加快研制适应市场需求的通信设备。
基金项目：国家通信项目（863-317-9604-01）
作者简介：聂幼三（1955～），男，高级工程师，主研方向：通信终端设备
作者单位：聂幼三　刘千红　周申克　宋国文（西南电子电信技术研究所上海分所，上海　200434）
　　　　　薛向阳（复旦大学计算机系，上海200434）
参考文献
1 Siemens.Joint Audio Decoder-Encode-Multimode.Data Sheet1998-07-01
2 Siemens.Audio Ringing Codec Filter Featuring Speakerphone Function.User's Manual 1995-06
收稿日期：1999-02-05
