计算机应用研究
APPLICATION RESEARCH OF COMPUTERS
2000 Vol.17 No.3 P.69-70,75




可视化技术在电力变压器状态检测专家系统中的应用
姜远　周志华　陈世福
摘　要：将可视化技术应用于电力变压器状态检测专家系统，通过对变压器油中溶解气体色谱数据作二维、三维可视化处理，不仅使得变压器故障点清晰直观，易于判断处理，还减轻了传统分析方法所需的计算负载，较大地提高了诊断效率。
关键词：可视化 故障诊断 专家系统 色谱分析 图象处理
1　引言
　　可视化是一种特殊的计算方法，它把数字符号转换为几何图象或图形，使研究者能观察其模拟和计算过程并进行交互控制。科学计算可视化为人们提供了一种发现不可见信息的方法，丰富了科学发现的过程，给予人们深刻和意想不到的洞察力，从而使人们的研究方式发生了根本的变化[1]。通过对数据进行可视化处理，可以将难以理解的数字信息转化为具有明显几何特征的图形图象信息，不仅可以丰富人机界面，还可以利用人对于空间形象的敏感性，更迅速更准确地发掘数据中蕴涵的信息。因此，可视化技术已成为计算机应用的研究热点，在很多领域都获得了成功[2,3]。
　　电力变压器是电力系统中的重要设备，为了保证其安全运行，需要对运行中的变压器进行检测，及时取得反映其运行状态变化的信息，从而判断是否存在故障隐患。由于变压器型号众多，很多故障现象与其早期症状之间的对应关系还难以用精确的数学模型进行描述[4,5]，因此，将可视化技术应用于该领域是一个很有前途的研究方向。
　　我们在国家电力公司电力科学研究院和山东省电力科学研究院的支持下，成功地研制了一个电力变压器运行状态检测专家系统。该系统采用可视化技术对变压器油中溶解气体的气相色谱进行分析，不仅使得分析过程清晰直观，还省去了传统分析方法所需的大量计算负载，便于工作人员及时对运行中变压器进行处理。该系统经山东省电力科学研究院半年多的试用，取得了较好的效果。
2　可视化建模
　　目前已有多种手段可用于运行中变压器的状态检测，最常用的方法就是对变压器绝缘油中溶解气体进行分析。由于该方法检测变压器早期故障既准确又具有连续性，还能查出其它方法难以发现的故障，因此它已获得了广泛的应用。我国电力部门目前主要使用三比值法[6](国外有类似的罗杰斯法)，通过氢气(H2)、甲烷(CH4)、乙烷(C2H6)、乙烯(C2H4)、乙炔(C2H2)等五种特征气体的比值编码，依据一定的对应关系得出变压器的故障性质。我们利用可视化技术对这些比值进行图示化，从多维的角度，赋予了数据空间属性。
　　在利用可视化技术对数据进行分析之前，首先要对待处理问题进行可视化建模。目前最常用的是“可视化流水线”理论模型[7]，其优点是能够适时地将任务执行分布到多个独立的系统资源上。我们在此基础上进行了改进，使其更适应变压器状态检测的实际情况。我们所用的模型如图1所示。

图1　可视化数据处理模型
　　其中各部分的功能简述如下。
　　1)计算模拟
　　变压器气相色谱分析实验所获取的数据，与来自不同信息源(观察、监测、标准界值、用户确认)的信息汇集 , 形成可视化计算的原始数据。
　　2)预处理
　　将经过计算模拟模块处理后的原始数据进行加工处理。包括数据格式的转换以及数据过滤。数据过滤不仅包括滤去干扰信息、完成从三维场数据中提取当前感兴趣的数据集，为以后的几何造型提供数据准备；还包括由基本的数据推导出新的数据，如根据实验数据计算梯度、插值等，以便在后继处理过程中更清晰地显示局部场。
　　3)映射
　　映射实际是一构模功能，是可视化的核心，它主要提供造型及分类功能。所谓造型指的是从滤波后的数据中抽取几何图素，如点、线、平面、曲面等。分类功能是根据显示的需要将具有不同数据值的体元加以分类，为后续的处理提供依据。
　　4)绘制
　　绘制是指从数据过滤层或预处理模块送来的数据(体绘制中采取这种模式)中抽取基本几何元信息。
　　5)图象处理
　　图象处理集中了图形变换的一些基本功能，如平移变换、比例变换、图形消隐、平滑降噪等处理。
　　6)显示
　　显示模块解决图象屏幕显示问题，不仅要显示图形，还应能正确显示随意改变视点视距后的图象以及对空间中任意点所进行的数值查询。
　　7)交互处理
　　通过交互处理，用户可以随时跟踪计算，便于对数字模拟进行控制和引导。
3　实现技术
3.1　面向对象的层次模型数据结构
　　为了实现可视化模型，我们采用了以面向对象为基础的层次模型数据组织方式。利用这种数据结构，不仅可以实现从顶点级到实体级的几何操作，还使得模型数据的空间三维变换矩阵与基本数据相分离。其主要优点为：
　　一方面，为模型系统的实现提供了支持。考虑任意体素X，其世界坐标运动矩阵Mw(X)为：

其中Fi(0<i≤n)为体素X的父辈，M(X)为X的相对位置矩阵，Mw(X) 为X的绝对位置矩阵。
　　另一方面，由于OpenGL[8]具有三维空间感强，能实现光照模型的可视效果和光影效果等优点，因此我们利用其标准图形库来实现图形图象的绘制、处理与显示。在显示实体时，只需设置好变换矩阵，再输入实体基本数据，OpenGL就可以自动完成三维变换过程。该过程可以由OpenGL服务器实现分布式处理和并行支持，从而有效地利用了OpenGL的Client/ Server特性。
3.2　数据转换
　　在对可视数据进行过滤处理时，我们对原始数据进行数据选择和数据格式转换，并根据需要由原始数据计算出新的数据，从而得到适合于可视化操作的、具有特定格式和高精度，并能反映全面信息的少量可视数据。
　　针对变压器实验数据量大的特点，我们利用一些函数变换将数值数据变换为几何数据，并在过滤处理后的数据与基本图元、实体模型或图标之间建立映射关系，使其不仅能够突出物理特征，还能同时建立相关可视数据之间的空间、时间、逻辑关系。在此基础上，将时间、空间和表征技术(如大小、形状、色彩)与图元进行融合，从而实现了实验数据的可视化准确表达。
3.3　显示技术
　　在将气相色谱分析三比值法的数值信息表示成可视化的图象后，就可以清晰地观察出变压器的故障类型以及各故障相互之间的差别关系。为了区分变压器的正常状态和故障状态，我们对这两种情况使用了不同的显示技术。在正常状态下，我们只把模型静态数据转化为显示数据。而在故障状态下，我们使用了信号式的动态帧显示技术，在实验数据驱动下，根据外时钟或内时钟信号，实施连续帧显示。
　　根据OpenGL用帧缓冲区来存储、操作象素数据的特点，考虑到Win32支持OpenGL的图形窗口象素格式和双缓冲区，我们让应用程序在脱离屏幕的缓冲区绘图，并在显示时把绘图缓冲区的内容拷贝到屏幕缓冲区。前后两个缓冲区所起的作用不同。在缺省状态下，后缓冲区用于绘图，前缓冲区用于屏幕显示。当后缓冲区的内容可以显示时，就通过函数调用将其内容拷贝到前缓冲区。同时，后缓冲区的内容可以根据数据的变化及时更新。这样，图象在双缓冲交换下可以平滑地变化，这在动态连续帧显示的情况下是很有价值的。
4　运行结果
　　我们根据IEC标准，对三比值法的数据比值信息分别进行了二维和三维可视化处理。
　　在二维情况下，以甲烷(CH4)、乙烯(C2H4)、乙炔(C2H2)的含量为等边三角形三条边的度量，对故障分布空间进行划分，共得到了6种状态，如图2所示。在三维情况下，以氢气(H2)、甲烷(CH4)、乙烷(C2H6)、乙烯(C2H4)、乙炔(C2H2)等五种特征气体的比值作为三条正交坐标轴，对故障分布空间进行划分，共得到了6种状态，如图3所示。其中PD表示局部放电，D1表示低能放电，D2表示高能放电，T1表示低于300(C的过热，T2表示300(C到700(C的过热，T3表示700(C以上的过热。

图2　二维可视化结果

图3　三维可视化结果
　　根据二维和三维可视化结果，可以方便地得到实验数据所对应的故障类型。由于二维、三维结果所用的气体数据指标不同，其判断结果可以互相验证，一定程度上增加了诊断的准确性。更为重要的是，使用可视化技术之后，不仅使得变压器检测结果清晰直观，还免去了传统检测方法所需的大量计算，较大地提高了技术人员的处理效率。
5　结束语
　　本文将可视化技术应用于电力变压器状态检测专家系统，通过对变压器油中溶解气体分析的三比值法进行可视化处理，使得故障定位准确直观，方便了现场检测人员的工作。更重要的是，在建立可视化模型后，可以根据实验数据直接显示出变压器当前运行状态在故障空间中的位置，从而大大降低了传统检测方法所需的计算负载。该系统在Windows NT 4.0环境下，用Visual C++ 6.0与OpenGL图形库实现，经山东省电力科学研究院半年多的试用，取得了很好的效果。
本课题获得国家自然科学基金资助
本课题获江苏省自然科学基金资助
姜远(南京大学计算机软件新技术国家重点实验室 南京 210093)
周志华(南京大学计算机软件新技术国家重点实验室 南京 210093)
陈世福(南京大学计算机软件新技术国家重点实验室 南京 210093)
参考文献
1 McCormick B H, DeFanti T A, Brown M D. Visualization in Scientific Computing. Computer Graphics, 1987, 21(6): 1～14
2 李 军, 周月琴. 可视化技术在遥感图象处理系统中的应用. 测绘通报, 1998, (8): 13～16
3 汪灏泓, 宋继强, 徐维秀, 蔡世杰. 三维地质数据可视化系统SLGRAPH的设计与实现. 计算机研究与发展, 1998, 35(9): 836～840
4 Vanegas O, Mizuno Y et al. Diagnosis of Oil-Insulated Power Apparatus by Using Neural Network Simulation. IEEE Transactions on Dielectrics and Electrical Insulation, 1997, 4(3): 290～299
5 Zhang Y, Ding X et al. An Artificial Neural Network Approach to Transformer Fault Diagnosis. IEEE Transactions on Power Delivery, 1996, 11(4): 1836～1841
6 变压器油中溶解气体分析和判断导则. 中华人民共和国水利电力部标准SD187-86
7 Dyer D S. A Data Flow Toolkit for Visualization. IEEE Transactions on Computer Graphics and Application, 1990, 10(4): 60～69
8 贾志刚. 精通OpenGL. 北京: 电子工业出版社, 1998
收稿日期：1999年10月10日
