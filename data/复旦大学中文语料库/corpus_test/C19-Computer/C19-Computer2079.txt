计算机工程
Computer Engineering
1999年　第25卷　第9期　Vol.25 No.9  1999



实用型企业电子商务系统I-Solution的设计和实现
沈华峰　杨小虎
　　摘　要：I-Solution系统是根据当前我国实际情况开发的一个实用型电子商务系统，其设计采用了多层式逻辑结构和面向对象的组件技技术．主要介绍该系统的体系结构、安全性及实现技术．
　　关键词：电子商务；多层结构；组件技术；安全性
The Design and Implementation of I-Solution System
Shen Huafeng
(Industrial ＆ Commercial Bank of China, Shaoxing Branch, Shaoxing 312000)
Yang Xiaohu
(Artificial Intelligent Institute, Zhejiang University, Hangzhou 310027)
　　Abstract　I-Soution is a practical system developed for current situation of our country. Multi-tier architecture and Object-oriented component technology are used in the system＇s design. The paper mainly discusses the system＇s archtiecture, secuity and implementation technology.
　　Key words　Electronic business; Multi-tier architecture; Componment technology; Security
　　据估计，到2000年全球电子商务交易量将达到250亿美元，到2010年，这一数字将猛增到4500亿美元以上。所谓电子商务，是指商品从生产、仓储、销售到运输的过程中，利用现代通信与电子技术，促使交易的顺畅与高效。电子商务具有诱人的发展前景，它有助于降低企业的成本，提高企业的竞争力，尤其能使中小企业以更低的成本进入国际市场参与竞争。在我国，因为起步较晚、信息化和网络化程度不高等原因，电子商务技术还处在尝试阶段。
　　基于我国的实际国情，目前还不足以实施电子商务中的每个环节。这里提出的I-Solution(Practical Internet Solution for Enterprise，简称I-Solution)是适用于目前我国大多数企业的实用型电子商务解决方案。它包括下述功能：
　　(1) 企业信息发布：利用Internet的Web技术，根据企业的需要，在Internet上开展广告宣传、信息发布。企业可以在自己的网页上刊登各种广告。对外宣传的人群可以是潜在客户，也可以是已经建立合作关系的客户(分销商/代理商)。
　　(2) 销售信息管理：把Internet作为企业网络骨架，连通了企业的所有分支机构、销售网点。通过网络，企业的领导人可以随时了解各部门、各分公司的经营汇总全貌，运筹帷幄，并迅速把有关指示和工作安排下发到下属各部门、各分公司。 各部门、各分公司每天的经营情况，包括财务、物资报表等(例如出库单、入库单)，通过Internet或RAS准确、自动地汇总到总公司的数据库中(根本无需总公司财务、物资部门人员手工再次输入)，实现企业内部数据汇总的自动化。 各部门、各分公司也可通过Internet或远程拨号随时查询总公司的相应数据库(例如了解产品的生产、库存等情况)，而无需另外通过电话、传真方式询问，从而提高了整个企业的办公效率。
　　(3) 产品供应链管理：供应链管理的目标，是通过贸易伙伴间的密切合作，以最小的成本和费用提供最大的价值和最好的服务。供应链管理从一个全新的高度对物流和信息流进行有效管理，其侧重点在于公司之间(或公司内部)的链接。因此，是一种对原材料供应商、生产制造商、批发商、零售商以及最终消费者等组成的系统进行管理。供应链管理包括计划、采购、制造和交货4个不同的过程。
　　(4) 电子购物: 客户通过访问企业的网页，在"购买登记"中输入对某产品的购买意向，计算机可以自动把客户的需求结果(例如品种和价格)展现在客户面前，然后把购买情况自动转给相应部门处理。并且，对已建立合作关系的每个客户(分销商/代理商)进行编码(授权密码)，颁发客户许可证书，客户可通过Internet提交订货单，由计算机系统把订货单自动转给相应部门处理。一旦今后国内商业银行正式开通Internet电子货币结算业务，企业和客户之间还可立即实行电子贸易结算。
1　系统结构
　　随着网络通信技术的不断提高， Web Browser/Web Server模式(Server/Browser结构)被广泛应用。Server/Browser结构采用Internet/Intranet技术，其模式类似于多用户主机/终端系统的结构模式，同时又具有客户/服务器模式的分布计算特性，主要的特点是集中管理，也就是说应用程序、数据库系统以及其他一些部件都集中在服务器端。用户端除了浏览器(及所依赖的操作系统)之外无需其他的软件和相关的管理维护工作。这样，用户需要查询的资料和打印文档的数据都来自于同一个数据库，从而保证了数据的及时性与完整性。从管理的角度而言，程序代码的维护以及更新，数据库的备份和日常维护都仅仅保证主机端即可。另外，可以利用电话网络或Internet，系统的伸缩性很强，网络结构简单，系统投资相对较少。
　　I-Solution系统实现采用3层结构，它包括用户界面层 (Presentation Tier)、业务逻辑层(Business Logic Tier)、数据服务层(Data Services Tier)。这种多层结构将应用程序的任务在逻辑上分为3个服务"层"，业务规则、数据访问和分布式的处理任务等都可封装到部件之中，而不依赖于具体的应用程序。

图1　I-Solution体系结构

图2　多层应用结构设计
　　用户界面层提供了可视化的接口，用来表示信息和收集数据。它们确保业务服务能够提供所需的业务处理能力，并且使用户与应用程序紧密结合起来，以处理某项业务。用户界面层通常表现为用户界面。用户界面层的设计一般可采用流行的网页编辑工具如Microsoft FrontPage 98等。
　　业务逻辑层作为用户界面与数据库的桥梁，负责数据处理、Web服务器等应用逻辑的处理工作。业务任务是由应用程序的需求定义的一种操作，例如订购信息处理。业务规则是控制业务工作流程的策略，如在订购过程中按客户信誉的好坏提供不同的价格优惠，这就是业务规则。与任务相比，业务规则更容易发生改变，所以在实现时最好将业务规则封装在单独的部件中，与应用程序的逻辑分隔开。例如，把上述"得到销售价格"这项服务封装在服务器上的一个部件中，应用程序可以访问它。一旦优惠价格策略发生了改变，仅需要在一个地方进行修改就可以了，应用程序本身是不需要修改的。一旦业务服务改变了，所有的"得到销售价格"请求都将使用已修改的业务服务得到新的计算结果。
　　数据服务层实现包括数据的定义、维护、访问和更新，以及管理并响应业务服务的数据请求等功能。它的具体实现可以在某种数据库管理系统上，也可以是一个异种数据库的集合，这些数据库可能驻留在多种平台上，运行在不同的服务器上。将数据服务与应用程序的其它部件分离开，在维护、修改甚至重构数据结构及访问机制时，可以丝毫不影响业务服务和用户服务。
　　据3层应用体系结构，I-Solution系统软件结构如图3。

图3　软件系统
2　系统安全性
　　企业在构建自己的电子商务系统时，系统的安全性将是首要考虑的问题之一。由于电子商务系统构架在Internet之上，而Internet与世界各地数以百万计的计算机连接。所以如何有效使用Internet的快速与便捷，又能保障商务活动的安全性，保守自身的商业机密是系统最重要的研究课题之一。
　　电子商务系统的安全性，主要考虑以下3个方面：
　　(1) 网络访问的安全性：网络访问的安全性是指控制只有经过授权的用户才可以访问数据。它主要依赖于网点的系统平台、Web服务器软件以及应用系统对操作用户的管理。
　　(2) 交易过程的安全性：交易过程的安全性是指商务活动过程中数据传输的安全、交易双方身份的确认，确保交易过程的高度隐密。交易过程的安全性可以通过安全电子交易标准来保证。
　　(3) 传输过程的安全性：传输过程的安全性是指保证网络中传输的数据不会被人监听，或者即使被人监听也可以保证传递的数据不会被解密而泄露。它可以通过加密/解密技术来保证。
　　针对以上分析，I-Solution系统实施的安全性策略有：
　　(1) 设置系统的防火墙：目前用于构筑Internet防火墙的基本部件和体系结构有：双重宿主主机体系结构、被屏蔽主机体系结构、被屏蔽子网结构。实用型企业电子商务防火墙系统采用被屏蔽主机体系结构。这个防火墙体系结构由一个包过滤路由器和一个堡垒主机构成，它是比较安全的防火墙系统，因为它支持应用层和网络层的安全功能。把代理服务器(WWW、Email、FTP)、身份认证系统、日志系统、加密系统放在堡垒主机中。堡垒主机位于外部网络和内部网络之间。
　　(2) 对关键业务进行SSL信道加密：SSL(Secure Sockets Layer)3.0 协议作为 Web 服务器安全特性，提供了一种安全的虚拟透明方式来建立与用户的加密通信连接。SSL 保证了 Web 内容的验证，并能可靠地确认访问被限制的 Web 站点用户的身份。通过为操作企业敏感信息的客户端颁发资格证书，可以要求试图访问被限制的应用程序的用户与服务器建立一个https加密连接，以防用户与应用程序间交换的重要信息被截取。
　　(3) 客户认证：在网上交易过程中，可以使用客户证书来保证交易的合法性。所谓客户证书，是由证书授权单位发行的、用于确认客户身份的数字标识。可以利用Microsoft Certificate Server进行客户证书管理。
　　(4) 页面管理：利用ActiveX服务器组件技术，对访问用户进行管理，在Web页面中进行访问授权。
3　系统实现
　　I-Solution服务器的操作系统平台采用Windows NT Server，Web服务器软件使用IIS4.0，数据库系统为Microsoft SQL Server。采用ASP(Active Server Pages)脚本语言并结合HTML(HyperText Markup Language)进行开发。其中，ASP被应用于数据处理、事务管理、系统安全等商业逻辑之中。Microsoft Active Server Pages是一套微软开发的服务器端脚本环境，ASP内含于IIS 3.0和4.0之中，通过ASP可以结合HTML网页、ASP指令和ActiveX组件建立动态、交互且高效的Web服务器应用程序。ASP采用对象和组件来完成复杂的程序设计，可以使用任何语言创建的组件(详见表1)。
表1　对象/组件的功能和源

对象或组件功能源
Request Object提取在请求过程中客户浏览器提交给服务器的信息内置对象
Response Object管理由asp返回到浏览器的信息内置对象
Server Object服务器对象提供对服务器方法和属性和访问内置对象
Session Object管理当前会话的信息(每一个用户每次打开浏览器就产生一个会话)内置对象
Application Object管理所有会话的住处供所有用户共享内置对象
Object Context Object上下文对象用于提交和终止事务IIS4.0
Ad Rotator广告转换器，按制定的计划表在页面上旋转显示广告信息服务器组件
Browser Capibilities描述客房浏览器能力服务器组件
Data Access使用Active数据对象ADO(ActiveX Data Object)来访问数据库服务器组件
File Access使用File System Object以及Text Stream Object检查、修改服务器上的文件信息服务器组件
Content LinkingWeb页面列表管理服务器组件

4　小结 
　　电子商务的发展前景无疑是非常远大的，但在中国要想使电子商务真正走向实用，还需要多方面的宣传、教育以及培训工作。另外，还必须解决许多问题如电子商务法律的制定、税收问题、知识产权、网络基础设施建设、安全问题等等。本文根据当前我国的实际情况，提出了适合我国企业的实用型电子商务解决方案，对电子商务系统的安全性也作了一定深度的探讨。 I-Solution系统的部分应用模块已投入实际使用。
作者简介：沈学峰(1970～)，男，工程师，主要从事电子商务应用系统的研究和开发
作者单位：沈学峰　中国工商银行绍兴市分行，绍兴　312000
　　　　　杨小虎　浙江大学人工智能研究所，杭州　310027
参考文献
1 Microsoft Developer Network Library中的系列文章：Authenti-cation and Security for Internet Developers，Implementing a Secure Site with ASP，Active Server Pages 简介，The Compon-ent Object Model: A Technical Overview，Professional Active Server Pages. 1998
收稿日期：1990-04-21
