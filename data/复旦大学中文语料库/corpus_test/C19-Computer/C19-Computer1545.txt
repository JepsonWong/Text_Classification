自动化学报
ACTA AUTOMATICA SINICA
1998年 第24卷 第5期  Vol.24  No.5 1998



基于神经网络的通用软测量技术1)
王旭东　邵惠鹤
关键词　软测量，RBF神经网络，竞争学习，精馏塔.
THE GENERAL SOFT SENSOR BASED ON NEURAL
NETWORKS
WANG XUDONG　　SHAO HUIHE
(Institute of Automation, Shanghai Jiaotong University, Shanghai　200030)
Key words　Soft sensor, RBF neural network, competitive learning, distillation column.
1　引言
　　目前建立软测量模型有多种方法，但是还缺乏通用性，通常一种方法往往难以适应不同的工业过程，甚至同一类工业过程不同的装置也难以适应.如罗荣富等［1］用趋化性神经网络成功地建立了精馏塔产品成分估计的软测量模型，并将其用于精馏过程推断控制.可是这类方法在更换装置时必须重新设计神经网络结构，因为神经网络隐含层单元的确定需要人的介入，因此软测量模型缺乏通用性.从而影响它的推广应用.
2　RBF神经网络与软测量模型的通用性
　　建立软测量模型可以从两个方面入手，一是分析工业过程的机理得到机理模型；另一种是通过反映过程运行的数据直接建立模型.由于机理方程推导和运算的复杂性，通常采用第二种方法.在这类方法中，基于前向神经网络建立软测量模型是比较有效的一种，因为神经网络能够较为有效地处理过程的非线性和滞后，同时它不需要很多工业过程的先验知识，而是根据输入输出数据直接建模.由于许多前向网络隐含层神经单元难以在算法中确定出来，在网络训练时需要人为地选择隐含层神经元数目，因此阻碍了软测量模型的灵活性.与其它前向网络相比，RBF神经网络不但具有良好的逼近性能，而且可以在网络训练过程中由算法确定隐含层神经元的个数.因此RBF神经网络不仅能够很好地建立软测量模型，而且保证了软测量方法的通用性.
　　训练RBF网络所需要确定的参数主要有基函数的中心、隐含层神经元个数及网络输出权值.基函数的中心可以采用K-means法、竞争学习等方法实现；网络的输出权值可以采用多种方法实现，最为常用的是正交最小二乘法OLS(Orthogonal Least Squares)［2］.OLS很好地解决了网络权值的计算和隐含层神经元个数的确定问题，因此它使基于RBF神经网络的软测量模型具有较好的通用性.将这种软测量方法挂接到工业控制软件平台上，对使用者来说十分方便.基于OLS法训练RBF神经网络存在的问题，作者在文献［3］做了一些改进.
3　竞争学习实现的递阶聚类
　　利用神经网络可以实现对于给定学习样本的拟合，而且学习的精度可以非常高.但是如果学习样本存在严重的非线性或存在某种矛盾，那么利用神经网络完成拟合是很困难的.在这种情况下如果要实现所需的训练精度，会造成网络非常庞大、学习时间长、运算十分复杂和过拟合问题，造成训练后网络的性能差.根据这些情况，可将学习样本集按照某种标准进行划分，使划分后得到的子类比较容易用神经网络学习.对于给定的样本集合，每个样本的类属往往不明确，因此要一步完成整个样本集的划分是有困难的.为了解决这个问题，提出递阶聚类的方法.
　　假定样本集为S=｛Xi,i=1,…，N｝，Xi是样本，N是样本数目.首先采用改进的竞争学习方法将S分解成M个子类Si=｛Xj,j=1,…，Ni｝,i=1,…，M，Ni是第i个子类的样本数，这是第一级的分解；然后将其中的一些子类继续进行第二级的分解，如此递阶就是递阶聚类的思想.判断某一级的子类是否应该继续分解需要根据RBF网络的学习情况而定.这种分解中止判据的可操作性是和RBF神经网络的结构特点、训练方法密切相关的.RBF神经网络具有参数线性化的特点以及OLS算法可以自动寻找网络隐含层神经元数目，而且不存在局部极小化问题.因此RBF神经网络学习某个样本集时不需要加入人为的调节.同时在作者改进的RBF神经网络训练方法中［3］，为了提高网络的综合性能，网络训练的中止条件加入了防止过拟合的约束条件，而不单纯看网络的训练精度.这种改进保证了网络学习精度足够时网络的性能也较好，这样当网络训练完成时，可以从精度上判断某个子类是否需要进一步分解.如果RBF神经网络学习某个子类后精度不够，那么这个子类就需进一步的分解，否则该子类不必分解.这种方法易于用软件实现.递阶聚类的思想如图1所示.


图1　递阶聚类
　　聚类的方法有许多种，其中竞争学习是一种非监督的学习方法，可以较好地完成聚类.RPCL(Rival Penalized Competitive Learning)方法是一种较为有效的竞争学习方法.但是由于RPCL方法中蕴含着FSCL(Frequency Sensitive Competitive Learning)法，这会造成学习中存在一定的矛盾性.FSCL方法的主要思想是增加获胜机会少的竞争单元更多获胜的机会，而PRCL方法的思想是让竞争次胜者远离最终的聚类点，从而剔除多余单元.因此如果将二者融合在一个算法中，就会造成RPCL法的惩罚效果不明显，竞争的次胜单元经常转化成获胜单元.这样多余的单元在远离最终聚类点一段距离后又重新回来，并且始终处于这种振荡之中，因此多余的竞争单元数目不能剔除，造成竞争学习得不到正确的结果.在文献［5］中以实例说明和改进了这个问题.结合改进的RPCL法和递阶聚类的思想可以实现样本空间的有效划分，便于用RBF神经网络学习每一个子样本空间.
4　分布式RBF网络及其综合
　　当复杂的样本空间用递阶聚类思想实现样本空间划分后，每个子样本空间都能容易地由RBF神经网络完成学习任务.对整个样本空间而言，是许多网络分布在各个子样本空间完成学习任务的，这样一个分布式的网络不利于应用，因此需要将网络综合起来.网络综合的方法较多，本文选用模糊分类器将网络综合，如图2所示.图中的模糊分类器是网络综合的工具，具体方法如下


图2　分布式RBF网络的综合
　　假定图2中分布式网络具有M个子网络｛RBFi,i=1,…，M｝，新的过程输入X对每个子网络的隶属度为｛μi,i=1,…，M｝，那么整个网络的输出Y为
　　(1)
　　输入X对每个子网络隶属度可以采用下述方法确定：首先确定输入X对学习样本集中每一个样本Xi的隶属度，然后根据这些隶属度确定输入X对每个子网络的隶属度.方法如下
　　选定性能指标
　　(2)
并且满足

ηi的确定可以通过(2)式最小化求出.利用Lagrangian(拉格朗日)乘子法可以解出ηi，即
ηi=1,　　ηj≠i=0，　　if di=0,　　i=1,…，N，　　(3)

输入X对与网络RBFi的隶属度为
　　(4)
式中Ni是第i个子网络的学习样本数目.
5　软测量模型建立的实例
　　某炼油厂精馏塔由两个塔(A1，A2)串接后共同完成气体分离任务.其中塔A1的塔底产品B，其中主要成分是丙烷，而塔A2的塔顶产品D，其中主要成分是丙烯.为了估计产品B中的丙烷含量CB和产品D中的丙烯含量CD，可利用分布式RBF神经网络建立软测量模型.根据对该精馏塔系统的了解和分析，选择辅助变量为塔A1的温差ΔTA1，塔A2的温差ΔTA2以及塔A2顶部的压力P.CB，CD数据可从炼油厂的分析报表中收集，然后对应地从操作数据中收集ΔΤA1，ΔΤA2，P的数据.在样本聚类之前，首先将样本归一化，然后根据归一化的学习样本，以过程的输出变量为基准，将学习样本进行递阶分类.图3是学习样本集第一次聚类后的结果.第一次聚类将学习样本分成5类，然后继续将这5类分别聚类，如此递阶执行，得到了25个子类，这25个子类分别用25个RBF神经网络去学习.图4是第一次聚类后第五个子类二次聚类的结果.
　　学习样本经聚类、学习之后得到分布式RBF神经网络.运用模糊分类器进行综合，这个综合的分布式RBF神经网络不但能够重现学习数据，而且给定新的过程输入可以较为理想地估计过程的输出.表1反映了RBF神经网络软测量模型对过程输出的估计是有效的.


图3　学习样本输出变量第一级分类的结果


图4　一阶分类后第五类的再聚类结果
表1　软测量输出与过程实际输出的比较

CD的软测量值CB的软测量值CD的实际值CB的实际值
99.432%85.100%99.444%85.638%
99.435%96.870%99.428%96.074%
99.105%79.600%99.210%80.592%
99.140%93.050%99.254%92.024%

　　为了进一步检验分布式RBF神经网络软测量的效果，用标准方差进行检验和比较.表2是分布式RBF神经网络软测量估计器和基于卡尔曼滤波实现的估计器之标准方差比较表.
　　由表2可知利用分布式RBF网络建立的软测量模型可以较为理想地完成对精馏塔产品成分的估计.
表2　两种估计器标准方差的比较

输出变量RBF神经网络软测量的标准方差卡尔曼滤波估计器的标准方差
D中的丙烯含量CD0.013 3%(摩尔分数)0.202 8%(摩尔分数)
B中的丙烷含量CB1.075 5%(摩尔分数)1.931 0%(摩尔分数)

6　通用软测量方法与控制软件平台的关系
　　本文从RBF神经网络的特点出发，提出了一种通用的神经网络软测量模型的建立方法.设计通用软测量模型的方法在开发工业控制软件中具有非常重要的意义.由于RBF神经网络的特点，利用分布式RBF神经网络的方法在建立软测量模型时不需要加入人为的干预，软件使用者只需要根据工业过程的背景选择好辅助变量和主导变量、收集过程的数据即可.因此这种软测量方法就可以作为一个工具放在控制软件平台之上，使用者可以很方便地应用，而不需要在如何建立软测量模型上花时间，具有较好的通用性.还有一个优点是通用软测量方法挂接在软件平台上之后，可以与挂接在平台之上的其它控制软件方便地互通信息.例如设计好软测量模型之后，平台上的控制模块可以很方便地利用软测量实现各种控制策略.
1)国家自然科学基金资助项目.
作者单位：(上海交通大学自动化研究所　上海　200030)
参考文献
　1　罗荣富，邵惠鹤.分布式网络局部学习方法及其在推断控制中的应用.自动化学报，1994，20(6)：739―742
　2　Chen S, Cowan C F N, Grant P M. Orthogonal Least Squares Learning Algorithm for Radial Basis Function Networks. IEEE Trans. on Neural Networks, March, 1991，2(2)：302―309
　3　王旭东，邵惠鹤.RBF神经网络及其在非线性系统建模中的应用.控制理论与应用，1997，14(1)：59―66
　4　Xu Lei et al. Rival Penalized Competitive Learning for Clustering Analysis, RBF Net, and Curve Detection. IEEE Transactions on Neural Networks, 1993，4(4)：636―649
　5　Wang Xudong, Luo Rongfu, Shao Huihe. Designing a soft sensor for a distillation column with the fuzzy distributed radial basis function neural network. 35th IEEE Conference on Decision and Control,1996, 1714―1719
收稿日期　1996－12－03
