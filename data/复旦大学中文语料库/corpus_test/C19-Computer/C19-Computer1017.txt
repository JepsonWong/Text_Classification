自动化学报
ACTA AUTOMATICA SINICA
1998年 第24卷 第1期  Vol.24  No.1 1998



不同天气条件下自然景物图象的模拟
王亚东　丁明跃　彭嘉雄　胡修林
关键词　计算机图形学，图象处理，成像模型，区域灰度不变性，图象模拟. 
NATURAL SCENE IMAGE SIMULATION IN DIFFERENT
WEATHER CONDITIONS
WANG YADONG　　DING MINGYUE　　PENG JIAXIONG　　HU XIULIN
(Institute of Pattern Recognition & Artificial Intelligence,Huazhong University 
of Science and Technology,Wuhan　430074)
Key words　Computer graphics,image processing,image formation model,region brightness invariant,image simulation.
1　引言
　　模拟不同光照条件下的图象可广泛应用于 CAD、飞行模拟、仿真等技术之中，已成为计算机图形学的一个重要分支.在计算机图形学中，为了获得较为逼真的视觉效果，通常需要对物体进行明暗处理，这通常用照射模型来实现，如 Phong照射模型［1］、Torrance Sparrow 照射模型以及全局照射模型等等.这些模型，必须已知光源特性、物体表面特性以及观察角等条件.对于自然景物来说，这些条件往往难以获得.因此，常用的照射模型不适于自然景物图象的模拟.
　　本文研究了自然景物图象的成像原理和成像模型，详细地分析了影响景物成像的光照因素、大气环境因素、物体表面因素以及光学系统成像因素，同时提出区域灰度不变性的概念，并证明了该不变性仅仅取决于物体表面的反射系统，而与其它因素无关.因此通过一幅已知时间、天气、景物位置及光学成像系统等条件下的图象，可以模拟产生另一种已知条件下的图象.本文对用CCD像机实际拍摄的在不同时间、不同天气等条件下的自然景物图象进行了模拟实验，其模拟效果是令人满意的.
2　成像模型
　　文献［2］给出了一种成像模型：图象上任一点(i,j)的灰度值 fij和实际场景中对应点之间的成像关系如
　　　　(1)
　　从(1)式看出，影响景物成像的因素可分为四类：(1)光照因素　Eij(λ);(2)大气环境因素　RA(λ)和TA(λ)；(3)物体表面因素　Lij(λ)和rij(λ)；(4)光学系统成像因素　Δλ,K1(λ),K2,g,Rs(λ),G 和 T0(λ).这四类因素是相互独立的.
3　区域灰度不变性及反射图
　　假定场景中无幅射源，同时假定较小的场景区域上每一点的照度和大气环境因素是相同的，并将天气变化表示为时间t的变化，则
　　　　　　　　(2)
其中 为区域上的平均照度.
　　一般将太阳光看作白光，其光谱分布均匀，仅仅强度发生变化.在此假设下，E(λ,t)=E(t)。S(λ).同样可以认为RA(λ,t)和TA(λ,t)也满足该假设.
　　在真实世界中，可以认为 rij(λ)比O(λ)，S(λ)，T(λ)变化剧烈得多，因此
　　　　　　　　(3)
令则
　　　　　　　　　　　　　　　　(4)
其中分别为区域灰度和有效反射率的均值和均方差.(4)式表明，区域内每一点的灰度和该区域内平均灰度之差与其灰度均方差之比值独立于影响景物成像的光照因素、大气环境因素和光学系统成像因素，我们称此性质为区域灰度不变性.
　　根据文献［3］，有效反射系数 r(i,v,n)与物体表面方向 n、反射率ρ、入射光方向i 和观察方向v有关，并可分解为ρ。R(i,v,n).设较小区域上每一点的入射光方向和表面方向是相同的，当观察者距离该区域很远时，可以认为区域上每一点的R(i,v,n)均相同，则
　　　　　　　　　　　　　　　　(5)
其中 分别为区域上反射率的均值和均方差.
　　定义图象的反射图则反射图 P 仅仅取决于物体表面的反射率.设t1,t2分别为两种不同的条件，根据(5)式有
　　　　　　　　　　　　　　　　(6)
(6)式表明，另一种天气条件下的图象可以通过反射图和这种天气条件下的区域灰度均值及均方差来模拟.
4　模拟实验
　　实验中将一带有焦距为50mm镜头的CCD像机固定.图1是不同时间、不同天气条件下拍摄同一场景的实际图象，将整幅场景看作由多个具有灰度不变性的较小区域组成，如图2所示. 
　　实验中，将图1(a)作为基准图象，而将图1(b)模拟成和图1(a)相同条件下的图象，模拟结果如图3.为了检验模拟结果，将模拟图象与真实拍摄的图象进行相减比较，图4是图3和图1(a)相减的结果及其直方图.从图4中看出，模拟图象与真实拍摄的图象之间大部分点相差在10个灰度级以内，从视觉效果来看，模拟结果是令人满意的.


图1　不同时间和不同天气条件下拍摄的真实图象


图2　区域划分图


图3　图1(b)的图象模拟成图1(a)条件下的图象


图4　图3和图1(a)相减的结果及其直方图
5　讨论
　　本文能够将一种成像条件下的图象变换成另一种成像条件下的图象，这是通过反射图和该成像条件下的区域灰度均值及均方差来实现的，这种方法在区域内部是可行的，模拟效果也很不错，但在区域边缘处却不适用，图4(a)的差图象也反映了这一点.
　　区域灰度不变性是图象的又一个不变性，它反映了景物的表面特性，而与其它成像因素无关，可以作为图象灰度和景物对应关系的一种描述.
作者单位：华中理工大学图象识别与人工智能研究所　武汉　430074
参考文献
［1］　B T.Illumination for computer generated pictures.Commun.of the ACM,1975,18：311-317.
［2］　Johnson R P.Contrast based edge deteciton.Pattern Recogniton,1990,23:311-318.
［3］　Nayar S K,Bolle R M.Computing reflectance ratios from an image.Pattern Recognition,1993,26:1529-1542.
收稿日期　1995-07-20
