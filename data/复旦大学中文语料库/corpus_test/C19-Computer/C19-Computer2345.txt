计算机研究与发展
JOURNAL OF COMPUTER RESEARCH AND DEVELOPMENT
1999　Vol.36　No.7　P.876-881



基于本征特征的弹性模板匹配法
熊志勇　沈理
摘　要：本文在弹性模板匹配法的基础上，提出了基于本征特征的弹性模板匹配法，用于人脸图像的识别.该方法利用KL变换进行模板的定位，使得定位精度与速度都有所提高，并且识别准确率也得到改善.
关键词：人脸图像识别，本征特征，弹性模板匹配，Gabor变换，KL变换，逐步求精
分类号：TP391.4
ELASTIC MODEL MATCHING BASED ON EIGEN-FEATURE
XIONG Zhi-Yong 
(Institute of Computing Technology, Chinese Academy of Sciences, Beijing 100080)
SHEN Li 
(Institute of Computing Technology, Chinese Academy of Sciences, Beijing 100080)
Abstract：This paper brings forward a new elastic model matching method based on eigen-feature to recognize facial images. The method utilizes KL transformation to locate the model so that the accuracy of model locating is improved and the procedure is also accelerated. The recognition ratio is improved too.
Key words：facial image recognition,eigen-feature,elastic model matching,gabor transformation, KL transformation, refining step by step▲
1　引言
　　在人工智能研究领域，对于人类识别事物能力的研究与模拟一直是研究的重点，其中人脸图像的识别是当前的一个研究热点.因为人脸本身的多变，如表情变化以及成像过程中由于各种干扰引起的变化，如尺度、光照、旋转等，使得人脸图像的机器识别具有很大的难度，也更具挑战性；从而也产生了多种识别方法，如基于人脸特征与基于模板的识别方法［1］，基于神经网络的识别方法［2］，基于主成分分析的本征脸(eigenface)方法［3，4］，基于Gabor变换的弹性模板匹配(elastic model matching)方法［5，13］等.
　　上述每种方法都有优点，也有不足［6］.如基于人脸特征的方法，存储空间要求小，识别速度快，但识别率低；神经网络方法要求训练样本比较充分才能得到较好的识别效果，否则对于目标因光照改变、尺度改变以及小的形变等情况都不能很好地识别；本征脸方法识别速度快是其一大优点，而且对于正面人脸图像的识别准确率很高，但当目标因光照改变、尺度变化、以及位移变化时都不能很好的识别［6］；而弹性模板匹配法利用Gabor函数对人脸图像进行变换，将得到的变换系数作为特征用于识别，并利用弹性匹配法以达到模板的尽量匹配，从而能够最大地消除由于小的形变带来的干扰；又由于Gabor变换具有局部性、带通性以及方向选择性，能够很好地提取目标的本质特征［7］，对于目标局部变换、小的旋转、以及光照改变等情况都能得到较好的识别［5］，因此该方法是一种较理想的方法.但它有一大缺陷，即识别速度慢.因为它的良好的识别性能是建立在模板精确匹配的基础上的，而这大大地提高了运算的复杂性，同时降低了它的实用性［6］.因此如果能够提高模板精确匹配的精度与速度，降低运算的复杂性，则无疑将促进其实用性.
　　为此，本文在弹性模板匹配法的基础上，提出了一种新的识别方法，它同样利用Gabor变换来提取目标的特征，并形成模板，但使用KL(Karhunen-Loeve)变换来进行模板的定位，使得定位速度与精度都有所提高.实验表明识别效果也得到改善.本文第2部分简要介绍弹性模板匹配法，分析其定位过程的时间开销；第3部分介绍基于本征特征的模板匹配法，即利用人脸的本征特征进行特殊点的查找，从而提高了模板的定位精度与速度；第4部分给出了一些实验结果；最后是结论与展望.
2　弹性模板匹配法
2.1　方法简介
　　弹性模板匹配法用带标号图(labeling graph)来表示一幅人脸图像，则人脸图像的识别就转化为库中的模板图(model graph)与待识人脸图(image graph)之间的匹配［5］.其中人脸图(image graph)的自动定位是整个算法的关键，定位精度高则识别率就高，定位快则识别一幅人脸图像也快，方法实用程度就高.
2.2　定位过程时间复杂性分析
　　文献［5］中，使用两个过程来完成定位：全局定位与局部定位.文中所用的带标号图为一矩形点格阵，共70点，如图1(b)所示.这种表示方式点的选择很随机，没有充分利用人脸上有意义的特殊点，如眼睛、鼻子、嘴部区域等，匹配精度不够高，因此采用如图1(c)中所示的特殊点点格阵(图中用了31点).关于特殊点的选取也可参考文献［13］.


图1　(a)人脸图像；(b)矩形点格阵；(c)特殊点点格阵(模板)
　　假设图像维数为N×N，点格阵长度为l，宽度为w，节点数为m，则为了实现全局定位，共要完成(N-l+1)×(N-w+1)×m次比较.若每次比较的时间开销为tc，则全局定位的时间开销为Tg=(N-l+1)×(N-w+1)×m×tc.全局定位是一个粗略的定位过程，为了得到点格阵中每个节点的更精确位置，通常每个节点还要进行局部移动［5］.设平均每一节点要经过次移动、比较才能确定其最优位置(本文作者所做的实验中为248)，局部定位的时间开销为Tl=m××tc.定位时间开销为Tl=tg+tl.
　　实际验算表明，两次定位时间开销很大，这是造成识别速度慢的原因之一，而且经过两次定位后，定位结果也不很精确(这里定位准确指对于每一点，定位不偏差5个像素距)，进行匹配时，对于库中的每一个模板，虽然不用再进行人脸图的全局定位，但还是要进行相应的局部定位，假设库中共有P个模板，则为了识别一待识人脸图像，总的定位时间开销为T2=Tg+P×Tl.
　　为了提高定位精确度及速度，可以考虑从两个方面进行改进：一种方法是减少点格阵的节点数，从而比较次数能够减少，但实验结果表明，这将导致定位准确性下降，从而识别率也下降；另一种方法是Wiskott等人提出的弹性串模板匹配技术(elastic bunch matching)［3］，使用串结构图(bunch graph)作为通用人脸模板的表示，并用于人脸图的定位，使得定位准确度大大提高，从而匹配时，对于库中的各模板不用再进行全局与局部的定位，可直接匹配，使得总体的时间开销大为降低.但这种方法有一个缺陷，即使用串结构图进行人脸图的全局定位时，对于串结构图的每个节点串，都要选择一个最佳的匹配子节点(expert point).假设串结构图中有m个节点串，每个节点串中有k个子节点，则为了实现全局定位，共要完成(N-l+1)×(N-w+1)×m×k次比较，比较次数增加了，全局定位时间开销也随之增加，加上局部定位的时间开销，串结构图的定位开销为T3=k×Tg+Tl，比较T1与T3，定位时间复杂性有所增加.但匹配时，不用再进行库中模板的定位，总的定位开销不变，仍为T4=k×Tg+Tl，由于Pk，比较T4与T2，整体改进还是很明显的.
　　由上述可见，如果能进一步将串结构图的定位开销减少，则整个定位、匹配的时间开销也将随之减少.因此，如果能够找到使模板定位快且准确的方法，则弹性模板匹配法的识别速度及识别准确率都将有所提高，方法将更实用.为此，作者提出了基于本征特征的弹性模板匹配法，初步解决了这个问题.
3　基于本征特征的弹性模板匹配法
　　由上述可见，弹性模板匹配法对于模板的定位要求很高，其目的也就是为了使得模板中表示瞳孔、鼻尖、下颏、轮廓等的节点能与待识图像中相应的节点进行比较，而不至于偏失；因此模板定位问题就转为人脸局部特征的探测问题，将某些关键点的位置确定了，则整个待识人脸图的位置也就确定了；随后可用文献［5］、［13］中的识别算法进行人脸图像的识别.
　　关于人脸局部特征的探测，已经有许多方法，如边缘投影法［10］，多层感知机法［11］等方法，但都不很理想，这里考虑使用KL变换进行人脸局部特征的探测.
3.1　KL变换
　　KL变换也称作主成分分析(PCA)法，一般用于人脸图像的表示［8，9］以及识别［3，4］.如对训练图像集中的人脸区域进行KL变换，可得到本征脸(eigenfaces)空间Γface，关于KL变换的具体实现细节可参考文献［3，4，8，9］.
3.2　逐步求精定位法
　　为了进行人脸局部区域的探测，可以用全局求精定位法，即在整个图像范围内查找眼睛区域、鼻子区域及嘴部区域等；另外也可以采用逐步求精定位法，即先从一背景图像中将人脸区域查找出来，然后将人脸区域作为背景，将眼睛区域、鼻子区域及嘴部区域等局部区域精确地探测出来，同时可得到左、右瞳孔，鼻尖，及上嘴唇等特殊点的位置.如果将这些特殊点连起来，就可形成一个局部点格阵；根据人脸各区域的位置对应关系，可将其它节点位置轻易推测出来，而不用再进行查找.
　　由于使用逐步求精定位法，利用了人脸各局部区域的空间位置关系，大大地缩小了探测范围，并使得定位精度也得到提高.因此，这里使用逐步求精定位法.
3.2.1　人脸区域的探测与定位
　　由图2(a)可见，在待识人脸图像空间中任取一人脸大小的矩形区域O()，进行向Γface空间投影，重构等操作，得到重构误差ε()；再到另一位置取一矩形区域，同样向Γface空间投影，重构，得到重构误差；搜索整个图像空间，取重构误差最小的矩形区域作为人脸区域.如将矩形区域的中心点设定为鼻尖，则附带地就完成了鼻尖点的定位.
3.2.2　局部区域的定位
　　由3.1节可知，如果取人脸的各局部区域作为训练集进行训练，同样可形成眼睛空间Γeye，鼻子空间Γnose，及嘴空间Γmouth等局部空间；则以人脸区域为背景，取相应大小的矩形区域向相应的局部空间投影，得到相应的重构误差；如都各取重构误差最小的矩形区域作为待识区域，就能够完成各局部区域的探测.同时，设定各矩形区域的中心点为相应的特殊点，则可定出左、右瞳孔，鼻尖，及上嘴唇等特殊点的位置，如图3所示.　　
3.3　定位过程时间复杂性分析
　　由上述可知，逐步求精定位法也分两步.为了与2.2节中所述进行比较，在3.2.1节中，设图像维数不变，并设人脸区域O()的长度为l，宽度为w，为了实现人脸区域的定位，共要完成(N-l+1)×(N-w+1)次比较，每次比较的其时间开销为tface，则完成人脸区域定位的时间开销为Tf=(N-lface+1)×(N-wface+1)×tface；对于左眼区域，因其搜索空间为人脸区域的左上四分之一区域，可近似认为其定位时间开销为Tf/4；同样，对于右眼区域及嘴部区域都可认为其定位时间开销为Tf/4，则总的定位时间开销为T5=7Tf/4.可近似认为tface与tc相等，则T5≈7Tg/(4m)；匹配时，对于库中的每一个模板都不用再进行人脸图的定位，直接匹配即可，总的定位时间开销为T6=T5.
　　比较T5与T1，T3,T6与T2，T4可以发现，使用逐步求精定位法，对于单个模板的定位时间开销有所减少，同时对于库中的所有模板匹配，定位时间开销也有所减少；实验结果表明，定位准确度也很高(参考实验1、2).
3.4　方法的有效性
3.4.1　对尺度的处理
　　由文献［3］、［4］可知，PCA方法受图像尺度变化的影响很大.文献［4］中将不同尺度的图像集混合起来进行训练，得到混合图像集的本征空间，并用于识别，效果不太好.这里考虑将不同尺度的图像集分别进行训练，得到不同尺度的图像样本空间的各本征区域.进行人脸局部特征的探测时，先分别利用不同尺度的本征区域，如各种尺度的本征脸区域确定出待识图像的尺度，然后用相应尺度的其它本征区域探测出待识图像的各局部特征点，得到待识图像的点格阵；识别时，先对待识图像进行Gabor变换，提取特殊点的系数值，然后利用弹性模板匹配法进行识别，关于不同尺度图像识别的文章很多.进一步了解可参考文献［4］、［14］.
3.4.2　对旋转的处理
　　对于旋转图像的识别，同样也可将不同旋转角度的图像集分别进行训练，得到不同旋转角度的图像样本空间的各本征区域.进行特征探测与识别过程如上述对不同尺度图像的处理.
4　实验研究
4.1　实验条件
　　实验中所用的人脸图像来源于麻省理工学院的媒体实验室［12］.成像条件为：在3种光照条件下对16个不同的人进行拍摄，训练集选用正面光照条件下的人脸图像，共有16幅.测试集选用左、右侧面光源的人脸图像共有32幅.
4.2　实验结果
　　实验1. 人脸区域的查找与定位(基于3.2.1节).
　　利用本征脸(eigen faces)方法，在待识别人脸图像中找出人脸区域.实验结果如图2所示.整个实验表明，对于人脸区域的探测准确率达到100%.实验中用了7个本征向量.


　图2　(a) 训练用人脸图像，矩形框内为手工选取的人脸区域；
(b) 测试用人脸图像，矩形框内为探测到的人脸区域(由目标阴影可知光照不同).
　　实验2. 人脸局部区域的查找与定位.
　　分别利用弹性模板匹配法、全局求精定位法、逐步求精定位法进行人脸局部区域的查找与定位.(注：如同弹性模板匹配法可以进行人脸区域的定位一样，也可使用该方法进行人脸局部区域的查找与定位.)在全局求精定位法、逐步求精定位法中，都用了7个本征向量.实验结果如表1所示.图3所示为逐步求精定位法进行人脸局部区域的定位结果.
表1　实验2结果

定位准确率弹性模板匹配法全局求精定位法逐步求精定位法
左眼区域44%67.7%100%
右眼区域56%33.3%93.3%
鼻子区域50%33.3%100%


图3　(a) 训练用人脸图像，矩形框内为手工选取的人脸区域；
(b) 测试用人脸图像，十字交叉线的中点为探测到的特征点，也就是局部区域的中心点(由目标阴影可知光照不同).
　　实验3. 人脸图像的识别.
　　分别利用本征脸(eigen faces)方法、弹性模板匹配法以及基于本征特征的弹性模板匹配法进行人脸图像的识别.识别结果如表2所示.
表2　实验3结果

实验方法本征脸方法
弹性模板匹配法
基于本征特征的弹性
模板匹配法
识别率63.3%90%96.7%


　　实验4. 基于本征特征的弹性模板匹配法与弹性模板匹配法识别速度比较.
　　程序用Matlab语言编写，在主频200MHz的微机上运行.根据手工记时，发现基于本征特征的弹性模板匹配法比弹性模板匹配法识别速度大约快20%.
4.3　实验小结
　　由实验1可见，利用KL变换，对于人脸区域的查找和定位准确率很高；实验2表明，弹性模板匹配法对于局部区域的定位准确率不高，同样，全局求精定位法对于局部区域的定位准确率也不高，可能受光照影响大.而采用逐步求精定位法，对于局部区域的定位准确率很高，达到了满意的效果；实验3表明，本征脸方法在光照改变的情况识别率较低，也进一步证明该方法受光照影响.而弹性模板匹配法受光照影响小，识别率较高；基于本征特征的弹性模板匹配法，较之弹性模板匹配法识别精度有所改善；实验4表明，基于本征特征的弹性模板匹配法对于识别速度也有所改善. 
5　结论与展望
　　本文在弹性模板匹配法的基础上，提出了基于本征特征的弹性模板匹配法，利用了KL变换进行模板的定位，使得定位精度与速度都有所提高，并且识别准确率也得到改善.今后将要做的工作是进一步提高匹配的速度，使得算法更加实用.■
基金项目：本课题得到中国科学院“九五”基础性研究基金项目(项目编号KJ952-J1-707)的资　　　　　　助.
作者简介：熊志勇，男，1971年9月生，博士研究生，研究方向为数据压缩、模式识别、图像　　　　　　处理.
　　　　　沈理，男，1937年11月生，教授，博士生导师，主要研究方向为软计算、模糊逻　　　　　　辑、神经网络、遗传算法、模糊系统、容错计算等.
作者单位：熊志勇(中国科学院计算技术研究所　北京　100080)
　　　　　沈理(中国科学院计算技术研究所　北京　100080)
参考文献：
［1］Brunelli R, Poggio T. Face recognition: features versus templates. IEEE Trans on PAMI, 1993, 15(10): 1042～1052
［2］Cottrell G W, Fleming M. Face recognition using unsupervised feature extraction. In: Proc Int Neural Network Conf, vol 1 Paris, 1990. 322～325
［3］Turk M A, Pentland A P. Face recognition using eigenfaces. In: Proceeding IEEE Computer Society Conf of Computer Vision and Pattern Recognition, Hawaii, 1991. 586～591
［4］Turk M A, Pentland A. Eigenfaces for recogntion. Journal of Cognitive Neuroscience, 1991, 3(1): 71～86
［5］Lades M, Vorbruggen J, Buhmann J et al. Distortion invariant object recognition in the dynamic link architecture. IEEE Trans Comput, 1993, 42(3): 300～311
［6］Jun Zhang, Yong Yan, Martin Lades. Face recognition: eigenface, elastic matching, and neural nets. Proceedings of IEEE, 1997, 85(9): 1422～1435
［7］Field D J. What is the goal of sensory coding. Neural Computation, 1994, 6(4): 559～601
［8］Sirovich T J, Kirby M. Low-dimensional procedure for the characterization of human faces. Journal of the Optical Society of America (Series A), 1987, 4(3): 519～524
［9］Kirby M, Sirovich T J. Application of the Karhunen-Loeve procedure for the characterization of human faces. IEEE Transactions on Pattern Analysis and Machine Intelligence, 1990, 12(1): 103～108
［10］Kanade T. Picture processing by computer complex and recognition of human faces. Kyoto University, Tech Rep: 1973
［11］Vincent J M, Waite J B, Myers D J. Automatic location of visual features by a system of multilayered perceptrons. IEE Proceedings, 1992, 139(6): 405～412
［12］ftp://ftp.media.mit.edu
［13］Wiskott L, Fellous J M, Krüger N, von der Malsburg. Face recognition by elastic bunch graph matching. IEEE Transactions on Pattern Analysis and Machine Intelligence, 1997c, 19(7): 775～779
［14］Buhmann J, Lades M C, von der Malsburg. Size and distortion invariant object recognition by hierarchical graph matching. In: Proc IJCNN Int Conf Neural Networks, San Diego, CA, 1990. 411～416
收稿日期：1998-11-16
修稿日期：1999-03-02
