计算机工程
Computer Engineering
1999年　第25卷　第4期　Vol.25　No.4　1999



图形化编程语言Lab VIEW环境及其开放性
李扬　郑莹娜　朱铮涛
摘　要　图形化编程语言LabVIEW是著名的虚拟仪器开发平台，介绍其特点、程序设计结构、运算方式及开发性等内容。
关键词　LabVIEW框图程序开放性
Graphical Programming Environment Lab VIEW and Open Connectivity
LiYang ZhengYingna ZhuZhengtao
（Mech-electronic Department，Guangdong University of Technology Guangzhou 510643）
Abstract：Graphical Programming environment LabVIEW is virtual development platform for instruments.This paper introduces the Lab VIEW's features,proggramming structure,programming fundamentals and open connectivity.
Key words:LabVIEW;Graphical block diagram;Opennesss
　　LabVIEW是美国国家仪器公司(National Instrument)推出的一种基于图形开发、调试和运行程序的集成化环境，是目前国际上唯一的编译型的图形化编程语言。在以 PC 机为基础的测量和工控软件中，LabVIEW的市场普及率仅次于C++/C语言。LabVIEW开发环境具有一系列优点，从其流程图式的编程、不需预先编译就存在的语法检查、调试过程使用的数据探针，到其丰富的函数功能、数值分析、信号处理和设备驱动等功能，都令人称道。本文对LabVIEW开发环境及其开放性作一简述。
1　LabVIEW概述
　　LabVIEW使用了一种称为G的数据流编程模式，它有别于基于文本语言的线性结构。在LabVIEW中执行程序的顺序是由块之间的数据流决定的，而不是传统文本语言的按命令行次序连续执行的方式。
　　LabVIEW程序称为虚拟仪表(Vitual Instrument)程序，简称VI。VI包括3个部分：前面板、框图程序和图标/连接口。前面板用于输入数值和观察输出量。
　　输入量被称为Controls，输出量被称为Indicators。用户可以使用许多图标，如旋钮、开关、文本框和刻度盘等来使前面板易看易懂。如图1所示，它是一个温度计程序(Thermometer VI)的前面板。

图1　温度计的前面板
　　每一个前面板都伴有一个对应的框图(block diagram)程序。框图程序使用图形编程语言编写，可以把它理解成传统程序的源代码。框图中的程序可以看成程序节点，如循环控制、事件控制和算术功能等。这些部件用连线联接，以定义框图内的数据流动方向。上述温度计程序的框图程序如图2所示，框图程序的编写过程与人的思维过程非常接近。LabVIEW提供的3类可移动的图形化工具模板用于创建和运行程序，它们是工具(Tools Palette)、控制(Controls Palette)和功能(Functions Palette)等。工具模板用于创建、修改和调试程序(如连线、着色等)；控制模板用来设计仪器的前面板(如增加输入控制量和输出指示量等)；功能模板用来创建相当于源代码的 LabVIEW 框图程序(如循环、数值运算、文件I/O等)。LabVIEW平台的特点可归结为以下几个方面：

图2　温度计的框图程序
　　(1)图形编程方式：使用直观形象的数据流程图式的语言书写程序源代码；
　　(2)提供程序调试功能，如设置断点或探针，单步执行，语法检查等；
　　(3)拥有数据采集、仪器控制、分析、网络、 ActiveX 等集成库；
　　(4)继承传统编程语言结构化和模块化的优点，这对于建立复杂应用和代码的可重用性来说是至关重要的；
　　(5)提供DLL库接口、CIN节点以及大量的仪器驱动器、网络通信VIs与其它应用程序或外部设备进行连接；
　　(6)采用编译方式运行32位应用程序；
　　(7)支持多种系统平台，如Macintosh、HP-UX、SUN SPARC和Windows 3.x/95/NT等，LabVIEW 应用程序能在上述各平台之间跨平台进行移植；
　　(8)提供大量的函数库及附加工具。如数学函数、字串处理函数、数组运算函数、文件I/O、高级数字信号处理函数、数据分析函数、仪器驱动和通信函数等。
2　程序设计结构
　　(1)层次化结构
　　LabVIEW是模块化程序设计语言，用户可以把一个 VI 程序创建成自己的一个图标/接口(即VI子程序) ，然后被其它VI程序所调用。用这种方法可设计出一个有层次关系的VIs或子 VIs ，而且调用阶数是无限制的。
　　(2)并行工作
　　LabVIEW是一个多任务的软件系统，当创建具有同步工作的程序块时，就可交互地运行并行VIs程序。
　　(3)常规语法结构：While Loops，For Loop，Case结构，顺序结构等;
　　(4)基于文本的公式结(Formula Node)
　　公式结是一种用于书写数学公式的文本编辑框。
3　LabVIEW的运算形式
　　(1)模块化图标运算
　　LabVIEW中的图标/连接口表示一定的函数功能，将若干个图标/连接口组合起来就可进行有关运算，如算术、布尔逻辑、比较和数组运算、数值运算(三角函数、对数等)、字符串运算和文件I/O等；
　　(2)公式运算
　　使用公式结运行数学公式。公式结包含一个或多个公式表达式，各公式之间用分号"；"隔开。公式表达式使用了一种类似于大多数基于文本编程语言(如BASIC语言)的算术表达式的语法。如图3所示，输入变量为m、b和x，经公式结运算后的输出变量为y1和y2。公式结中使用的变量或公式的数量是无限制的。

图3　公式结运算例子

图4　使用功能子模块进行温度曲线分析 
　　(3)　使用集成库的功能子模板完成运算
　　LabVIEW中集成了大量的生成图形界面的模板，丰富实用的数值分析、数字信号处理功能，以及多种硬件设备驱动器(包括RS232、GPIB、VXI、DAQ卡和网络等)。用户不需了解有关运算细节就能直接使用这些功能子模块，这对于编程工作来说，可节省了大量的时间开销。如图4所示，使用两个功能子模块进行温度曲线分析，以求出数组的最大值、最小值和平均值。
　　(4)通过链接DLL形式的代码进行运算
　　LabVIEW提供DLL库接口和CIN节点来使用户有能力在该平台上使用其它软件开发平台生成的模块。即用户可通过其它开发平台(如BC++)建立一个子例程，并生成动态链接库DLL，然后与LabVIEW框图程序进行链接。LabVIEW的这一开放性，为用户自行编写某些软件模块提供了方便。如用户可通过C++/C语言为某一新设备开发通信及驱动程序，或编写一控制算法软件，然后链入LabVIEW程序。
4　LabVIEW的开放性
　　LabVIEW是开放型的开发环境，它拥有大量的与其它应用程序进行通信的VI库。因此，LabVIEW可从众多的外部设备获取或传送数据，这些设备包括GPIB、VXI、PXI、串行设备、PLCs、和插件式DAQ板等；LabVIEW甚至可以通过Internet取得外部数据源。
　　(1)DLLs
　　在Windows或其它平台下调用内部或外部的DLL形式的代码或分享其它平台(包括Windows)中的库资源；使用CodeLink，同样可自动分享在LabWindows/CVI中开发的C程序库；
　　(2)ActiveX，DDE,SQL
　　使用自动化ActiveX、DDE和SQL，与其它Windows应用程序一起集成用户的应用程序；
　　(3)远程通信：Internet，TCP/IP
　　使用TCP/IP和UDP网络VIs，与远程应用程序进行通信；在用户的应用程序中融入e-mail、FTP和浏览器等；通过远程自动控制VIs，可远程操作其它机器上的分散VIs的执行。
5　调试工具
　　(1)语法检查：如果程序有错，则无需编译，工具栏的运行按钮就会出现一个折断的箭头。点击该箭头，就会给出错误列表信息。
　　(2)运行灯高亮：运行灯高亮用于在单步模式下跟踪框图程序中的数据流动。
　　(3)单步执行：按顺序一个节点一个节点地执行程序。
　　(4)探针：探针工具用来查看程序流经某一根连线上的数据。
　　(5)断点：设置断点可在程序的某一地方终止程序的执行，以观察调试部分的执行结果。
　　综上所述，列出LabVIEW的开发环境表，如表1所示。
6　工具软件包
　　NI公司及其协作单位提供众多的软件工具箱和支持软件，用于扩展支持LabVIEW。这些工具软件包有：
　　(1)常用工具箱
　　Application Builder:创建可单独运行的应用程序；
表1 LabVIEW开发环境一览表
控件与指示器按钮/开头LED，滑块/数显，计量器/刻度盘/旋钮，水槽/温度表，曲线图/图表，表格/数组，密度图，菜单/列表/环，文本框；
仪器控制GPIB，VXI，Serial，CAMAC，PLC等600多种仪器驱动器；
文件I/O电子表格，二进制，ASCII码，日志；
开放性联接Internet，SQL，TCP/IP，Activex，DLLs，DDE等；
数据采集DAQ，单点输入/输出，波形采集/发生，图像采集，信号调理，触发/定时，TTL/CMOS输入/输出，数字图案发生，数字握手，脉冲发生，事件计数，边界检测，周期和脉宽测量等；
程序设计结构While Loops，For Loop，Case结构，顺序结构，基于文本的公式结；
程序设计原则算术运算，布尔逻辑，数组处理，串函数，时间/日期函数，多数据类型结构，用户子例程；
分析信号发生，信号处理，图象处理，曲线拟合，窗体，过滤，线性，统计等；
优化与应用程序管理用于存储管理和执行时间跟踪的Profiler，在所有平台上的TURE编译性能，源代码控制，文档打印等；
调试断点，探针，单步模式，执行高亮，帮助窗口，在线帮助
　　Test Suite:包括600多个仪器驱动程序软件包、连接到30多个本地或远程数据库的数据库连接工具、程序性能测试和分析软件等；
　　Test Executive:   多用途的附加软件包。使用该软件包，可以控制程序执行的次序，生成应用程序。按照自己的特定要求和标准来设置应用程序。在保持扩展升级兼容性的前提下，允许用户增强操作和人机接口；
　　SQL:用于与本地或远程数据库的直接访问；
　　SPC:过程控制中统计方法应用程序库；
　　Internet:把VI程序转换成可在Internet上执行的应用程序；
　　PID:给LabVIEW加入复杂的控制算法。该软件包带有许多误差反馈及外部复位的PID算法，同时含有超前-滞后补偿和设置点斜率生成等功能；
　　Picture Control: 一个多功能的图形软件包，用于生成前面板显示，如特殊的棒形图、饼形图和Smith图表等。
　　(2)分析工具箱
　　HIQ：一个交互式的工作环境，可以对数学、科学计算和工程问题的数据进行组织、可视化处理。HIQ集成了数学运算用户接口控制、数值分析、矩阵运算及二维、三维和四维图形处理；
　　Signal Processing Suite: 提供数据处理功能和高级信号处理工具。如数字滤波器、1/3倍频程分析和动态信号分析等；
　　G Math:算术运算、数据分析和数据可视化。如常微分方程、最优化、变换和过程控制模拟等；
　　Image Processing:提供图象处理功能和机器视觉功能等。 
7 总结
　　LabVIEW 是开放型模块化程序设计语言，使用它可快速建立自己的仪器仪表系统，而又不用担心程序的质量和运行速度。LabVIEW既适合编程经验丰富的用户使用，也适合编程经验不足的工程技术人员使用，所以被誉为工程师和科学家的语言。
作者简介：李扬　男,32岁,讲师,主要从事计算机辅助测试、过程控制DCS和PLS方面的研究开发工作
作者单位：广东工业大学五山校区机电系广州　510643
参考文献
　1　National Instruments.Instrumentation Catalogue.1998：49～60
　2　National Istruments Corporation.计算机虚拟仪器编程Lab-VIEW实验教程.1996：1～13，60～66
收稿日期：1998-08-03
