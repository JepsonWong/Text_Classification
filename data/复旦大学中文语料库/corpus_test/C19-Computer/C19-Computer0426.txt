信息与控制
INFORMATION AND CONTROL
1999年 第28卷 第6期 Vol.28 No.6 1999



定量反馈理论（QFT）及其设计应用
肖永利　张　琛　陈文华
　　摘　要：本文总结了定量反馈理论（QFT）的设计特点、基本原理和设计过程，综合论述了多输入多输出、非最小相位/不稳定、时变/非线性不确定系统的QFT研究方法，介绍了QFT目前在国外的研究进展及应用情况，并对QFT未来发展作了展望．
　　关键词：定量反馈理论（QFT）， 鲁棒控制， 不确定性系统
　　中图分类号：TP13　　　　　　文献标识码：A
QUANTITATIVE FEEDBACK THEORY AND ITS DESIGN APPLICATIONS
XIAO Yong-li1 ZHANG Chen1 CHEN Wen-hua2
(1. Information Storage Research Centre , Shanghai Jiaotong University, Shanghai 200030; 2. Glasgow University UK)
Abstract　This paper summarizes the properties, basic principles, and design process of quantitative feedback theory. The research ideas of QFT applied to MIMO plants, non-minimum phase/or unstable plants, time-varying/or nonlinear plants are surveyed. The development and application status of QFT in overseas are introduced and the future developments are overviewed.
　　Key words　quantitative feedback theory, robust control, uncertain system
1　引言
　　定量反馈理论（Quantitative Feedback Theory）是以色列学者Issac.Horowitz提出的一种鲁棒控制设计理论[1]．早在60年代末，这种理论方法就已基本形成，但由于其在控制系统设计中需要进行大量的数字计算和复杂的图形分析，因而很长一段时间未受到很高的重视．到了80年代末和90年代初，随着计算机的普及和飞速发展以及各种CAD软件包的开发应用，数字计算和复杂图形分析已不再是阻碍QFT研究发展的障碍，这种理论方法才逐渐被许多学者认可并很快成为现今较为流行的一种鲁棒控制设计方法．
　　QFT是一种频域设计方法，它将经典控制理论中的频域校正器设计思想推广应用到了对不确定性系统的鲁棒控制律设计，将对象的不确定范围和系统的性能指标用定量的方式在Nichols图上形成边界，进而以基准对象的开环频率曲线满足边界条件为要求在图上对系统进行设计与综合．由于QFT是从工程应用角度提出的，因而它是目前鲁棒控制领域中具有较强工程实用价值的一种设计方法．
2　QFT的研究对象和设计特点
　　QFT属于一种鲁棒控制设计方法，它是针对当对象具有不确定性和存在干扰情况下，如何利用反馈信息设计出满足一定要求的控制系统这一问题而提出来的．对象的不确定性包含参数不确定性和结构不确定性，干扰包括系统输入输出干扰及传感器噪声干扰等．QFT也是一种频域设计方法，当不确定对象在Bode图中能表示成一些幅值和相位曲线时，应用QFT就可以很简单地设计出一个控制器G和前置滤波器F，使得设计对象具有期望的鲁棒特性．QFT之所以近年来能引起广泛兴趣，主要原因在于它本身所具有的独特优越性，其设计特点主要包括以下几个．
　　（1） 设计的控制系统具有鲁棒性．QFT可以综合考虑对象的不确定范围和系统的性能指标，并能实现具有大范围不确定性系统的稳定鲁棒性和性能鲁棒性设计要求．
　　（2） 反馈代价直接由对象的不确定范围、干扰大小以及设计指标高低来决定．
　　（3） 设计过程能够在每一个设计频率点处明确反映系统的设计要求、不确定性与控制器复杂程度、带宽等量之间的约束关系．
　　（4） 并不一定需要知道对象的具体模型．当对象具有复杂动态特性，很难建立解析式模型时，可以用实验方法得到不确定对象的频率响应集合，QFT可以在只知道这些频率响应集合的条件下设计控制系统．
　　（5） 可以用非线性对象的简化线性模型设计固定参数控制系统．对于象飞机、导弹这类不确定性非线性对象，传统的处理方法是先在对象的不同工作点进行解耦线性化，得到一组传递函数集合，然后用增益调参法设计控制器．QFT可直接对传递函数集合设计，得到固定参数的控制器．
　　（6） 应用范围较广．QFT可用于单变量、多变量、非最小相位/不稳定、各种高度非线性以及时变系统的鲁棒控制律设计．
　　（7） 设计过程简单．当设计指标无法满足时，可以很快重新进行调整设计．
　　（8） 工程实用性强．QFT是一种工程设计方法，它不象某些鲁棒控制方法要求设计者必须具备较深的数学功底．一般只要懂得经典控制理论的工程技术人员都可以很好地掌握这一设计方法，且用QFT方法设计的控制系统在实际应用中也是比较容易实现的．QFT的这一特性也是它最具吸引力的地方，有人称它是在控制领域为理论研究与实际应用架起了一座桥梁[2]．
3　QFT的基本原理和设计过程
　　QFT的发展过程首先是研究具有不确定性的线性时不变单输入单输出（LTI/SISO）系统，然后进一步推广到多输入多输出、非最小相位/不稳定、时变以及非线性等系统．LTI/SISO系统是QFT方法研究的核心内容，其它的多输入多输出、时变以及非线性等系统都可通过数学方法先转化为等效的LTI/SISO系统，再进行设计研究．由于QFT研究的核心内容是LTI/SISO系统的控制设计问题，所以下面以LTI/SISO系统为对象来介绍QFT的基本原理及设计过程．
3．1 QFT的设计结构
　　QFT的一般设计结构是一种如图1所示的两自由度控制结构．图中P是有着不确定性的被控对象，G和F为所要设计的控制器和前置滤波器，d1和d1为外部干扰输入，r和y分别为输入和输出．


图1 QFT两自由度控制系统结构
3．2 对象模板
　　QFT对不确定对象P的描述采用的是对象模板形式．对象模板表征的是对象在某一频率点处的不确定范围，映射到Nichols图上是一个区域．例如，选定一个频率点ωi，在这个频率点对不确定对象P进行频率响应分析，所有的频率特征点P(jωi)在Nichols图上所形成的区域就是在频率点ωi下的对象模板．QFT设计通常要根据系统频率特性在(0, ∞)范围内选取一组有代表性的频率点，针对不同频率点可以得到多个在不同频率点处反映系统不确定性的对象模板．在QFT设计中，绘制系统的对象模板并不需要将所有的频率特征点P(jωi)全部求出，而只需选取能够表征对象模板最大范围的频率特征点即可，与这些频率特征点对应的系统模型称为选样模型．选样模型必须能较准确地反映对象的最大不确定性，否则会导致设计的不准确．一般模板越大，表明被控对象的不确定性越强，反之则表明被控对象的不确定性越弱．作出合理、准确的对象模板在QFT设计中是非常重要的．
3．3 性能设计指标与边界
　　前面我们提到，QFT设计是在Nichols图上进行的．它的基本设计思想是先将对闭环系统的设计要求转化为在Nichols图上对基准对象开环频率响应曲线进行约束的一系列边界，然后通过调整基准对象的开环频率响应曲线，并使其满足边界条件来设计控制器G．
　　将闭环系统的设计要求转化为在Nichols图上的边界是QFT设计中的重要一环．针对控制系统要求，QFT的一般设计指标包括稳定性和稳定裕度指标、跟踪性能指标、抗干扰性能指标等．下面以跟踪性能指标为例来介绍如何在Nichols图上生成跟踪边界．
图1系统的闭环传递函数为：
　　　　　　(1)
其中L(s)为开环传递函数，L(s)=G(s)P(s)．由闭环传递函数表达式（1）知，闭环传递函数Tr(s)的不确定性只取决于L(s)（或P(s)）的不确定性，即有
　　　　　(2)
　　设闭环跟踪指标要求系统闭环响应必须满足
Trl(ω)≤Tr(jω)≤Tru(ω)　　　　　　　　　　　　　(3)
其中Trl(ω)和Tm(ω)为给定的上下界跟踪指标．由（2）（3）得
(4)
　　由开环传递函数L(s)=G(s)P(s)可知，在Nichols图上，通过平行移动（移动幅度为G(s)的相位角度）和垂直移动（移动幅度为G(s)的幅值）对象模板，可将对象模板放置到两条等M线之间．当两条等M线之间的幅值差恰好等于δr(ω)时，就保证了闭环Tr的变化量小于或等于设计允许值．通过在对象模板中选择一个基准点（对应的模型称为基准对象模型），再在每个相角对应的垂直线上重复上述移动过程，记住基准点的这些位置并连成曲线，就构成了对基准对象开环频率响应进行约束的跟踪边界曲线．类似地，可根据其它性能指标计算出稳定性边界、抗干扰边界等．对这些边界取交集，就可得到设计控制器所需的复合频域边界．
3．4 控制器G和前置滤波器F设计
　　在Nichols图上计算并绘制出复合频域边界后，接下来的工作就是设计控制器G．由于QFT是一种图形设计方法，所以控制器G的设计过程也叫设计整形过程（Loop Shaping）．
　　在绘有复合频域边界的Nichols图上作出基准对象的开环频率响应曲线L0(jω),由L0(jω)=G(jω)P0(jω)知，当G=1，即不加控制器时，L0(jω)=P0(jω)，当给G加入零极点及增益时，可以调整L0(jω)的位置和形状．QFT设计是使得开环频率响应曲线L0(jω)在所选则的设计频率点处的位置位于对应频率点处的边界的上方，且离边界越近越好，在高频处还应保证L0(jω)不与稳定边界相交．当L0(jω)满足边界要求后，用来调整的极点和零点以及增益就是控制器G的表达式．控制器G的作用仅能使闭环频率响应的变化量小于或等于允许变化范围，而不能使闭环的频率响应满足上下边界要求，因此还需加入前置滤波器F以调整系统的整体频率响应特性．控制器G和前置滤波器F的设计一般都要借助CAD软件，并且要经过多次试探才能成功．有经验的设计者通常很快就能完成，而对初学者来说则相对困难一些．值得一提的是，当有多个不同的G和F都满足设计要求时，设计者应根据实际情况选择一组最为合适的设计结果．
3．5 QFT设计过程总结
　　基于前面的介绍并根据QFT的CAD软件设计工具[3]，可以把LTI/SISO系统的QFT一般设计过程总结成这样几个部分．
　　第一部分：设计前的数据准备及定义过程．包括选择设计频率点集，选择基准对象，并根据不确定对象在所选频率点集处的频率响应数据生成对象模板．
　　第二部分：计算并绘制设计边界．根据对象模板和设计要求，在Nichols图上生成基准对象开环频率响应的各个设计边界，并取不同边界的交集得到复合频域边界．
　　第三部分：设计整形过程．在Nichols上调整基准对象的开环频率响应曲线，使其满足设计边界要求，从而先得到控制器G，接着根据闭环系统频率响应要求再设计前置滤波器F．
　　第四部分：设计结果分析．QFT是一种近似设计方法，所选的设计频率点是有限的点，设计出来的控制系统是否满足整个系统的要求，还必须加以分析才能确定．如果控制系统不满足设计要求，应返回到第一部分重新选择设计点并重新设计．
4　多输入多输出、时变/非线性、非最小相位/不稳定系统的QFT设计思想
4．1 多输入多输出（MIMO）系统的QFT设计
　　在实际系统中，大多数的控制对象都具有多输入多输出特性，因此多变量系统的控制设计问题一直是控制界的研究热点．针对具有不确定性的MIMO系统，人们投入了很大精力对它进行了研究．鲁棒控制理论和综合是近年来极具代表性的解决方法．这两种方法自80年代以来受到了普遍关注，至今已取得了很大发展．但由于种种原因，这些方法在实际应用中却遇到了很大困难．与这两种方法不同的是，QFT并没有以现代控制理论为基础去研究一些抽象的数学问题，而是直接延续了传统的经典控制理论，用单输入单输出系统方法来解决多输入多输出问题．它的基本思想是，先将n×n（如果不是n×n，应先转化成n×n）的MIMO系统分解成个等价的MISO系统，然后再利用前面介绍的LTI/SISO系统设计方法对其进行设计．
设n×n的MIMO系统的闭环传递函数阵为
T(s)=(I+P(s)G(s))-1P(s)G(s)F(s)　　　　　(5)
设P-1存在且G为对角阵，由（5）可推导得
(I+G(s)-1P(s)-1)T(s)=F(s)　　　　　　　　(6)
取P-1≡[pij]≡[1/qij]，则T(s)中的元素可表示为
　　　　(7)
　　系统闭环传递函数阵T(s)中共有n2个子传递函数tij，tij表示从第j个输入到第i个输出的闭环传递函数．不难看出，式（7）中的前半部分是标准的SISO闭环系统形式．其中qij为控制对象；gi与fij为所要设计的控制器和前置滤波器．当把后面的dij项看作是干扰输入时，就可以用SISO系统的QFT设计方法对每一个tij进行设计了，设计后的最终解就是MIMO系统的设计结果[4]．
　　由于各个tij之间具有相互耦合的约束关系，所以多输入多输出系统QFT设计的难点在于转化成MISO系统后的设计问题．Horowitz先后提出了两种处理方法，一种是考虑每个子MISO系统的最坏情况，逐个单独设计[4]，另一种是后面子系统的设计利用了前面子系统的设计结果，是前一种方法的改进[5, 6]．在此基础上，一些学者对上述方法又提出了一些改进意见．例如Yaniv将设计指标转化为模型匹配问题得到了MIMO系统设计的简化形式[7]；Chine用等价抗干扰的方法也简化了设计步骤[8]．C. C. Cheng等人则使用了一种指标替代结构形式使得设计变的容易[9]．尽管这些改进方法简化了多输入多输出系统的QFT设计过程，但先将MIMO系统分解成MISO系统这一总的设计思想并没有改变．
4.2 非最小相位/不稳定系统的QFT设计
　　非最小相位系统和不稳定系统在实际控制对象中相当普遍．在一般情况下，飞机和导弹的纵、侧向线性模型就是非最小相位系统和不稳定系统．早在二十多年前，Horowitz就研究了用QFT方法来解决非最小相位系统问题[10]，在他后来出版的专著中也用同样方法研究了不稳定系统的QFT设计问题．文[11,12]也通过具体设计证明了QFT方法在解决非最小相位/不稳定系统问题上的有效性．
　　用QFT设计非最小相位/不稳定系统的基本思想是，通过移动鲁棒稳定边界和性能边界，将非最小相位/不稳定系统的设计整形问题转化成最小相位/稳定系统的设计整形问题．对任意的具有不确定性的非最小相位/不稳定系统可写成如下形式

其中(-s)和
