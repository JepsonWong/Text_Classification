计算机应用
COMPUTER APPLICATIONS
1999年 第19卷 第9期 Vol.19 No.9 1999



轧钢监测诊断系统的研究
黄　史铁林　何岭松
　　摘　要　本文针对轧钢生产过程的自动化、智能化，开展了轧钢生产线特别是关键轧机的监测系统研究，讨论了系统组态软件特征，构造了系统结构和配置，制定并完成了网络实时数据传输方案。
　　关键词　监测系统，组态，系统结构
RESEARCH ON STEEL ROLLING 
MONITORING AND DIAGNOSIS SYSTEM
Huang Tao　Shi Tielin　He Lingsong
College of Mechanics, Huazhong University of Technology, Hubei.Wuhan 430074
　　Abstract　The paper researches monitoring system of key rolling mill in steel rolling product line. Configuration realization of system was discussed. Structure of system was also expounded. The scheme of data net transmitting in real time was studied and instituted.
　　Keywords　Monitoring system, Configuration, Structure of system
　　随着现代钢铁工业的飞速发展和生产装置的规模不断扩大，生产技术和工艺过程日趋复杂，对生产过程中各种信息的集成要求越来越高，整个生产过程越来越呈现现出工业大系统的性质，逐步发展成为计算机集成过程系统CIPS（Computer Integrated Processing System）。在走向CIPS的过程中，其关键设备――大型轧钢设备正向着大功率、高速、强载、高自动化、智能化的方向发展，结构越来越复杂，功能越来越完善。因此开展对轧钢生产线轧机的监测研究具有非常大的经济实用价值，采用流行的Intranet网络技术又给监测实现方式带来新的惊喜。
1　系统的组态软件特性
　　轧钢监测诊断系统的性能在很大程度上依赖于运行的软件系统。早期的监测诊断系统的软件功能，是靠软件专业人员通过编程实现的，工作量极大，不同的部门需要对系统软件作不同的修改，以满足该部门工作的需要。这种工作对专业软件人员来说是一种重复劳动，同时加大了系统维护成本，减弱了应变能力。随着监测诊断系统的发展，人们越来越重视系统的“软件组态和配置”功能(如图1所示)，并有如下经济价值：


图1　组态软件结构框架
　　. 与一般的监测诊断软件的结构框架基本相同，适用于不同企业、不同类型的轧钢过程监测，有更多的软件灵活性。“组态软件”提供了灵活的组态工具和面向对象的模块，以适应不同的轧制过程。
　　. “组态软件”提供了良好的人机交互界面，它可提供各种图形编辑工具、参数定义组态界面等，使系统功能有易于实现，从而加快监测系统的开发速度，简化了系统的维护功能。
　　. 系统的应用软件直接影响整个监测诊断的诊断精度。采用“组态软件”能使开发人员把更多的精力投入到系统诊断方案的设计上，建立完备的知识库，选择合理的推理规则，设计最佳的诊断方案。
　　. “组态软件”提高了系统的可靠性。组态软件工具一般是由有数年实践经验的程序员完成，其代码经过周密的设计，经过严格的测试，相对某一特定的系统可靠性高，并经过现场实际运行，其稳定性、可扩展性较好。
　　轧钢监测诊断系统的组态内容主要包括：
　　系统定义组态：对监测诊断系统工作环境、工作任务和自身性能进行描述信号。
　　采集组态：采集站名称、IP地址、采样方式、采样频率、采样通道数等。
　　数据库组态：对测点特征的详细描述信号数据结构的详细内容。
　　监测组态：将数据源同某一控件组合，包括控件的大小、位置、数据源、数据更新时间等。
　　分析组态：提供波形分析、相关分析、频谱分析、谱阵分析、轴心轨迹分析和数字滤波分析等常用信号分析模块，用户可在此基础上用组态的方式快速构造新的分析方法。
　　报表组态：提供基本的报表格式，报表内容包括文字、图表( Excel)和波形(BMP)。用户也可自定义报表格式。
2　系统结构与配置
　　轧钢监测诊断系统采用先进的Windows NT网络结构，工程师站、数据库服务器运行在Windows NT软件平台上，采集站和监测站运行在Windows 95软件平台上，其系统结构如图2所示。图中采集站选用工控机集中安放在电缆沟里，数据库服务器、工程师站和监测站选用高档微机，安放在集中控制室，用Hub将分布在这两处的计算机连接在一起，并与企业网相连。

图2　轧钢监测诊断系统结构
2.1　采集站
　　采集站所测量的信号主要有：测力系统(扭矩、轴向力、扭振等)，液压系统(模拟量、慢变量、开关量、数字量等)，振动系统，工艺量和电气系统(温度、转速、轧制力等)。系统各采集站应同步采集有钢和无钢信号，这样才能进行全面的对比分析。通过受载信号和卸载信号，判断轧机有钢和无钢状态，然后向各采集站发布统一的外触发信号启动和停止各采集站A/D板工作。信号采样方式初步分为巡检采样模式、高速巡检采样模式和高速连续采样模式三种。
　　采集站采集 的数据可按实时传输和集中传输两种方式向外发送，实时传输将数据写盘换为网络数据发送，由于网络数据发送速度远大于信号采集速度，故可以可靠的实现实时采样数据传输，该方式用于巡检采样数据的实时传输。电气信号采集站要求有72小时黑匣子记录功能，黑匣子通过设置文件存储缓冲区方式实现，初步设置的文件存储缓冲区为2160块钢的采样文件，每记录一块新钢的数据则将最老的一块钢数据删除。它采用集中传输方式，当一块钢数据采集完成后可用FTP进行一次性网络数据传输。
　　应用软件为用于实时网络命令收发的数据报服务器程序、用于采样数据集中传输的FTP服务器程序和信号采集等程序。
2.2　工程师站
　　工程师站负责对系统的总体组态，参数、图表修改以及系统维护，同时诊断分析和历史数据库访问服务也由工程师站服务器负责。它是系统的调度中心，设计成为“一机双屏”，两个显示屏的实时数据、图形可相互切换，以提供尽量多的信息，便于监测管理人员工作。安装有数据处理系统、故障诊断专家系统、能损分析系统、历史数据库管理系统，从网络上获取数据并完成故障诊断、能损分析以及历史数据的各种查询和分析。
2.3　数据库服务器
　　采集的数据通过网络实时送往数据库服务器中保存，主要是对数据进行管理，对用户进行分类，设置不同的访问权限，执行各种数据库操作并负责返回结果，同时对外提供采样数据访问服务的Web服务器程序，由于数据库服务器的数据吞吐量较大，工作任务繁忙，可设置备份数据库。应用软件为与信号采集计算机通讯的数据库服务器、管理采样数据SQL数据库程序、设备运行状态分析程序、WWW服务程序等。
2.4　监测站
　　监测站主要对设备运行状态进行监测，对超门限值进行报警，可在企业网的任何位置上，主要通过浏览器浏览设备运行状况，领导和相关技术人员足不出户便能了解关键设备的状况，便于科学管理与决策。采用了Web技术，最大限度地发挥了软件扩展优势 ，使该系统便于迅速扩展。应用软件为状态检测/报警显示组态程序、报表输出组态程序和浏览器程序等。
　　轧钢监测诊断系统采用VC++和VJ++开发，网络监测及查询由嵌入页面的Java小程序构成。轧钢监测诊断系统的主体软件有：
　　系统组态模块；采样数据库管理；监测模块；报警模块；制表报表模块；网络传输模块；接口模块。
　　这些模块挂接在基本模块上，每个模块互相独立，这样提高了系统的可靠性和可扩展性。同时提供模块的接口标准，允许用户自行开发需要的功能模块。基于以上的设计思想，在宝钢热轧F2轧机监测系统中初步实现。
3　系统的技术特色
　　该轧钢监测诊断系统采用浏览器工作模式，所有监测、分析、诊断软件都放在WWW服务器上，并通过WWW主页进行管理。用户通过主页访问WWW服务器，并启动内嵌在主页中的DHTML、Java或JavaScript程序，然后由这些内嵌程序提供监测、诊断服务。访问某一主页则自动下载并启动其中的程序，离开该页面则程序自动删除。如图3所示。

图3　系统工作原理图
　　监测系统工作过程中通过网络交换命令和数据，图4是系统运行中的数据流图。系统工作过程为用户从任一监测站的浏览器向工程师站发布命令，若是数据请求命令则工程师站立即返回数据，若是控制命令则工程师站校验用户身份后再对命令进行转发。

图4　系统数据流程图
　　系统监测站到工程师站采用HTTP方式交换命令和数据，这样可保证系统的对外开放性，任何连网计算机终端都可对轧机工作状态进行监测。工程师站服务器、数据库服务器和信号采集站之间采用数据报方式传输命令和数据，以保证信号采集层数据传输的效率。
　　本系统中大数据量采样数据的实时传输是一个难题，为了实现采样的实时传输，利用Winsock自行设计专用的数据报程序，并将其嵌入到信号采集程序中；利用A/D板的双缓存采样模式，设计双线程程序，一个线程用于双缓存信号采集，另一个线程用于双缓存网络数据发送。在A/D板采集的同时，主机发送上一个采样模块的；由于网络数据发送速度远大于信号采集速度，故可以可靠的实现实时采样数据传输，远端信号延迟=采样间隔*缓存点数。若采用标准的HTTP或FTP方式。则因不能嵌入到信号采集程序中，无法利用A/D板工作时的主机空闲时间，必须等采样完成后再集中传输，导致传输效率低下，而目前许多商业网络数据采集系统还采用这种方式。
4　系统的其他特点
　　该轧钢监测诊断系统的系统界面选择主页形式，图形界面采用JavaScript设计成可点图像页面，直接用设备图做背景，点击一部件或设备则启动该部件或设备的监测诊断画面，文字界面采用超链接设计，并用图标做装饰。其他主要特点还有：
　　实用性：用户掌握本系统应用软件后，可以随意增、减系统采集设备及数据，修改各种图形与参数等，方便、实用，用户基本上不依赖开发单位。
　　先进性：系统的硬件配置和软件结构设计都采用了目前国际主流技术和规范，便于今后扩充与升级。
　　远程服务：系统带有Modem，监测站利用电话拨号与工程师站服务器连接，可实现远程进行监测、查询，采用该服务方式方便、快捷。
　　经济性：客户端统一为浏览器，充分体现“瘦”型客户端，使系统成本降低，并且简单易学、培训方便。
作者简介：黄　在职硕士研究生。研究方向：远程监测、诊断。
史铁林　教授，博士生导师。
何岭松　副教授。
作者单位：华中理工大学机械学院　湖北.武汉（430074）
参考文献
［1］　叶　.基于Web的应用系统开发.计算机世界，1998；18(17)
［2］　王华强.工控组态软件功能分析和应用实例.电气自动化,1998;(4)
［3］　张宝社,等.Windows界面下的网络编程.合肥：中国科学技术大学出版社,1997,4
收稿日期:1999-03-09
