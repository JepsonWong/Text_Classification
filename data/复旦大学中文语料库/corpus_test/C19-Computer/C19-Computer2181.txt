计算机应用研究
APPLICATION RESEARCH OF COMPUTERS
2000　Vol.17　No.2　P.25-27



一种面向一维图象序列的目标检测和快速跟踪算法的研究
吴平川　路同浚　孟宪超　王炎
摘 要 针对工业视觉系统中的一维目标图象序列，提出了一种作用于扫描行基的自适应阈值分割和基于相关性评判准则的目标快速跟踪算法，并将该算法用于运动带钢表面的缺陷目标跟踪，仿真结果表明该算法具有跟踪精度高，执行速度快的优点。
关键词 自适应图象分割 目标跟踪 机器视觉检测
1 引言
　　工业视觉系统进行在线检测的典型过程，包括在图象序列中提取出感兴趣的目标，将其与背景分开，计算出特征参数(含几何的、光学的参数等)，并最终予以准确地识别和分类。其中，目标的实时跟踪技术是整个图象序列分析的难点和基础，只有在此基础上才能有效地完成目标识别的任务。对于目标跟踪，到目前为止还没有一套很成熟的方法。A.G.Gillbert和M.K.Giles等人[1]提出了形心跟踪法，Maybeck和Jensen等人[2]提出自适应扩展Kalman滤波器跟踪，Schalkoff[3]则运用Taylor级数图象处理跟踪法研究单目标跟踪问题。这些均是基于二维图象序列分析的目标跟踪方法，其算法较为复杂，计算量较大。鉴于目前高精度的工业在线视觉检测系统通常直接处理和分析一维图象序列，从而使得以上算法无法直接得以实用，经典的光栅跟踪算法对实际问题的求解效果也不甚理想。
　　本文针对工业视觉系统中的一维目标图象序列，提出了一种作用于扫描行基的自适应阈值分割和基于相关性评判准则的目标快速跟踪算法，并将该算法用于运动带钢表面的缺陷目标跟踪，仿真结果表明该算法具有跟踪精度高，执行速度快的优点。
2 自适应的目标分割
　　工业视觉系统所获取的图象通常具有如下一些特点：①正常背景灰度值在进行规格化和光照度补偿后，仍存在一定的变化范围；②不同目标的光学特征各异，但可以归纳为两类，即“明目标，暗背景”和“暗目标，明背景”；③图象的统计直方图呈现多峰值且谷底不明显，很难用单一确定阈值实施分割；④不同采集区域的背景平均灰度值也存在缓变的趋势。因此，我们采用了作用于扫描行的自适应双阈值分割方法。该方法的特点是：结构简洁可靠，计算开销相对较小，有效性较高；易于实施，可以满足在线检测要求。
　　具体计算步骤是：
　　(1)对任意扫描行i, 沿此扫描行计算该行所有象素经图象增强操作后的灰度值和(设j是扫描行中某一象素的位置标号)；
　　(2)计算此行所有象素值的递归平滑和SS(i)；

式中：Gj是扫描行i上位置为j的象素的灰度值，(是一常数，且满足0<α<<1。如若在本行发现缺陷目标，则：SS(i)=SS(i(1)；
　　(3)应用于本扫描行的分割阈值为：
　　
式中：(是一系数，等于CCD扫描行有效象素数的倒数，(G是正常表面灰度变化范围值，用以调整目标及背景的各自作用区域，参数(和(G的具体值需在大量样本的学习训练的基础上确定；　　　　(4)本扫描行的图象分割结果是：

　　二值图象中分割结果为1的所有象素被标记为目标点。本行计算完毕，重复上述过程直至系统扫描特定区域结束。
3 相关性的概念及其评判准则
　　首先引入行内相关和区域相关的概念，以扩展经典的区域跟踪算法对解决具体问题的适用性。在实时处理过程中，先采用行内相关性测度进行行内相关判断，然后利用行内相关结果进行邻域相关检测，并根据预先定义的跟踪接受准则判别目标片段，最终基于某种联接机制生成整体的被跟踪目标。
3.1 相关性概念
　　图象目标子区域中各象素之间在空域的二维坐标上均存在一定的关联性，这主要体现在灰度、纹理及对比度等特性方面的同质性。为此我们引入了空间位置上的相关性概念。
　　如图1，图中每一小方块代表了系统纵向和横向最小分辨力的组合。就图中A小块而言，它可能与周围的每一小块都存在某种关联。若A点属于目标点，当其邻域小块中同样存在目标点时，称此几个象素点间是相关联的，并将它们归入同一类目标；否则，不相关联，各目标点原则上归入不同类的目标。

图1　象点相关性概念
3.2 行内相关性测度
　　设扫描行i上的第j个象素点，定义一个二维性质向量：
　　
　　分量P1(i, j)表征该点与目前正跟踪的目标行片段点集(的平均灰度的差值，分量P2(i, j)为该点到点集(的最小欧式距离，具体计算时取P2(i, j)=|j-v|。
　　跟踪接受准则的均方差测度定义如下：

　　εA值须经大量样本的离线学习获得，且必须考虑由于噪声导致目标片段出现单象素宽度间断的情况下进行准确跟踪的问题。
3.3 区域相关性判别
　　设有扫描行i上的点集(Ωi，其边缘点对为(IBi, IEi)，定义六维性质向量
　　
其中，符号函数
　　分量Qi1表征了当前点集(i与正在跟踪的各目标行程(j之间平均灰度的相似性；分量Qi2, Qi3分别定义了点集(i和(j的相应端点间的街区距离，在实际计算中，可进一步简化为横向街区距离以减小运算量；分量Qi4, Qi5, Qi6运用符号函数定义了点集(i和(j间的空间相对位置关系。
　　定义如下规则集，来定性地描述目标跟踪过程中的区域相关性问题：
　　Rule1：
点集Ωi可接受为某一目标的当前行程，如图2(a)所示(εB是一经验数值)；

图2　区域相关性判别示意
　　Rule2: , then该点集(i可接受为某一目标的当前行程，如图2(b)所示；
　　Rule3: , then点集(i可接受为某一目标的当前行程，如图2(c)所示；
　　Rule4: ,then 点集(i可接受为某一目标的当前行程，如图2(d)所示；
　　Rule5: ,then点集(i可接受为某一目标的当前行程，如图2(e)所示。
4 目标快速跟踪算法
　　算法具体步骤：
　　(1) 设在任意扫描行i，遍历其所有经分割处理后标记出的目标候选点，分别计算出其性质向量，并根据行内相关测度进行聚类，生成m个点集Ωj(j=1,2,...,m)，作为m个待跟踪目标的起始行程。在内存中开辟m个存储区binj(j=1,2,...,m)，存储目标的边界信息及特征参数(几何的和光学的)。
　　(2) 在任意跟踪当前扫描行y，首先对该行内的所有候选点运用行内相关测度准则，聚类出n个点集Ωj(j=1,2,...,m)，然后对此n个点集进行区域相关性判别，并基于某种联接机制生长目标。
　　①如果点集Ωj与上一扫描行y-1中的某一目标的当前行程Ωi满足区域相关判别准则之一，将认为点集Ωj隶属于该目标，并将其作为此目标的当前行程，更新该目标所对应的内存区，并重新计算特征参数；
　　②如果相对于点集Ωi，存在：
，则点集Ωi与点集Ωj不相关，且Ωj与扫描行y-1上位于点集Ωi前面的其余目标行程均不相关；
　　③如果相对于点集Ωi，存在：
，则点集Ωi与点集Ωj不相关，且Ωj与扫描行y-1上位于点集Ωi后面的其余目标行程均不相关；
　　④如果点集Ωj与扫描行y-1上当前各追踪目标的行程均无关，则应回溯计算其与扫描行y-2上各追踪目标的行程是否相关，如若相关，将点集Ωj作为该目标的当前行程，并更新目标存储区；
　　⑤如果扫描行y-1上某一目标的初始行程，在本行中没有与之相关的点集，则认为该目标属于噪声，相应内存区予以释放；
　　⑥如若本行中有两个点集与上一扫描行y-1中的某一行程相关，说明出现目标分支的情况，此时另开两个内存区记录子目标追踪结果，并且此两个子bin均联接于原父bin上；如若本行中一个点集与上一扫描行y-1中的两个行程相关，说明出现目标合并状况，此时将代表两个分离目标的子bin合并成一个统一的父bin。
　　(3)当某一追踪目标的内存记录在一预先设定的扫描行数之内没有被刷新，则该目标跟踪过程结束，将记录bin移入buffer中，并释放相应的追踪内存区。
　　(4)当系统扫描特定区域结束后，目标跟踪算法执行完毕。
5 算法的仿真研究与结论
　　我们将本文提出的目标检测和快速跟踪算法应用于运动带钢表面视觉检测的实验研究中。图3示出了一幅含有典型缺陷目标(纵向裂纹)的带钢表面采集图象。算法的实验研究采用仿真方法，即对存储于计算机内存区中预先采集的面帧图象逐行进行扫描，模拟生成工业在线检测中的一维图象序列。通过选取不同的α值和△G值(定义参见本文中第2小节)，分别实施自适应的阈值分割和快速目标跟踪，检测结果如表1，2，3所示。

图3 带钢纵向裂纹缺陷图象
表1 缺陷识别结果一(α=0.01, △G=20)
The processed imagecrack
The processed window(100,100)-(400,400)
Threshold(low)112Threshold(high)152
Number of surface
defects inspected2　
ItemsNo.
12
Defect position(340,211)(273,238)
Area19511630
Alength12.712.3
Awidth132.1146.7
L/W0.20.2
Fillratio0.20.27
Gray(min)1820
Gray(mean)41.568.5
Gray(max)108108
表2 缺陷识别结果二(α=0.01, △G=25)
The processed imagecrack
The processed window(100,100)-(400,400)
Threshold(low)107Threshold(high)157
Number of surface
defects inspected2
ItemsNo.
12
Defect position(341.6,211.7)(272.9,237.9)
Area17601472.9
Alength12.111.9
Awidth118.9138.1
L/W0.20.2
Fillratio0.20.27
Gray(min)1820
Gray(mean)38.564.1
Gray(max)102102
表3 缺陷识别结果三(α=0.1, △G=25)
The processed imagecrack
The processed window(100,100)-(400,400)
Threshold(low)113Threshold(high)163
Number of surface
defects inspected2
ItemsNo.
12
Defect position(340.6,211.7)(272.9,237.9)
Area1760.91472.3
Alength12.111.9
Awidth118.9138.1
L/W0.20.2
Fillratio0.190.26
Gray(min)1820
Gray(mean)38.964.1
Gray(max)102102
　　仿真实验表明，本文提出的作用于扫描行基的自适应阈值分割及目标快速跟踪算法是可行的、有效的，运用此方法能够快速地检测出缺陷目标，计算所得的缺陷目标特征参数(如：面积、周长、长宽比、填充比、灰度参数等)准确可靠，满足进一步的目标识别的需要。 
吴平川（哈尔滨工业大学机器人研究所 哈尔滨 150001）
路同浚（哈尔滨工业大学机器人研究所 哈尔滨 150001）
孟宪超（哈尔滨工业大学机器人研究所 哈尔滨 150001）
王炎（哈尔滨工业大学机器人研究所 哈尔滨 150001）
参考文献
1，B.R.Suresh, R.A.Fundakowski, T.S.Levitt, J.E.Overland. A Real-Time Automated Visual Inspection System for Hot Steel Slabs. IEEE Trans. Pattern Anal. Machine Intell., 1983, PAMI-5(6): 563～572
2，孟宪超. 轧制带钢表面缺陷的检测及识别方法的研究(硕士学位论文). 哈尔滨：哈尔滨工业大学, 1996
3，李立源, 陈维南. 一种强鲁棒的完全确定型的快速阈值化方法. 模式识别与人工智能. 1993, 6(3):235～241
4，卢益民, 翁 虹, 罗志勇. 钢带表面缺陷检测信息实时处理方法的研究. 华中理工大学学报. 1994, 22(11):109～113
收稿日期：1999年8月20日
