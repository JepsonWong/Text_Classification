计算机工程
COMPUTER ENGINEERING
1999年 第25卷 第10期 Vol.25 No.10 1999



第二代小波在医学图象无损压缩中的应用
罗文斌　张立明　陈鑫
摘要：研究了第二代小波在医学图象无损压缩中的方法，并在计算机上用软件模拟实现了相应的算法，最后给出院实验结果以及与其他压缩方法的比较，从中可以看出这一新方法在医学图象无损压缩中具有的良好潜力和巨大的应用前景。
关键词：小波变换；提升方法；无损压缩
Lossless Compression of Medical Images Using Second Generation Wavelets
Luo Wenbin Zhang Liming Chen Xin
(Dept.of Electronic Engineering,Fudan University,Shanghai 200433)
【Abstract】This paper describes an approach to compress medical images loss using second generation wavelets.We list our software simulation results,and compare the method with other compression methods.The comparison shows that this method has great potential in compressing medical images.
【Key words】Wavelet transforms;Lifting scheme;Lossless compression
　　现实生活中，医学图象不容许丢失任何可能有用的细节信息，医学图象中丢失任何细微信息都可能导致医生不能准确地发现病灶，因而需要用无损压缩的方法对其进行压缩。当前，随着网络技术的飞速发展，远程诊断等应用也在不断走进现实生活中，这对于大容量的珍贵医学图象数据的传输与保存提出了更高的要求。传统DCT变换和第一代小波变换在对图象数据进行变换后产生的是浮点数，在对变换后数据进行压缩前需要进行量化处理，产生相对应的整数，这样会引起失真，不能对图象进行完全的无损压缩。而第二代小波构造方法-提升方法(Lifting Scheme)能够实现整数小波变换，不需要对变换后的数据进行量化处理，能对图象进行完全的无损压缩。利用小波变换方法对医学图象进行无损压缩的另一个好处是：可以实现按分辨率对图象进行传输。正是在这样的背景下，本文着重研究了第二代小波在医学图象无损压缩中的方法。
1　第一代小波[2]
　　小波分析是近年来从数学界到工程界都十分关心的一种新的分析方法，与传统的傅立叶分析相比，小波分析在时域和频域同时具有良好的局部化特性，更利于我们分析信号的局部特征。小波的有效性体现在用少量的小波系数就能获取数据集合中的一些本质特征。
　　传统小波是由同一母函数经过平移和伸缩运算而得到的一组函数。小波函数被定义为在L2(R)空间上的母小波Ψ(x)的二进伸缩与平移，即，小波函数为：Ψj,k(x)=Ψ(2jx-k)。有人称之为第一代小波[1]。
　　对信号进行小波变换满足多分辨率分析。低分辨率j和高分辨率j-1之间满足双尺度方程：
　　　　　　　　　　　　　　　(1)
　　　　　　　　　　　　　　　(2)
　　通过系数hn-2k,gn-2k组成的滤波器,对信号cj-1进行分解的公式为：
　　　　　　　　　　　　　　　　　(3)
　　　　　　　　　　　　　　　　　(4)
　　cj和dj分别为低频和高频分量。由cj和dj恢复cj-1的重构公式为：
　　　　　　　　　　　　　　(5)
　　小波的塔式分解如下：

　　小波的分解和重构见图1。

图1 小波的分解和重构
　　当j-1=cj-1时，说明信号能够精确重构。
　　为了处理图象信号，Mallat将多分辨率分析推广到二维情况。二维小波变换和一维小波变换类似，分别对行和列进行一维小波变换。
　　但是，在实际应用中，第一代小波也存在一些问题：1)信号经过第一代小波变换后产生的是浮点数，由于计算机有限字长的影响，往往不能实现精确地重构信号。2)图象的尺寸有要求，并不能对所有尺寸的图象进行变换。3)对内存的需求量较大。不适于用专用DSP芯片实时实现。4)第一代小波不能满足一些实际应用(如对不规则采样数据、曲线、曲面等进行分析)的要求。
　　实际应用需要我们将第一代小波普适化。1994年，W.Sweldens提出一种不依赖于傅立叶变换的新的小波构造方法--提升方法。提升方法既保持原有的小波特性，又克服平移伸缩不变性所带来的局限。提升方法可以实现小波快速算法，并可在当前位置上进行变换。有人称提升方法为第二代小波构造方法[1]。
2　第二代小波
　　第二代小波构造方法--提升方法与第一代小波构造方法的区别在于不依赖于傅立叶变换，在空间域中实现小波的构造。
　　由提升方法构成的小波变换过程可分为3个步骤：分裂(split)、预测(predict)、更新(update)。
　　(1) 分裂(split)
　　此过程仅仅将一数据集(原始信号)sj(2j,jεZ+)分裂成两个较小的子集合Sj-1和dj-1，dj-1也称为小波子集，即：
　　Split(sj):=(evenj-1，oddj-1)
　　　 =(sj-1，dj-1)
　　(2) 预测(predict)
　　若dj-1不包含任何信息，用sj-1便能更紧凑代表sj。实际上这种情况几乎很难出现，基于原始数据的相关性用偶数序列sj-1去预测(或者内插)奇数序列dj-1。
　　dj-1:=dj-1-P(sj-1)
　　(3) 更新(update)
　　经过上面两个步骤还不能在子数据集sj-1中维持原始数据集sj中的某些整体性质，如均值等。因此，必须采用更新过程。更新的基本思想是找出一个更好的子数据集sj-1，使之保持原始数据集sj的一些尺度特性Q(・)，如均值、消失矩等不变，即：
　　Q(sj-1)=Q(sj)
　　构造一个算子U去更新sj-1，定义如下：
　　sj-1:=sj-1+U(dj-1)
　　提升方法中的3个主要步骤归结为：
　　1){sj-1，dj-1}:=Split(sj)
　　2)dj-1 -=P(sj-1)
　　3)sj-1+=U(dj-1)　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　(6)
　　重构数据集的提升方法步骤为：
　　1)sj-1-=U(dj-1)
　　2)dj-1+=P(sj-1)
　　3)sj:=Merge{sj-1，dj-1}　　　　　　　　　　　　　　　　　　　　　　　　　　　(7)
　　分解和重构如图2所示。

图2 提升方法分解和重构
　　在实验中我们用的是(4,4)类型整数小波变换[3]，它的变换公式为：


　　其中[・]为取整符，j,j-1表示变换级数。
　　变换过程如下：

　　从上图可以看出，变换后的数据仍然存放在原图位置处，从而可以大大节省内存。进行下一级变换时，只需对低通信号…，sj-1,l，sj-1,l+1，…进行同样的操作。
　　与第一代小波构造方法相比，第二代小波构造方法具有许多的优越性，这体现在：1)可实现整数小波变换[3]。2)能实现任意图象尺寸的小波算法。3)能在当前位置完成小波变换，节省内存。4)计算更快速。5)能很好地克服小波变换的边界问题。6)能实现对不规则采样数据、曲线、曲面的小波算法。7)不依赖于傅立叶变换实现小波构造。
3　实验结果
　　(1) 整数小波变换
　　我们采用(4,4)类型整数小波对一幅标准医学超声图象进行变换。下面两幅图分别为原图、原图和7级塔形变换后的图象的直方图：

图3 原始医学图象

图4 原图和变换后的直方图
　　其中虚线(右)和实线(左)分别表示原图和变换后的直方图。从上图可见，变换后的小波系数主要集中在零附近。
　　(2) 对医学图象的无损压缩
　　常用的无损压缩方法有：Huffman编码、算术编码等。DCT变换和第一代小波变换后产生的是浮点数，进行熵编码前必须先取整，因此不能做到完全的无损压缩。
　　本文采用的方法是先对医学图象进行整数提升小波变换，然后再进行熵编码。
　　为了与其他方法进行比较，我们选用了4幅标准医学超声图象(M1-M4)进行测试，各种方法的无损压缩比特率(bpp)如下表所示：
　　方法
图象Huffman算术编码JPEG第一代小波我们的方法
M16.686.224.714.534.10
M26.506.054.494.363.97
M36.185.574.424.323.89
M46.085.724.494.333.97
　　注：在我们的方法中采用的是（4，4）类型整数小波，熵编码用的是算术编码。 
　　从上表中可以看出：在对医学图象的无损压缩中，我们的方法要好于其他各种常用方法。并且基于整数提升小波变换的方法可以实现完全的无损。而上面采用第一代小波变换方法的恢复图象的Psnr分别为：58.2、58.6、56.2、58.1，不能实现完全无损压缩。
4　总结
　　利用第二代小波构造方法 - 提升方法可以构造出可逆整数小波的特点，将其用于医学图象的无损压缩中，实验结果证明取得了很好的压缩效果，显示了小波变换应用于医学图象无损压缩领域的巨大潜力和广阔前景。基于提升方法构造出的可逆整数小波变换以其快速、节省内存及变换后产生的仍是整数的特点，比DCT变换和第一代小波变换更易于在DSP专用芯片上实现，因而更实用于实时的远程医疗诊断和医学图象压缩系统中。另外，由于小波变换的多分辨率特性，基于整数小波变换的无损压缩方法能实现码流按分辨率传送，这对于网上医学图象的预览和查询等许多具体应用具有重要的实用价值。
作者简介：罗文斌（1974～），男，硕士，研究方向：图象压缩
作者单位：复旦大学电子工程系，上海200433
参考文献 
1 Sweldens W.The Lifting Scheme:A Construction of Second Generation Wavelets[Technical Report],USA:University ofSouth Carolina,1995
2 Daubechies I.Ten Lectures on Wavelets.USA,SIAM,1992
3 Calderbank R,Daubechies I,Sweldens W,et al.Wavelet Transforms hat Map Integers to Integer[Technical Report].USA,Princeton University,1996
4 Daubechies I,Sweldens W.Factoring Wavelet Transforms Into Lifting Steps[Technical Report].USA,Princeton University,1996
收稿日期：1999-02-02
